Version "30.0-0";
Libraries "Modeler.acml", "Dynamics.acml", "SystemLibrary.acml";
CAUSR1Comps AS  StringSet;
  CAUSR1Comps.Description : "Components with CAUSR1 attribute";

CAUSR2Comps AS  StringSet;
  CAUSR2Comps.Description : "Components with CAUSR2 attribute";

CAUSR3Comps AS  StringSet;
  CAUSR3Comps.Description : "Components with CAUSR3 attribute";

CAUSR4Comps AS  StringSet;
  CAUSR4Comps.Description : "Components with CAUSR4 attribute";

CAUSR5Comps AS  StringSet;
  CAUSR5Comps.Description : "Components with CAUSR5 attribute";

CAUSRAComps AS  StringSet;
  CAUSRAComps.Description : "Components with CAUSRA attribute";

CAUSRAtts AS  StringSet;
  CAUSRAtts : ["ELEM1", "ELEM10", "ELEM2", "ELEM3", "ELEM4", "ELEM5", "ELEM6", "ELEM7", "ELEM8", "ELEM9"];

CAUSRBComps AS  StringSet;
  CAUSRBComps.Description : "Components with CAUSRB attribute";

CAUSRCComps AS  StringSet;
  CAUSRCComps.Description : "Components with CAUSRC attribute";

CAUSRDComps AS  StringSet;
  CAUSRDComps.Description : "Components with CAUSRD attribute";

CAUSREComps AS  StringSet;
  CAUSREComps.Description : "Components with CAUSRE attribute";

GENANALAtts AS  StringSet;
  GENANALAtts : ["ELEM1", "ELEM10", "ELEM11", "ELEM12", "ELEM13", "ELEM14", "ELEM15", "ELEM16", "ELEM17", "ELEM18", "ELEM19", "ELEM2", "ELEM20", "ELEM3", "ELEM4", "ELEM5", "ELEM6", "ELEM7", "ELEM8", "ELEM9"];

GENANALComps AS  StringSet;
  GENANALComps.Description : "Components with GENANAL attribute";

GlobalFlashBasis AS  FlashMode;
  GlobalFlashBasis.Description : "Global flash calculation method";

GlobalPDriven AS  LogicalParameter;
  GlobalPDriven.Description : "Simulation is pressure driven";
  GlobalPDriven : False;

GlobalRFlow AS  LogicalParameter;
  GlobalRFlow.Description : "Simulation supports reverse flow";
  GlobalRFlow : False;

GlobalStreamClass AS  Components;
  GlobalStreamClass.Description : "Global Stream Class";
  GlobalStreamClass.Valid : ["CONVEN", "MCINCPSD", "MIXCINC", "MIXCIPSD", "MIXCISLD", "MIXNC", "MIXNCPSD"];
  GlobalStreamClass : "CONVEN";

NIntervalsCI AS  IntegerParameter;
  NIntervalsCI.Description : "Number of intervals for CI substreams";
  NIntervalsCI.Lower : 0;
  NIntervalsCI.Upper : 100;
  NIntervalsCI : 10;

NIntervalsNC AS  IntegerParameter;
  NIntervalsNC.Description : "Number of intervals for NC substreams";
  NIntervalsNC.Lower : 0;
  NIntervalsNC.Upper : 100;
  NIntervalsNC : 10;

PROXANALAtts AS  StringSet;
  PROXANALAtts : ["ASH", "FC", "MOISTURE", "VM"];

PROXANALComps AS  StringSet;
  PROXANALComps.Description : "Components with PROXANAL attribute";

StreamClassSet AS  StringSet;
  StreamClassSet : ["CONVEN", "MCINCPSD", "MIXCINC", "MIXCIPSD", "MIXCISLD", "MIXNC", "MIXNCPSD"];

SULFANALAtts AS  StringSet;
  SULFANALAtts : ["ORGANIC", "PYRITIC", "SULFATE"];

SULFANALComps AS  StringSet;
  SULFANALComps.Description : "Components with SULFANAL attribute";

T_max AS  RealParameter;
  T_max.Description : "Temperature upper limit (C)";
  T_max : 9726.85;

T_min AS  RealParameter;
  T_min.Description : "Temperature lower limit (C)";
  T_min : -253.15;

ULTANALAtts AS  StringSet;
  ULTANALAtts : ["ASH", "CARBON", "CHLORINE", "HYDROGEN", "NITROGEN", "OXYGEN", "SULFUR"];

ULTANALComps AS  StringSet;
  ULTANALComps.Description : "Components with ULTANAL attribute";

UpdateVersion AS  RealParameter;
  UpdateVersion : 13.2;

GlobalFlashSmoothTol AS  FlashSmoothTol;
  GlobalFlashSmoothTol.Description : "Global tolerance for SmoothEquation flash";

P_max AS  RealParameter;
  P_max.Description : "Pressure upper limit (bar)";
  P_max : 500.;

P_min AS  RealParameter;
  P_min.Description : "Pressure lower limit (bar)";
  P_min : 1.e-005;

GlobalTimeScaler AS  TimeScalerParameter;

GlobalPropDamping AS  OnOff;
  GlobalPropDamping.Description : "Flag for damping local property coefficients";

GlobalPropMode AS  PropertyMode;
  GlobalPropMode.Description : "Global property mode";

eps AS  RealParameter;
  eps : 1.e-005;

AttSet AS  StringSet;
  AttSet : ["FRAGFLOW", "HTHFLOW", "LCB", "LSMOM", "SCB", "SMOM", "TMOM", "ZMOM"];

CatAttSet AS  StringSet;
  CatAttSet : ["CDSFLOW", "CPSFLOW"];

CatSiteAttSet AS  StringSet;
  CatSiteAttSet : ["CIONFLOW", "CISFLOW", "CVSFLOW", "P0FLOW", "PT0FLOW"];

del_Pl AS  RealParameter;
  del_Pl : 1.e-004;

del_Pu AS  RealParameter;
  del_Pu : 5.;

del_Vl AS  RealParameter;
  del_Vl : -5.e-003;

del_Vu AS  RealParameter;
  del_Vu : -5.e-003;

delta_T AS  RealParameter;
  delta_T : 5.;

Distribution AS  OnOff;
  Distribution.Description : "Switch for Polymer MWD";
  Distribution : "Off";

DistType AS  DistTypes;
  DistType.Description : "Distribution plot style: MWD or CLD";
  DistType : "MWD";

F_max AS  RealParameter;
  F_max.Description : "Flow rate upper limit (kmol/hr)";
  F_max : 1000000.;

globalLiqHead AS  YesNo;
  globalLiqHead.Description : "Liquid outlet pressure includes hydrostatic head";
  globalLiqHead : "No";

Ktc AS  RealParameter;
  Ktc.Description : "TrueComps tuning parameter for fictitious controller";
  Ktc : 100.;

NptsMWD AS  IntegerParameter;
  NptsMWD.Description : "Number of points sampled in calculation of MWD";
  NptsMWD : 100;

one AS  RealParameter;
  one : 1.;

PI AS  RealParameter;
  PI : 3.141593;

SegAttSet AS  StringSet;
  SegAttSet : ["CIS-FLOW", "LEFLOW", "LSFLOW", "SFLOW", "TDBFLOW", "TRANSFLO", "XFLOW"];

sflow_scale AS  RealParameter;
  sflow_scale : 1.e-003;

SiteAttSet AS  StringSet;
  SiteAttSet : ["ASSMOM", "ASTMOM", "DSSMOM", "DSTMOM", "LSSMOM", "LSTMOM", "SATFLOW", "SLCB", "SSCB", "SSMOM", "STMOM", "SZMOM"];

SiteSegAttSet AS  StringSet;
  SiteSegAttSet : ["ASEFLOW", "ASSFLOW", "DSEFLOW", "DSSFLOW", "LSEFLOW", "LSSFLOW", "SSFLOW"];

smom_scale AS  RealParameter;
  smom_scale : 1.;

stravail AS  StringSet;
  stravail : ["Liquid", "Solid", "Vapor"];

Tamb AS  temperature;
  Tamb.Description : "Ambient Temperature";
  Tamb.Spec : Fixed;
  Tamb : 10.;

Tol_Mcp AS  RealParameter;
  Tol_Mcp.Description : "TrueComps tolerance to prevent singularity when Mcp = 0";
  Tol_Mcp : 1.e-010;

UCF13 AS  RealParameter;
  UCF13 : 1.e-004;

UCF18 AS  RealParameter;
  UCF18 : 1000000.;

UCF6 AS  RealParameter;
  UCF6 : 3.6e-003;

UCF8 AS  RealParameter;
  UCF8 : 1.e-005;

UEC1 AS  RealParameter;
  UEC1 : 9.806649999999999;

Upper AS  IntegerParameter;
  Upper.Description : "Upper limit on distribution";
  Upper : 100000;

V_heel AS  RealParameter;
  V_heel : -1.e-003;

zero AS  RealParameter;
  zero : 0.;

zmom_scale AS  RealParameter;
  zmom_scale : 1.e-003;

Model Tubular_membranes

  //---------------------
  //----- Variables -----
  //---------------------



  Parameter Set9 uses StringParameter
    valid as StringSet (["EtOH_decomposition", "EtOH_oxidation", "EtOH_SR_Rossetti", "CH4_oxidation", "H2_oxidation", "WGS", "MSR_FluidCELL", "MSR_Numaguchi_Kikuchi"]);
  End

  Parameter Set10 uses StringParameter
    valid as StringSet (["Permeance", "Permeability"]);
  End

  Parameter Set11 uses StringParameter
    valid as StringSet (["T_constant_no_thermal_balance", "thermal_balance"]);
  End
  
  Parameter Set12 uses StringParameter
    valid as StringSet (["yes", "no"]);
  End
  
  Parameter Set13 uses StringParameter
    valid as StringSet (["exagonal_pattern", "circular_pattern", "no_pattern_u0_umf_fixed" , "no_pattern_r_vessel_fixed", "polynomial"]);
  End

  Parameter Set14 uses StringParameter
    valid as StringSet (["Neglect_support_diff", "Consider_support_diff"]);
  End
  
  Variable reaction_rate_1
    value:0.001;     lower:-1;    upper:1;    PhysicalQuantity:"Reaction Rate [kmol/(kg_cat s)]";
  End
       
  ReactionList as StringSet (["CH4_ox", "CO_ox", "EtOH_dec", "EtOH_ox", "EtOH_SR", "EtOH_SR_2", "EtOH_SR_3", "H2_ox", "MSR", "MSR_2", "WGS"]); //list in alphabetic order!!!
    
  CompList_sw as StringSet (["H2O","N2"]);
  CompList_p as StringSet (["H2"]);
  CompList_per as StringSet(CompList_sw+CompList_p);
  
  

  //constant parameters
  Rgas   as RealParameter (8.314); // kJ/(kmol K)
  g      as RealParameter (9.8); // m/s2
  N_comp as IntegerParameter (size(ComponentList));
  ring as IntegerParameter (3);
  pi     as RealParameter (3.141592654);
  //XDomain
  Ltot  as Length (fixed, 1);
  L1    as Length (fixed, 0.2);  //bottom region without membranes
  L2    as Length (fixed, 0.4);  //central region with membranes
  L3    as Length (free, 0.4);   //top region with tubes, not permeation (membranes supports)
  dx1   as LengthParameter (L1/10);
  dx2   as LengthParameter (L2/10);
  dx3   as LengthParameter (L3/5);
  X     as LengthDomain (HighestOrderDerivative:2, Length:Ltot, NumSections:3, Section(2).Location:L1, Section(3).Location:L1+L2, Section(1).SpacingPreference:dx1, Section(2).SpacingPreference:dx2, Section(3).SpacingPreference:dx3);

//  Solid_lev  as Set8;
  Thermal    as Set11 (value:"T_constant_no_thermal_balance");
  pattern      as Set13 (value:"polynomial");
  b_perm       as Set12 (value:"yes");
  DP           as Set12 (Value:"no");
  b_perm_coeff as notype (fixed);
  p            as notype(fixed);
  supp_diff    as Set14 (value:"Consider_support_diff");
  bed        as notype (Description:"0=packed; 0.5=partially fluidized; 1=smooth fluidization; 2=bubbling; 3=transition to turbolent; 4=other");
  Perm       as Set10 (value:"Permeance");
  solids     as notype;
  
  x2         as IntegerParameter (10);
  x2i        as IntegerParameter (x2+1);
  x3         as IntegerParameter (20);
  x3i        as IntegerParameter (x3+1);
  sweep_in_node  as IntegerParameter (x.EndNode);
  sweep_out_node as IntegerParameter (x.EndNode);
  per_out_node   as IntegerParameter (x.EndNode);
  //Geometry variables
  t_ins         as Length (fixed, 0.15); //m
  t_vessel      as Length (fixed, 0.01);
  r_vessel      as length (free, 0.10);
  D_vessel      as Length;
  t_mem         as Length (fixed, 5e-6);
  t_support     as Length (free, 0.5e-3);
  r_ext_support as Length (free);
  d_ext_support as Length (fixed, 1e-2);
  r_int_support as Length (free);
  d_int_support as Length (fixed, 4e-3); //m
  t_pipe        as Length (fixed, 5e-4);
  r_ext_pipe    as Length (free);
  r_int_pipe    as Length (fixed, 1e-3);
  t_annulus     as Length (free, 1e-3);
  S_annulus     as area (free);
  S1_vessel     as area (free); //m2
  S2_vessel     as area (free);
  S_int_pipe    as area (free);
  dA_mem        as area (free);
  dV2_annulus   as volume (free); //m3
  dV3_annulus   as volume (free);
  dV1_vessel    as volume (free);
  dV2_vessel    as volume (free);
  dV3_vessel    as volume (free);
  dV2_pipe      as volume (free);
  dV3_pipe      as volume (free);
  k_ins         as conductivity (fixed, 0.025); //W/(m K)
  k_vessel      as conductivity (fixed, 100);
  k_support     as conductivity (fixed, 1.5);
  por           as notype (fixed, 0.5);
  tor           as notype (fixed, 3);
  f_pipe        ([x2:x.EndNode]) as notype;
  rough_p       as length (fixed, 1e-7);
  N_mem         as notype (37);
  dist_mems     as length (0.025); //average distance between membranes (find algorithm to compute it!!!)
  A_mem_tot     as area;
  r_por         as length (fixed, 100*1e-9);
  kper_0    as notype (fixed, 0.00217e-3); //kmol/(s m2 bar^n) permeability
  n         as notype (fixed, 0.5);  //exponent in permeation law
  Ea        as notype (fixed, 1e4);  //appearent activation energy in permeation law
  Re_per_p ([x2:x.EndNode]) as notype;
  Re_cr_per      as notype (fixed, 2300);
  z_per       (ComponentList,[x2:x.EndNode])as molefraction; //bulk value in pereatee side
  z_ret       (ComponentList,[0:x.EndNode]) as molefraction; // bulk value in retentate side
  z_support   (ComponentList,[x2:x3])as molefraction; // internal support surface value
  z_interface (ComponentList,[x2:x3])as molefraction; // support/membrane interface
  z_cross     (ComponentList)               as molefraction;
  z_e         (ComponentList,[0:x.EndNode]) as molefraction; //emulsion phase composition
  z_b         (ComponentList,[0:x.EndNode]) as molefraction; //bubble phase composition
  z_per_p     (ComponentList)               as molefraction;
  //streams properties
  h_per    ([x2:x.EndNode]) as enth_mol; //GJ/kmol;
  h_ret    ([0:x.EndNode])  as enth_mol;
  mu_ret   ([0:x.EndNode])  as viscosity;  //cP    1 cP = 1e-3 Pa*s
  mu_per   ([x2:x.EndNode]) as viscosity;
  MW_ret   ([0:x.EndNode])  as molweight; // kg/kmol
  MW_per   ([x2:x.EndNode]) as molweight;
  k_per    ([x2:x.EndNode]) as conductivity; // W(m K)
  k_ret    ([0:x.EndNode])  as conductivity;
  cp_per   ([x2:x.EndNode]) as cp_mol; //kJ/(kmol K)
//  cp_ret   ([0:x.EndNode])  as cp_mol;
  cv_per   ([x2:x.EndNode]) as cv_mol; //kJ/(kmol K)
  cv_ret   ([0:x.EndNode])  as cv_mol;
  C_per    ([x2:x.EndNode]) as dens_mol;  //kmol/m3
  C_per_p  ([x2:x.EndNode]) as dens_mol (initial);
  C_ret    ([0:x.EndNode])  as dens_mol;
  u_per    ([x2:x.EndNode]) as velocity;  //m/s
  u_per_p  ([x2:x.EndNode]) as velocity;
  u_ret    ([0:x.EndNode])  as velocity;
  P_ret    ([0:x.EndNode])  as pressure; //bar
  P_per    ([x2:x.EndNode]) as pressure;
  P_per_p  ([x2:x.EndNode]) as pressure;
  T_ret    ([0:x.EndNode])  as temperature; //°C
  T_per    ([x2:x.EndNode]) as temperature;
  q_loss([0:x.EndNode]) as power; //kW
  Q_loss_tot as power (free, 1);
  T_wall as temperature (free, 50);
  T_amb as temperature (fixed, 20);
  ht_amb as heat_trans_coeff (fixed, 0.01); //kW/(m2 K)
  T_per_p  ([x2:x.EndNode]) as temperature;
  MW(ComponentList) as molweight;
  MW_feed_in as molweight;
  MW_sweep_in as molweight;
  MW_per_out as molweight;
  MW_ret_out as molweight;
  MW_per_p as molweight;

  F_H2_b ([x2:x3]) as flow_mol_vap; //kmol/h
  F_H2_e ([x2:x3]) as flow_mol_vap; //kmol/h
  F_H2   ([x2:x3]) as flow_mol_vap; //kmol/h
  
  //catalyst and fluidized bed properties
  m_s     as notype (free, 10); //kg
  m_s_i   ([0:x.EndNode]) as notype (initial); //kg
  s       ([0:x.EndNode]) as notype;
  m_s_cum_i([0:x.EndNode]) as notype; //kg
  m_s_check as notype;
  d_s     as length (fixed, 100e-6); //m  solid (catalyst and filler) nominal diameter
  fi_s   as fraction (fixed, 1); // solid particles sphericity
  rho_s   as dens_mass (free, 2000); //kg/m3
  rho_s_loose   as dens_mass (fixed, 1000); //kg/m3
  f_cat   as fraction (fixed, 1); //fraction of catalyst particles
  f_fil   as fraction (free, 0.5); //fraction of filler particles
  eps_0   as fraction (fixed, 0.5); //void fraction of the packed solid
  h_s_0   as length (free, 0.4); //m hight of the packed solid
  h_s     as length (free, 0.4); //m hight of the fluidized bed
  Ar      ([0:x.EndNode]) as notype; // Archimede number
  Cd      ([0:x.EndNode]) as notype(lower:1e-5); // Drag coefficient of solid particles
  u_mf    ([0:x.EndNode]) as velocity; //m/s   minimum fluidization velocity (computed at inlet conditions)
  u_t     ([0:x.EndNode]) as velocity; //m/s   solid terminal velocity
  u_t_Gib ([0:x.EndNode]) as velocity; //m/s
//  u_0     as velocity; //m/s   inlet feed velosity
  u_e     ([0:x.EndNode]) as velocity;
  u_b     ([0:x.EndNode]) as velocity;
  u_br    ([0:x.EndNode]) as velocity; //bubble rising velocity
  eps     ([0:x.EndNode]) as fraction (fixed, 0.5); //void fraction of the fluidized solid
  eps_mf  ([0:x.EndNode]) as fraction (free, 0.5); //void fraction of the minumim fluidization
  eps_e   ([0:x.EndNode]) as fraction (upper:1-1e-6, free, 0.5);
  Re_mf   ([0:x.EndNode]) as notype;
  Re_s    ([0:x.EndNode]) as notype;
  Re_mb   ([0:x.EndNode]) as notype;
  Re_c    ([0:x.EndNode]) as notype;
  Re_k    ([0:x.EndNode]) as notype;
  Re_per  ([x2:x.EndNode])as notype;

  mu_app  ([0:x.EndNode])        as notype;
  u0_umf_ratio ([0:x.EndNode])   as notype;
  u0_umf_ratio_min               as notype;
  u0_umf_ratio_min_aux           as notype;
  u0_umf_ratio_max               as notype;
  x_u0_umf_ratio_max             as notype;
  x_u0_umf_ratio_min             as notype;
  x_start_flu_aux                as notype;
  x_start_flu                    as IntegerParameter;
  u0_umf_ratio_min2              as notype;
  u0_umf_0                       as notype;
  u0_umf_1                       as notype;
  u0_umf_x2                      as notype;
  u0_umf_x2i                     as notype;
  u0_0                           as velocity;
  u0_1                           as velocity;
  u_mf_0                         as velocity;
  u_mf_1                         as velocity;
  u0_umf_ratio_0  as notype;
  u0_umf_ratio_1  as notype;
  u0_umf_ratio_x2 as notype;

  time_cross_ret   as notype (Description:"Characteristic crossing time (u_ret)[s]");
  time_cross_b     as notype (Description:"Characteristic crossing time (u_b)[s]");
  time_cross_e     as notype (Description:"Characteristic crossing time (u_e)[s]");
  time_diff        as notype (Description:"Characteristic diffusion time [s]");
  Load2surf_EtOH   as notype;
  Section_fraction as notype;
  
  check_m_b as notype;
  check_t_b as notype;
  check_s_b as notype;
  check_H2_perm as notype;
  err_t_b   as notype;
  err_m_b   as notype;
  bal_C     as notype;
  bal_H     as notype;
  bal_O     as notype;
/*
  z_H2_per ([x2:x.EndNode]) as molefraction;
  z_H2_interf ([x2:x.EndNode]) as  molefraction;
  z_H2_b ([0:x.EndNode]) as molefraction;
  z_H2_e ([0:x.EndNode]) as molefraction;
  z_H2_ret ([0:x.EndNode]) as molefraction;
*/  
  DP_bed  as pressure;
  d_b     ([0:x.EndNode])  as length;
  d_b01   as length;
  d_bmax  ([0:x.EndNode])  as length;
  delta_b ([0:x.EndNode])  as notype; //bubble fraction cross section
  delta_e ([0:x.EndNode])  as notype; //emulsion fraction cross section
  delta_b_avg_mem          as fraction;
  delta_b_min_mem          as fraction;
  delta_b_max_mem          as fraction;
  d_b_avg_mem              as length;
 // dV_s_i  ([0:x.EndNode])  as volume;
 // c_s     ([x2:x.EndNode]) as cp_mass (fixed, 0.7); //kJ/(kg K)
  
  T_reactor as temperature;

  //------------------------------
  //----- Chemical reactions -----
  //------------------------------

  //Ea_MSR                                      as RealParameter (1.069e+5);  //kJ/kmol
  Ea_WGS                                      as RealParameter (5.450e+4);  //kJ/kmol
  //A_MSR                                       as RealParameter (2.502);     //kmol/(kg_cat s) * Pa^xxx
  A_WGS                                       as RealParameter (2.45e-6);  //kmol/(kg_cat s) * Pa^xxx

  k5  as RealParameter (8.02*1e-5); //kmol/(s kg_cat)  //reaction rate constants
  Ea5 as RealParameter (72800);

  r_state  (ReactionList)                as notype;
  stoich  (ReactionList, ComponentList) as RealParameter;
  DH0_r   (ReactionList)                as enth_mol;
  DH0          (ComponentList)                as enth_mol;       //GJ/kmol  of pure species in standard conditions (298K, 1 bar)
  r       (ReactionList, [1:x.EndNode]) as reaction_rate_1;//kmol/(kg_cat s)
  T_std        as temperature (fixed, 25);    //°C
  P_std        as pressure    (fixed, 1);     //bar
  z_pure       (ComponentList, ComponentList) as molefraction;   //pure components
  ref_comp     (ReactionList)                 as StringParameter;
  EtOH_ox       as flow_mol; //kmol/h
  
  //kinetics constants for EtOH  oxidative reforming (FluidCELL)
  nM   as RealParameter (0.96);
  nW   as RealParameter (0.25);
  nC   as RealParameter (0);
  nH   as RealParameter (0);

  S2EtOH           as notype;
  S2EtOH_star      as notype;
  O22EtOH          as notype;
  HRF              as notype;
  HRF_star         as notype;
  HHV_ret          as enth_mol;  //GJ/kmol
  WHSV_EtOH        as notype; // (Description:"EtOH weight hour space velocity [(kg/h_EtOH)/kg_cat]"); //catalyst includes the support material (not the filler)
  Selectivity      as notype;
  N_sel(ComponentList) as flow_mol; //kmol/h
  k_sel            as notype (fixed, 1e-5); //kmol/(s m2 Pa)
  Sw2EtOH          as notype;
  LMPD             as notype(Description:"Log-mean pressure difference");
  Pi_avg_mem_ret (ComponentList) as pressure;
  check_mass_bal as notype;
  check_energy_bal as notype;
  H2perm as notype (Description:"H2 permeate flowrate [Nm3/h]");
  Diff_eff (ComponentList, [1:x.EndNode]) as diffusivity (lower:1e-10, free, 0.05); //cm^2/s
  Diff_eff_per(ComponentList, [x2:x.EndNode]) as diffusivity (lower:1e-10, free, 0.05); //cm^2/s

  //-----------------
  //----- Ports -----
  //-----------------
  Sweep_in   as input MoleFractionPort;
  Feed_in    as input MoleFractionPort;
  Per_out    as output MoleFractionPort;
  Ret_out    as output MoleFractionPort;
  Heat       as input,output HeatPort;
  Power      as input,output HeatPort;
  

  //-------------------------------
  //----- streams connections -----
  //-------------------------------

  If (Feed_in.IsConnected) then
    Feed_in.P : free;
    Feed_in.T : free;
    Feed_in.F : free;
    Feed_in.z(ComponentList) : free;
    Feed_in.h : free;
    Feed_in.V : free;
  Else
  
    Feed_in.P : fixed;
    Feed_in.T : fixed;
    Feed_in.F : fixed;
    Feed_in.z : fixed;
    Feed_in.h : free;
    Feed_in.V : free;
    Feed_in.P : 15;
    Feed_in.T : 500;
    Feed_in.F : 0.3;
    //Feed_in.z(ComponentList) : 1/size(ComponentList);
    Feed_in.z(ComponentList-"EtOH"-"O2"-"H2O"-"N2") : 0;
    Feed_in.z("EtOH") : 0.15;
    Feed_in.z("O2")   : 0.05;
    Feed_in.z("N2")   : 0.25;
    Feed_in.z("H2O")  : 0.55;
    Feed_in.V*C_ret(0)=1;
    call(Feed_in.h) = pEnth_mol(Feed_in.T, Feed_in.P, Feed_in.z(ComponentList));
  EndIf
  
  Feed_in.F = C_ret(0)*u_ret(0)*S1_vessel*3600;
  Feed_in.z(ComponentList) = z_ret(ComponentList, 0);
  Feed_in.P = P_ret(0);
  Feed_in.T = T_ret(0);

  If (Sweep_in.IsConnected) then
    Sweep_in.P : free;
    Sweep_in.T : free;
    Sweep_in.F : free;
    Sweep_in.z(ComponentList) : free;
    Sweep_in.h : free;
    Sweep_in.V : free;
  Else
    Sweep_in.P : fixed;
    Sweep_in.T : fixed;
    Sweep_in.F : fixed;
    Sweep_in.z(ComponentList) : fixed;
    Sweep_in.h : free;
    Sweep_in.V : free;
    Sweep_in.P : 1;
    Sweep_in.T : 500;
    Sweep_in.F : 0.3;
    Sweep_in.z(ComponentList-"H2O"-"H2") : 0;
    Sweep_in.z("H2O") : 1;
    Sweep_in.z("H2") : 0.00;
    Sweep_in.V*C_per(sweep_in_node)=1;
    call(Sweep_in.h) = pEnth_mol(Sweep_in.T, Sweep_in.P, Sweep_in.z(ComponentList));
EndIf
  
  Sweep_in.F = C_per(sweep_in_node)*u_per(sweep_in_node)*S_annulus*N_mem*3600;
  Sweep_in.z(ComponentList) = z_per(ComponentList, sweep_in_node);
  Sweep_in.P = P_per(sweep_in_node);
  Sweep_in.T = T_per(sweep_in_node);

    Ret_out.P = P_ret(x.EndNode);
    Ret_out.T = T_ret(x.EndNode);
    Ret_out.F = C_ret(x.EndNode)*u_ret(x.EndNode)*S2_vessel*3600 ;//- sigma(N_sel(ComponentList-"H2"));
    Ret_out.z(ComponentList) = z_ret(ComponentList,x.EndNode);
    Ret_out.h = h_ret(x.EndNode);
    Ret_out.V = 1/C_ret(x.EndNode);
    
    Per_out.P = P_per_p(per_out_node);
    Per_out.T = T_per(x2);
    Per_out.F = C_per_p(per_out_node)*u_per_p(per_out_node)*S_int_pipe*N_mem*3600 ;//+ sigma(N_sel(ComponentList-"H2"));
    Per_out.z(ComponentList) = z_per(ComponentList,x2);
    call(Per_out.h) = pEnth_mol(Per_out.T, Per_out.P, Per_out.z(ComponentList));
    Per_out.V = 1/C_per_p(per_out_node);


  //--------------------
  //----- Geometry -----
  //--------------------

  Ltot          = L1+L2+L3;
  dA_mem        = pi*2*r_ext_support*dx2;
  t_annulus     = r_int_support-r_ext_pipe;
  r_ext_pipe    = r_int_pipe+t_pipe;
  r_ext_support = r_int_support+t_support;
  d_ext_support = r_ext_support*2;
  d_int_support = r_int_support*2;
  S1_vessel     = pi*r_vessel^2;
  S2_vessel     = pi*(r_vessel^2-r_ext_support^2*N_mem);
  S_annulus     = pi*(r_int_support^2-r_ext_pipe^2);
  S_int_pipe    = pi*r_int_pipe^2;
  dV2_annulus   = S_annulus*dx2;
  dV3_annulus   = S_annulus*dx3;
  dV1_vessel    = S1_vessel*dx1;
  dV2_vessel    = S2_vessel*dx2;
  dV3_vessel    = S2_vessel*dx3;
  dV2_pipe      = S_int_pipe*dx2;
  dV3_pipe      = S_int_pipe*dx3;
  A_mem_tot     = pi*2*r_ext_support*L2*N_mem;
  D_vessel      = 2*r_vessel;

  // membranes pattern
If pattern == "exagonal_pattern" then
  r_vessel: free;
  N_mem: free;
  dist_mems: fixed;
  N_mem = 1+sigma(foreach (i in [1:ring]) i*6);
  r_vessel = r_ext_support + ring*(dist_mems+2*r_ext_support) + dist_mems;
else
  if pattern == "circular_pattern" then
    r_vessel: free;
    dist_mems: fixed;
    r_vessel = r_ext_support + ring*(dist_mems+2*r_ext_support) + dist_mems;
    N_mem: free;
    N_mem = sigma(foreach (i in [1:ring]) truncate((2*pi*(i*dist_mems+(2*i)*r_ext_support))/(2*r_ext_support+dist_mems)));
  else
    if pattern == "polynomial" then //range:D_vessel=0.08-0.40m; dist_mems+d_ext_support=0.02-0.044m;
      r_vessel:fixed;
      dist_mems:fixed;
      N_mem:free;
      N_mem = min(1, round(-20146.95424*(dist_mems+d_ext_support)   +1640.411805*D_vessel
                           +1286119.585*(dist_mems+d_ext_support)^2 -168946.1591*(dist_mems+d_ext_support)  *D_vessel +5727.773358*D_vessel^2 
                           -33667079.03*(dist_mems+d_ext_support)^3 +5538295.554*(dist_mems+d_ext_support)^2*D_vessel -251764.9726*(dist_mems+d_ext_support)  *D_vessel^2 -2.916925107*(D_vessel)^3
                           +309806795  *(dist_mems+d_ext_support)^4 -58114373.37*(dist_mems+d_ext_support)^3*D_vessel +2949031.103*(dist_mems+d_ext_support)^2*D_vessel^2 +5197.760616*(dist_mems+d_ext_support)*D_vessel^3     -138.3494849*(D_vessel)^4 +105.7854398));
    else
      if pattern == "no_pattern_r_vessel_fixed" then //--> there is no control on the geometric feaseablility of the membranes distance (like in Delphi software)
        r_vessel: fixed;
        dist_mems: fixed;
        N_mem: fixed;
      else //"no_pattern_u0_umf_fixed"
        r_vessel: free;
        u0_umf_ratio(0): fixed;
      endif
    endif
  endif
endif

If (d_s>40e-6 and d_s<500e-6) then
    If (rho_s>1.4e+3 and rho_s<4e+3) then
      Solids=2;  // Geldart_B; limited on dimensions and density 
    Else
      If rho_s<1.4e+3 then
        Solids=1; //Geldart_A; same dimension, lighter solid
      Else
        Solids=4; //Geldart_D;
      EndIf
    EndIf
  Else
    If d_s<40e-6 then
      Solids=3; //Geldart_C;  //very small particles
    Else
      Solids=4; //Geldart_D  //very coarse particles
    EndIf
  EndIf

  If b_perm == "yes" then
    b_perm_coeff: 1;
  Else
    b_perm_coeff: 0;
  EndIf

  If DP == "yes" then
    p: 1;
  Else
    p: 0;
  EndIf

  If max(u0_umf_ratio)<1 then
    bed = 0; //packed bed
  else
    if (min(u0_umf_ratio)<1 and max(u0_umf_ratio)>1) then
      bed = 0.5; //partially fluidized bed
    else
      if max(Re_s) < min(Re_mb) then
        bed = 1; //homogeneus fluidization (minimum, no bubbles)
      else
        if max(Re_s) < min(Re_c) then
          bed = 2; //bubbling bed
        else
          if max(Re_s) < min(Re_k) then
          bed = 3; //transition bubbling to turbolent
          else
          bed = 4; //turbolent or fast fluidization
          endif
        endif
      endif
    endif
  endif

  time_cross_ret = h_s/(sigma(u_ret)/sigma(s));  //s
  time_cross_e = h_s/(sigma(u_e)/sigma(s));  //s
  time_cross_b = h_s/(sigma(u_b)/sigma(s));  //s
  
  WHSV_EtOH = C_ret(0)*u_ret(0)*MW("EtOH")*z_ret("EtOH",0)*S1_vessel/sigma(foreach (i in [x2i:x3]) m_s_i(i)*f_cat); // (kg/_EtOH)/kg_cat = 1/h

  z_cross(ComponentList-"H2")=0;
  z_cross("H2")=1;

  //creation of dummy vectros for pure components properties
  For m in ComponentList do
    For n in componentList do
      If m==n then
        z_pure(m,n) = 1;
      Else
        z_pure(m,n) = 0;
      Endif
    EndFor
  EndFor

  call(MW(ComponentList))= pMolWeights();

  check_m_b = C_ret(0)*u_ret(0)*S1_vessel*3600*MW_ret(0) + C_per(x.EndNode)*u_per(x.EndNode)*S_annulus*N_mem*3600*MW_per(x.EndNode)
            - C_ret(x.EndNode)*u_ret(x.EndNode)*S2_vessel*3600*MW_ret(x.EndNode) - C_per_p(x.EndNode)*u_per_p(x.EndNode)*S_int_pipe*N_mem*3600*MW_per_p; // kg/h
  check_t_b = (Feed_in.F*Feed_in.h + Sweep_in.F*Sweep_in.h - Ret_out.F*Ret_out.h - Per_out.F*Per_out.h)/3600*1e6 - Q_loss_tot;   //kW
  err_t_b = (check_t_b*3600/1e6)/(abs(Feed_in.F*z_ret("O2",0)/2*DH0_r("EtOH_ox")))*100;  //%
  err_m_b = check_m_b/(C_ret(0)*u_ret(0)*S1_vessel*3600*MW_ret(0))*100; //%

  check_H2_perm = sigma(ForEach(i in [x2:x3])F_H2(i))*N_mem - Per_out.F*Per_out.z("H2");

  // check atom balance //kmol/h
    bal_C = Feed_in.F*(2*Feed_in.z("EtOH")+1*Feed_in.z("CH4")+1*Feed_in.z("CO")+1*Feed_in.z("CO2")+0*Feed_in.z("H2")+0*Feed_in.z("H2O")+0*Feed_in.z("N2")+0*Feed_in.z("O2"))
           +Sweep_in.F*(2*Sweep_in.z("EtOH")+1*Sweep_in.z("CH4")+1*Sweep_in.z("CO")+1*Sweep_in.z("CO2")+0*Sweep_in.z("H2")+0*Sweep_in.z("H2O")+0*Sweep_in.z("N2")+0*Sweep_in.z("O2"))
           -Ret_out.F*(2*Ret_out.z("EtOH")+1*Ret_out.z("CH4")+1*Ret_out.z("CO")+1*Ret_out.z("CO2")+0*Ret_out.z("H2")+0*Ret_out.z("H2O")+0*Ret_out.z("N2")+0*Ret_out.z("O2"))
           -Per_out.F*(2*Per_out.z("EtOH")+1*Per_out.z("CH4")+1*Per_out.z("CO")+1*Per_out.z("CO2")+0*Per_out.z("H2")+0*Per_out.z("H2O")+0*Per_out.z("N2")+0*Per_out.z("O2"));

    bal_H = Feed_in.F*(6*Feed_in.z("EtOH")+4*Feed_in.z("CH4")+0*Feed_in.z("CO")+0*Feed_in.z("CO2")+2*Feed_in.z("H2")+2*Feed_in.z("H2O")+0*Feed_in.z("N2")+0*Feed_in.z("O2"))
           +Sweep_in.F*(6*Sweep_in.z("EtOH")+4*Sweep_in.z("CH4")+0*Sweep_in.z("CO")+0*Sweep_in.z("CO2")+2*Sweep_in.z("H2")+2*Sweep_in.z("H2O")+0*Sweep_in.z("N2")+0*Sweep_in.z("O2"))
           -Ret_out.F*(6*Ret_out.z("EtOH")+4*Ret_out.z("CH4")+0*Ret_out.z("CO")+0*Ret_out.z("CO2")+2*Ret_out.z("H2")+2*Ret_out.z("H2O")+0*Ret_out.z("N2")+0*Ret_out.z("O2"))
           -Per_out.F*(6*Per_out.z("EtOH")+4*Per_out.z("CH4")+0*Per_out.z("CO")+0*Per_out.z("CO2")+2*Per_out.z("H2")+2*Per_out.z("H2O")+0*Per_out.z("N2")+0*Per_out.z("O2"));

    bal_O = Feed_in.F*(1*Feed_in.z("EtOH")+0*Feed_in.z("CH4")+1*Feed_in.z("CO")+2*Feed_in.z("CO2")+0*Feed_in.z("H2")+1*Feed_in.z("H2O")+0*Feed_in.z("N2")+2*Feed_in.z("O2"))
           +Sweep_in.F*(1*Sweep_in.z("EtOH")+0*Sweep_in.z("CH4")+1*Sweep_in.z("CO")+2*Sweep_in.z("CO2")+0*Sweep_in.z("H2")+1*Sweep_in.z("H2O")+0*Sweep_in.z("N2")+2*Sweep_in.z("O2"))
           -Ret_out.F*(1*Ret_out.z("EtOH")+0*Ret_out.z("CH4")+1*Ret_out.z("CO")+2*Ret_out.z("CO2")+0*Ret_out.z("H2")+1*Ret_out.z("H2O")+0*Ret_out.z("N2")+2*Ret_out.z("O2"))
           -Per_out.F*(1*Per_out.z("EtOH")+0*Per_out.z("CH4")+1*Per_out.z("CO")+2*Per_out.z("CO2")+0*Per_out.z("H2")+1*Per_out.z("H2O")+0*Per_out.z("N2")+2*Per_out.z("O2"));
    
  //--------------------
  //--------------------
  //--------------------

  For i in [x2:x.EndNode] do
    Eq_C_per:           C_per(i) = P_per(i)*1e5/(Rgas*(T_per(i)+273.15))*1e-3; //kmol/m3
    Eq_C_per_p:         C_per_p(i) = P_per_p(i)*1e5/(Rgas*(T_per(x2)+273.15))*1e-3;
    Eq_h_per:           call(h_per(i))  = pEnth_Mol   (T_per(i), P_per(i), z_per(ComponentList,i)); //GJ/kmol
    Eq_mu_per:          call(mu_per(i)) = pVisc_Vap   (T_per(i), P_per(i), z_per(ComponentList,i)); //cP
    Eq_MW_per:          call(MW_per(i)) = pMolWeight  (z_per(ComponentList,i));
    //dimensionless numbers
    Eq_Re_per:          Re_per(i) = C_per(i)*MW_per(i)*abs(u_per(i))*(2*t_support)/(mu_per(i)*1e-3);
    Eq_Re_per_p:        Re_per_p(i) = C_per_p(i)*MW_per(x2)*abs(u_per_p(i))*2*r_int_pipe/(mu_per(x2)*1e-3);
  EndFor
  
  For i in [0:x.EndNode] do
    //ideal gas molar density
    Eq_C_ret:      C_ret(i) = P_ret(i)*1e5/(Rgas*(T_ret(i)+273.15))*1e-3; //kmol/m3
    //streams properties
    Eq_h_ret:      call(h_ret(i))  = pEnth_Mol   (T_ret(i), P_ret(i), z_ret(ComponentList,i)); //GJ/kmol
    Eq_mu_ret:     call(mu_ret(i)) = pVisc_Vap   (T_ret(i), P_ret(i), z_ret(ComponentList,i));
    Eq_MW_ret:     call(MW_ret(i)) = pMolWeight  (z_ret(ComponentList,i)); //kg/kmol 
  EndFor

  //------------------------
  //----- fluidization -----
  //------------------------

  Eq_rho_s_loose:            rho_s_loose = rho_s*(1-eps_0);
  Eq_f_fil:                  f_fil = 1 - f_cat;
  Eq_u0_umf_ratio_min:       u0_umf_ratio_min = min(u0_umf_ratio);
  Eq_u0_umf_ratio_max:       u0_umf_ratio_max = max(u0_umf_ratio);
  
   //to be computed in each section, but very small
  If bed<1 then
    d_b01 = 0;
  Else
    Eq_db01:       d_b01 = 2.78/g*(u_ret(0)-u_mf(0))^2*1e-2; //m  check units of measure!!! valid for high gas flow rates through distributors and porous plates [5.19]
  EndIf

  For i in [1:x.EndNode] do
    If bed==1 then  //smooth fluidization
      Eq_delta_b1:   delta_b(i) = 0.001; // it should be 0, no bubbles 
      Eq_delta_e1:   delta_e(i) = 1-delta_b(i);
    else      
      Eq_delta_b2:    delta_b(i) = (u_ret(i)-u_e(i)*delta_e(i))/u_b(i); //(u_ret(i)-u_mf(i))/(u_b(i)-u_mf(i));
      Eq_delta_e2:    delta_e(i) = 1-delta_b(i);  //-delta_w(i)-delta_c(i);
    endif
  EndFor
  delta_e(0) = 1;
  delta_b(0) = 0;

  delta_b_avg_mem = sigma(foreach (i in [x2i:x3]) delta_b(i))/(x3-x2i);
  delta_b_min_mem = min(delta_b([x2i:x3]));
  delta_b_max_mem = max(delta_b([x2i:x3]));
  d_b_avg_mem = sigma(foreach (i in [x2i:x3]) d_b(i))/(x3-x2i);
   
  For i in [0:x.EndNode] do
  Eq_Ar:           Ar(i) = d_s^3*C_ret(i)*MW_ret(i)*(rho_s-C_ret(i)*MW_ret(i))*g/(mu_ret(i)*1e-3)^2;
//  Eq_mu_app:       mu_app(i) = mu_ret(i)*(1+2.5*(1-eps_e(i))+10.05*(1-eps_e(i))^2+0.00273*exp(16.6*(1-eps_e(i))));   // Thomas model --> ok for zero bouyancy, not this case
//  Eq_eps_mf:       eps_mf(i) = 0.586*(Ar(i)^(-0.029))*(C_ret(i)*MW_ret(i)/rho_s)^0.021; --> substitute 0.586 with (1-eps_0)
  // Equation from Martin van Sint Annaland:
  Eq_eps_mf:       eps_mf(i) = 0.382*(Ar(i)^(-0.196)*(rho_s/(C_ret(i)*MW_ret(i)))^(-0.143)+1)*((T_ret(i)+273)/298)^0.083;
//Eq_u_mf:         1.75*Re_s_mf(i)^2/(eps_mf(i)^3*fi_s)+150*(1-eps_mf(i))/(eps_mf(i)^3*fi_s^2)*Re_s_mf(i) = Ar(i);
  // here written with Re_mf explicit
  //Eq_u_mf:         1.75*(d_s*u_mf(i)*C_ret(i)*MW_ret(i)/(mu_ret(i)*1e-3))^2/(eps_mf(i)^3*fi_s) + 150*(1-eps_mf(i))/(eps_mf(i)^3*fi_s^2)*(d_s*u_mf(i)*C_ret(i)*MW_ret(i)/(mu_ret(i)*1e-3)) = Ar(i);
  Eq_u_mf:         u_mf(i) = mu_ret(i)*1e-3/(d_s*C_ret(i)*MW_ret(i))*(sqrt(27.2^2+0.0408*Ar(i))-27.2);
  Eq_u0_umf:       u0_umf_ratio(i) = u_ret(i)/u_mf(i);
//  Eq_Re_b:       Re_b(i) = d_b(i)*u_br(i)*(rho_s*(1-eps_e(i)+C_ret(i)*MW_ret(i)*eps_e(i)))/(850*1e-3); // denominaror is appearent emulsion phase viscosity (suggested 400-1300 cP)
  Eq_Re_s:         Re_s(i) = d_s*u_ret(i)*C_ret(i)*MW_ret(i)/(mu_ret(i)*1e-3);
  Eq_Re_mb:        Re_mb(i) = 0.00464*Ar(i)^(2/3);
  Eq_Re_c:         Re_c(i) = 0.0791*Ar(i)^(0.435);
  Eq_Re_k:         Re_k(i) = 1.31*Ar(i)^(0.450);

    If i<=x2 then
        Eq_d_bmax1:     d_bmax(i) = max(2e-8, 0.65*(pi*r_vessel^2*abs(u_ret(i)-u_mf(i)))^0.4); // [6.5]
        Eq_d_b1:        d_b(i) = max(1e-8, d_bmax(i)-(d_bmax(i)-d_b01)*exp(-0.3*i*dx1/D_vessel)); // [6.4]
        If d_b(i)/D_vessel<0.125 then
          Eq_u_br1:       u_br(i) = 0.711*(g*d_b(i))^0.5;
        Else
          If d_b(i)/D_vessel<0.6 then
            Eq_u_br2:       u_br(i) = 0.711*(g*d_b(i))^0.5*1.2*exp(-1.49*d_b(i)/D_vessel);
          Else  //slug flow
            Eq_u_br3:       u_br(i) = 0.35*(g*D_vessel)^0.5;
          Endif
        Endif
      Else
          If i<=x3 then
            Eq_d_bmax2:     d_bmax(i) = max(2e-8, 0.65*(pi*r_vessel^2*abs(u_ret(i)-u_mf(i)))^0.4);
            If d_b(x2)<dist_mems then
              Eq_d_b2:        d_b(i) = min(dist_mems, d_bmax(i)-(d_bmax(i)-d_b01)*exp(-0.3*((i-x2-1)*dx2+L1)/D_vessel));
              If d_b(i)/dist_mems<0.125 then
                Eq_u_br4:       u_br(i) = 0.711*(g*d_b(i))^0.5;
              Else
                If d_b(i)/dist_mems<=0.6 then      //2*r_vessel substitued by dist_mems;  limit of 0.6 increased to 1 to pass to slug flow; DOUBT: WHEN SLUG RAISES BETWEEN MEMBRANES?
                  Eq_u_br5:       u_br(i) = 0.711*(g*d_b(i))^0.5*1.2*exp(-1.49*d_b(i)/D_vessel);
                Else
                  Eq_u_br6:       u_br(i) = 0.35*(g*dist_mems)^0.5;
                Endif
              Endif
            Else
              Eq_d_b3:        d_b(i) = max(1e-8, d_bmax(i)-(d_bmax(i)-d_b01)*exp(-0.3*((i-x2-1)*dx2+L1)/D_vessel));
              If d_b(i)/D_vessel<0.125 then
                Eq_u_br7:       u_br(i) = 0.711*(g*d_b(i))^0.5;
              Else
                If d_b(i)/D_vessel<=0.6 then
                  Eq_u_br8:       u_br(i) = 0.711*(g*d_b(i))^0.5*1.2*exp(-1.49*d_b(i)/D_vessel);
                Else
                  Eq_u_br9:       u_br(i) = 0.35*(g*D_vessel)^0.5;
                Endif
              Endif
            Endif
        Else
          Eq_d_bmax3:     d_bmax(i) = max(2e-8, 0.65*(pi*r_vessel^2*abs(u_ret(i)-u_mf(i)))^0.4);
          if d_b(x2)<dist_mems then
            Eq_d_b4:        d_b(i) = min(dist_mems, d_bmax(i)-(d_bmax(i)-d_b01)*exp(-0.3*((i-x3-1)*dx3+L2)/D_vessel));
            If d_b(i)/dist_mems<0.125 then
                Eq_u_br10:       u_br(i) = 0.711*(g*d_b(i))^0.5;
              Else
                If d_b(i)/dist_mems<=0.6 then
                  Eq_u_br11:       u_br(i) = 0.711*(g*d_b(i))^0.5*1.2*exp(-1.49*d_b(i)/D_vessel);
                Else
                  Eq_u_br12:       u_br(i) = 0.35*(g*dist_mems)^0.5;
                Endif
              Endif
          else
            Eq_d_b5:        d_b(i) = max(1e-8, d_bmax(i)-(d_bmax(i)-d_b01)*exp(-0.3*((i-x2-1)*dx2+L1)/D_vessel));
            If d_b(i)/D_vessel<0.125 then
                Eq_u_br13:       u_br(i) = 0.711*(g*d_b(i))^0.5;
              Else
                If d_b(i)/D_vessel<=0.6 then
                  Eq_u_br14:       u_br(i) = 0.711*(g*d_b(i))^0.5*1.2*exp(-1.49*d_b(i)/D_vessel);
                Else
                  Eq_u_br15:       u_br(i) = 0.35*(g*D_vessel)^0.5;
                Endif
              Endif
          endif
        EndIf
        
      EndIf
      
      Eq_eps_e1:      eps_e(i) = eps_mf(i);
  EndFor

For i in [1:x.EndNode] do
  Eq_u_b1:        u_b(i) = u_ret(i)-u_mf(i)+u_br(i);
  Eq_u_e1:        u_e(i) = u_mf(i);
  //Eq_u_e1:        (eps_e(i)/eps_mf(i))^3 *(1-eps_mf(i))/(e-epse(i)) = (u_e(i)/u_mf)^0.7;
EndFor
u_b(0) = 0;
u_e(0) = u_ret(0);

// ----------  
// methode 3: compute local solid mass till specified heigh and the corresponding total mass
// ----------
// suggested in design mode, because it is possible to set the desired heigh of the bed (the same as the embranes level, as in Delphi model from TU/e) and compute the corresponding mass

  For i in [1:x.EndNode] do
        If i<=x2 then  //bottom region
          Eq_m_s_i5:         m_s_i(i) = rho_s*(1-eps_e(i))*dx1*S1_vessel*(1-delta_b(i));
        Else  //membranes region
          If i<=x3 then
            Eq_m_s_i6:         m_s_i(i) = rho_s*(1-eps_e(i))*dx2*S2_vessel*(1-delta_b(i));
          Else  //supports region
            Eq_m_s_i7:         m_s_i(i) = 1e-20; //rho_s*(1-eps_e(i))*dx3*S2_vessel*(1-delta_b(i));
          EndIf
        EndIf
  EndFor
  Eq_m_s_i8:         m_s_i(0) = 1e-20;
  Eq_h_s_0:
  If m_s/(rho_s*(1-eps_0)) <= L1 then
    m_s/(rho_s*(1-eps_0)) = h_s_0*S1_vessel;
  Else
    m_s/(rho_s*(1-eps_0)) = L1*(S1_vessel-S2_vessel)+h_s_0*S2_vessel;
  EndIf
  Eq_h_s:            h_s = L1+L2;
  Eq_s_cum_i0: m_s_cum_i(0) = 0;
  For i in [1:x.EndNode] do
    Eq_s_cum_i: m_s_cum_i(i) = m_s_cum_i(i-1)+m_s_i(i);
    If m_s_i(i) > 1e-5 then
      s(i) = 1;
    else
      s(i) = 0;
    endif
  EndFor
  m_s = max(m_s_cum_i);
  s(0) = 0;
  // solid balance check
  Eq_check_s_b:   check_s_b = sigma(m_s_i)-m_s;

  //------------------------------
  //----- Chemical reactions -----
  //------------------------------
    //stoichiometric coefficients of listed chemical reactions
    //Eq_stc_MSR: CH4 + H2O --> CO + 3 H2
    stoich("MSR","CH4"): -1;
    stoich("MSR","H2O"): -1;
    stoich("MSR","CO"):   1;
    stoich("MSR","H2"):   3;
    stoich("MSR",ComponentList-"CH4"-"H2O"-"CO"-"H2"): 0;
    //Eq_stc_MSR_2: CH4 + 2 H2O --> CO2 + 4 H2
    stoich("MSR_2","CH4"): -1;
    stoich("MSR_2","H2O"): -2;
    stoich("MSR_2","CO2"):  1;
    stoich("MSR_2","H2"):   4;
    stoich("MSR_2",ComponentList-"CH4"-"H2O"-"CO2"-"H2"): 0;
    //Eq_stc_WGS: CO + H2O --> CO2 + H2
    stoich("WGS","CO"):   -1;
    stoich("WGS","H2O"):  -1;
    stoich("WGS","CO2"):   1;
    stoich("WGS","H2"):    1;
    stoich("WGS",ComponentList-"CO"-"H2O"-"CO2"-"H2"): 0;
    //Eq_stc_EtOH_decomposition: EtOH --> CH4 + CO + H2
    stoich("EtOH_dec","EtOH"): -1;
    stoich("EtOH_dec","CH4"):   1;
    stoich("EtOH_dec","CO"):    1;
    stoich("EtOH_dec","H2"):    1;
    stoich("EtOH_dec",ComponentList-"EtOH"-"CH4"-"CO"-"H2"):0;
    //Eq_stc_EtOH_oxidation: EtOH + 3 O2 --> 2 CO2 + 3 H2O
    stoich("EtOH_ox","EtOH"): -1.0;
    stoich("EtOH_ox","O2"):   -3.0;
    stoich("EtOH_ox","CO2"):   2.0;
    stoich("EtOH_ox","H2O"):   3.0;
    stoich("EtOH_ox",ComponentList-"EtOH"-"O2"-"CO2"-"H2O"):0;
    //Eq_stc_EtOH_SR: EtOH + 2 H2O --> 2 CO + 5 H2
    stoich("EtOH_SR","EtOH"): -1;
    stoich("EtOH_SR","H2O"):  -1;
    stoich("EtOH_SR","CO"):    2;
    stoich("EtOH_SR","H2"):    5;
    stoich("EtOH_SR",ComponentList-"EtOH"-"H2O"-"CO"-"H2"):0;
    //Eq_stc_EtOH_SR_2: EtOH + H2O --> CO2 + CH4 + 2 H2
    stoich("EtOH_SR_2","EtOH"): -1;
    stoich("EtOH_SR_2","H2O"):  -1;
    stoich("EtOH_SR_2","CO2"):   1;
    stoich("EtOH_SR_2","CH4"):   1;
    stoich("EtOH_SR_2","H2"):    2;
    stoich("EtOH_SR_2",ComponentList-"EtOH"-"H2O"-"CO2"-"CH4"-"H2"):0;
    //Eq_stc_EtOH_SR_3: EtOH + 3 H2O --> 2 CO2 + 6 H2
    stoich("EtOH_SR_3","EtOH"): -1;
    stoich("EtOH_SR_3","H2O"):  -3;
    stoich("EtOH_SR_3","CO2"):   2;
    stoich("EtOH_SR_3","H2"):    6;
    stoich("EtOH_SR_3",ComponentList-"EtOH"-"H2O"-"CO2"-"H2"):0;
    //Eq_stc_CH4_ox: CH4 + 2 O2 --> CO2 + 2 H2O
    stoich("CH4_ox","CH4"):  -1;
    stoich("CH4_ox","O2"):   -2;
    stoich("CH4_ox","CO2"):   1;
    stoich("CH4_ox","H2O"):   2;
    stoich("CH4_ox",ComponentList-"CH4"-"O2"-"CO2"-"H2O"):0;
    //Eq_stc_H2_ox: H2 + 0.5 O2 --> H2O
    stoich("H2_ox","H2"):  -1.0;
    stoich("H2_ox","O2"):  -0.5;
    stoich("H2_ox","H2O"):  1.0;
    stoich("H2_ox",ComponentList-"H2"-"O2"-"H2O"):0;
    //Eq_stc_CO_ox: CO + 0.5 O2 --> CO2
    stoich("CO_ox","CO"):  -1.0;
    stoich("CO_ox","O2"):  -0.5;
    stoich("CO_ox","CO2"):  1.0;
    stoich("CO_ox",ComponentList-"CO"-"O2"-"CO2"):0;
    //put zero all other reactions (just in case some are listed but not necessay and approved)
    stoich(ReactionList-"CH4_ox"-"CO_ox"-"EtOH_dec"-"EtOH_ox"-"EtOH_SR"-"EtOH_SR_2"-"EtOH_SR_3"-"H2_ox"-"MSR"-"MSR_2"-"WGS",ComponentList):0;

    ref_comp("MSR"):"CH4";
    ref_comp("MSR_2"):"CH4";
    ref_comp("WGS"):"CO";
    ref_comp("EtOH_dec"):"EtOH";
    ref_comp("EtOH_ox"):"EtOH";
    ref_comp("EtOH_SR"):"EtOH";
    ref_comp("EtOH_SR_2"):"EtOH";
    ref_comp("EtOH_SR_3"):"EtOH";
    ref_comp("CH4_ox"):"CH4";
    ref_comp("H2_ox"):"H2";
    ref_comp("CO_ox"):"CO";
  
    
  // DH0 (Tstd,Pstd) of listed chemical reactions
  For k in ReactionList do
    Eq_DH0_r:        DH0_r(k) = sigma(stoich(k,ComponentList)*DH0(ComponentList));
  EndFor
  // DH0 (formation: T_std, P_std) of pure species 
  For m in ComponentList do
    Eq_DH0_species:  call(DH0(m)) = pEnth_Mol_Vap(T_std, P_std, z_pure(m,ComponentList));
  EndFor

  r_state("MSR") = 1;
  r_state("WGS") = 1;
  r_state("CH4_ox") = 0;
  r_state(ReactionList-"MSR"-"WGS"-"CH4_ox") = 0;

  For i in [1:x.EndNode] do
    Eq_r_MSR_FluiCELL:     r("MSR",i) = k5*exp(-Ea5/(Rgas*(T_ret(i)+273))) * (max(0.0000001, P_ret(i)*z_e("CH4",i)*1e5))^nM * (max(0.0000001, P_ret(i)*z_e("H2O",i)*1e5))^nW * (max(0.0000001, P_ret(i)*z_e("CO",i)*1e5))^nC * (max(0.0000001, P_ret(i)*z_e("H2",i)*1e5))^nH * ( 1 - (max(0.0000001, P_ret(i)*1e5*z_e("H2",i)))^3*(max(0.0000001, P_ret(i)*1e5*z_e("CO",i)))^1*(max(0.0000001, P_ret(i)*1e5*z_e("CH4",i)))^(-1)*(max(0.0000001, P_ret(i)*1e5*z_e("H2O",i)))^(-1)/(119.8*1e21*exp(-26830/(T_ret(i)+273)))  );     //exp(-(53717-60.25*(T_ret(i)+273))/(1.987*(T_ret(i)+273))) ) ;  //kmol/(s kg_cat);;// *a(i); //
    Eq_r_WGS:              r("WGS",i) = A_WGS*exp(-Ea_WGS/(Rgas*(T_ret(i)+273))) * (max(0.00001, P_ret(i)*1e5*z_e("H2O",i)))^(-1)     * (P_ret(i)*1e5*z_e("H2O",i) * P_ret(i)*1e5*z_e("CO",i)  - (P_ret(i)*1e5*z_e("H2",i) * P_ret(i)*1e5*z_e("CO2",i))    / (1.767*1e-2*exp(4400/(T_ret(i)+273)))    /*(exp(-DG0_r("WGS",i)*1e6/(Rgas*(T_ret(i)+273))))*/ );                     //(exp(-DG0_r("WGS",i)*1e6/(Rgas*(T_ret(i)+273)))) );
    Eq_r_CH4_ox_Trimm_Lam: r("CH4_ox",i) = ((8.11e-5*exp(-86000/Rgas/(T_ret(i)+273))*P_ret(i)*z_ret("CH4",i)*1e5*P_ret(i)*z_ret("O2",i)*1e5)
                                            / (1 + 1.26e-6*exp(27000/Rgas/(T_ret(i)+273))*max(1e-5, P_ret(i)*z_ret("CH4",i)*1e5) + 7.82e-2*exp(92800/Rgas/(T_ret(i)+273))*max(1e-5, P_ret(i)*z_ret("O2",i)*1e5))^2
                                            + (6.82e-5*exp(-86000/Rgas/(T_ret(i)+273))*P_ret(i)*z_ret("CH4",i)*1e5*P_ret(i)*z_ret("O2",i)*1e5)
                                            / (1 + 1.26e-6*exp(27000/Rgas/(T_ret(i)+273))*max(1e-5, P_ret(i)*z_ret("CH4",i)*1e5) + 7.82e-2*exp(92800/Rgas/(T_ret(i)+273))*max(1e-5, P_ret(i)*z_ret("O2",i)*1e5)))*1e-3; //kmol/(s kg_cat)
    Eq_r_others_FluiCELL:  r(ReactionList-"MSR"-"WGS"-"CH4_ox",i) = 0;
  //r_NK(i)  = A_MSR*exp(-Ea_MSR/(Rgas*(T_ret(i)+273))) * (max(0.00001, P_ret(i)*z_e("H2O",i)*1e+5))^(-1.596) * (P_ret(i)*z_e("H2O",i)*1e+5 * P_ret(i)*z_e("CH4",i)*1e+5 - (P_ret(i)*z_e("CO",i)*1e+5 * (P_ret(i)*z_e("H2",i)*1e+5)^3)/ (119.8*1e21*exp(-26830/(T_ret(i)+273)));            //(exp(-DG0_r("MSR",i)*1e6/(Rgas*(T_ret(i)+273))))  );
  EndFor


  //--------------------------
  //----- moles balances -----
  //--------------------------

  Eq_check_mass_bal:         check_mass_bal   = Feed_in.F*MW_feed_in  + Sweep_in.F*MW_sweep_in  - Per_out.F*MW_per_out  - Ret_out.F*MW_ret_out;
  Eq_check_energy_bal:       check_energy_bal = Feed_in.F*Feed_in.h   + Sweep_in.F*Sweep_in.h   - Per_out.F*Per_out.h   - Ret_out.F*Ret_out.h - Q_loss_tot*3600*1e-6;
  
  call(MW_feed_in)   = pMolWeight(Feed_in.z);
  call(MW_sweep_in)  = pMolWeight(Sweep_in.z);
  call(MW_per_out)   = pMolWeight(Per_out.z);
  call(MW_ret_out)   = pMolWeight(Ret_out.z);

  //---------------------------------------------------------------------
  //with bubble/emulsion separation, chemical reactions and mass transfer
  //---------------------------------------------------------------------

  //hydrogen permeation flow //kmol/h/mem
  For i in [x2i:x3] do
    F_H2_e(i) = kper_0*exp(-Ea/Rgas/(T_ret(i)+273))*(max(1e-5, P_ret(i-1)*z_e("H2",i-1)*1e5)^n-max(1e-5, P_per(i)*z_interface("H2",i)*1e5)^n)*dA_mem*delta_e(i)*3600;
    F_H2_b(i) = kper_0*exp(-Ea/Rgas/(T_ret(i)+273))*(max(1e-5, P_ret(i-1)*z_b("H2",i-1)*1e5)^n-max(1e-5, P_per(i)*z_interface("H2",i)*1e5)^n)*dA_mem*delta_b(i)*3600*b_perm_coeff;
    F_H2(i) = F_H2_e(i)+F_H2_b(i);
    Eq_z_interface1:       z_interface(ComponentList-"H2"-"H2O",i) = 0;
    Eq_z_interface2:       z_interface("H2O",i) = 1-z_interface("H2",i);
    If supp_diff == "Consider_support_diff" then
      Eq_z_interface3:       z_interface("H2",i) = (z_per("H2",i)-1)*(r_ext_support/r_int_support)^( (-F_H2(i)/3600/dA_mem)*tor*r_ext_support/(C_per(i)*por)*(1e4/Diff_eff_per("H2",i) + 1/(2/3*r_por*sqrt(8*Rgas*(T_per(i)+273)/pi/MW("H2")*1e3))))+1; //cylindrical support
    Else  // neglect suport effect
      Eq_z_interface4:       z_interface("H2",i) = z_per("H2",i);
    EndIf
  EndFor
  F_H2(x2) = 0;
  F_H2_e(x2) = 0;
  F_H2_b(x2) = 0;
  //z_interface(ComponentList, x2) = 0;

  //molar fraction definition
  For i in [1:x.EndNode] do
    Eq_z_sum_ret:       1 = sigma(z_ret(ComponentList,i));
    C_ret(i)*z_ret(ComponentList,i)*u_ret(i) = C_ret(i)*z_e(ComponentList,i)*u_e(i)*delta_e(i) + C_ret(i)*z_b(ComponentList,i)*u_b(i)*delta_b(i); 
  EndFor

  z_per_p(ComponentList) = z_per(ComponentList, x2);

  For i in [x2:x.EndNode-1] do

    Eq_z_sum_per:       1 = sigma(z_per(ComponentList,i));

    If i<=x3 then
      //mole balance permeate, annulus side
      Eq_Ci_per_bal1:
      $C_per(i)*z_per(ComponentList-"H2",i)*dV2_annulus = (C_per(i+1)*z_per(ComponentList-"H2",i+1)*u_per(i+1)-C_per(i)*z_per(ComponentList-"H2",i)*u_per(i))*S_annulus;

      $C_per(i)*z_per("H2",i)*dV2_annulus = (C_per(i+1)*z_per("H2",i+1)*u_per(i+1)-C_per(i)*z_per("H2",i)*u_per(i))*S_annulus + F_H2(i)/3600;
      Else
      //mole balance permeate, annulus side
      Eq_Ci_per_bal2:
      $C_per(i)*z_per(ComponentList,i)*dV3_annulus = (C_per(i+1)*z_per(ComponentList,i+1)*u_per(i+1)-C_per(i)*z_per(ComponentList,i)*u_per(i))*S_annulus;
    EndIf
  EndFor

  For i in [x2i:x.EndNode] do
    If i<=x3 then                      
      //mole balance permeate, pipe side
      Eq_C_per_p_bal1:
      $C_per_p(i)*dV2_pipe = (C_per_p(i-1)*u_per_p(i-1)-C_per_p(i)*u_per_p(i))*S_int_pipe;
    Else
      //mole balance permeate, pipe side
      Eq_C_per_p_bal2:
      $C_per_p(i)*dV3_pipe = (C_per_p(i-1)*u_per_p(i-1)-C_per_p(i)*u_per_p(i))*S_int_pipe;
    EndIf
  EndFor
  
  Eq_C_per_C_per_p:          C_per_p(x2)*u_per_p(x2)*S_int_pipe = C_per(x2)*u_per(x2)*S_annulus;
  Eq_MW_per_p:               MW_per_p = MW_per(x2);

  
  
  For i in [1:x.EndNode] do
    For k in ComponentList do
 
  If i<=x2 then //mole balance bottom region retentate side
      Eq_Ci_e_bal1:
      $C_ret(i)*z_e(k,i)*delta_e(i)*S1_vessel*dx1 =  (C_ret(i-1)*z_e(k,i-1)*u_e(i-1)*delta_e(i-1)-C_ret(i)*z_e(k,i)*u_e(i)*delta_e(i))*S1_vessel  //avvective flow through the continuos emulsion phase
                                                          + m_s_i(i) * f_cat * sigma(ForEach (j in ReactionList) r_state(j)*r(j,i)*stoich(j,k))  // in the case of reactions with kinetics
                                                          + 0.7 *  C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  //  /**r_state("EtOH_ox")*/    by oxidation of EtOH with all the oxygen present
                                                          + 0.7 * (C_ret(i-1)*z_e("EtOH",i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel-C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_dec",k)/abs(stoich("EtOH_dec","EtOH")) //  /**r_state("EtOH_dec")*/   by decomposition ofresidual EtOH after oxidation 
                                                          + C_ret(i)*(z_b(k,i)-z_e(k,i))*S1_vessel*delta_b(i)*dx1       //diffusive flow e-c on single bubble volume basis
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) );
      Eq_Ci_b_bal1:
      $C_ret(i)*z_b(k,i)*delta_b(i)*S1_vessel*dx1 =  (C_ret(i-1)*z_b(k,i-1)*u_b(i-1)*delta_b(i-1)-C_ret(i)*z_b(k,i)*u_b(i)*delta_b(i))*S1_vessel
                                                          //+ 0.5 * C_ret(i-1)*z_b("O2",i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  // /**r_state("EtOH_ox")*/   no oxidation       by oxidation of EtOH with all the oxygen present
                                                          //+ 0.5 * (C_ret(i-1)*z_b("EtOH",i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel-C_ret(i-1)*z_b("O2",i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_dec",k)/abs(stoich("EtOH_dec","EtOH")) //    /**r_state("EtOH_dec")*/   by decomposition ofresidual EtOH after oxidation 
                                                          + C_ret(i)*(z_e(k,i)-z_b(k,i))*S1_vessel*delta_b(i)*dx1    
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) );
    Else
    If i==x2i then
      Eq_Ci_e_bal2:
      $C_ret(i)*z_e(k,i)*delta_e(i)*S2_vessel*dx2 =  (C_ret(i-1)*z_e(k,i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel-C_ret(i)*z_e(k,i)*u_e(i)*delta_e(i)*S2_vessel)  //avvective flow through the continuos emulsion phase
                                                          + m_s_i(i) * f_cat * sigma(ForEach (j in ReactionList) r_state(j)*r(j,i)*stoich(j,k))
                                                          + 0.5 * C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  // /**r_state("EtOH_ox")*/   by oxidation of EtOH with all the oxygen present
                                                          + 0.5 * (C_ret(i-1)*z_e("EtOH",i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel-C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_dec",k) //   /**r_state("EtOH_dec")*/  by decomposition ofresidual EtOH after oxidation
                                                          + C_ret(i)*(z_b(k,i)-z_e(k,i))*S2_vessel*delta_b(i)*dx2         //diffusive flow e-c on single bubble volume basis
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) )
                                                          - z_cross(k)*F_H2_e(i)/3600*N_mem;
      Eq_Ci_b_bal2:
      $C_ret(i)*z_b(k,i)*delta_b(i)*S2_vessel*dx2 =  (C_ret(i-1)*z_b(k,i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel-C_ret(i)*z_b(k,i)*u_b(i)*delta_b(i)*S2_vessel)
                                                        //  + 0.5 * C_ret(i-1)*z_b("O2",i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  // /**r_state("EtOH_ox")*/   no oxidation       by oxidation of EtOH with all the oxygen present
                                                        //  + 0.5 * (C_ret(i-1)*z_b("EtOH",i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel-C_ret(i-1)*z_b("O2",i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_dec",k)/abs(stoich("EtOH_dec","EtOH")) //  /**r_state("EtOH_dec")*/   by decomposition ofresidual EtOH after oxidation 
                                                          + C_ret(i)*(z_e(k,i)-z_b(k,i))*S2_vessel*delta_b(i)*dx2       
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) )
                                                          -z_cross(k)*F_H2_b(i)/3600*N_mem;
    Else  //mole balance membrane region retentate side
      If i<=x3 then
        
      Eq_Ci_e_bal3:
      $C_ret(i)*z_e(k,i)*S2_vessel*delta_e(i)*dx2 =  (C_ret(i-1)*z_e(k,i-1)*u_e(i-1)*delta_e(i-1)-C_ret(i)*z_e(k,i)*u_e(i)*delta_e(i))*S2_vessel  //avvective flow through the continuos emulsion phase
                                                          + m_s_i(i) * f_cat * sigma(ForEach (j in ReactionList) r_state(j)*r(j,i)*stoich(j,k))
                                                          + 0.5 * C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S2_vessel*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  //  /**r_state("EtOH_ox")*/   by oxidation of EtOH with all the oxygen present
                                                          + 0.5 * (C_ret(i-1)*z_e("EtOH",i-1)*u_e(i-1)*delta_e(i-1)*S2_vessel-C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S2_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_dec",k) //   /**r_state("EtOH_dec")*/  by decomposition ofresidual EtOH after oxidation
                                                          + C_ret(i)*(z_b(k,i)-z_e(k,i))*S2_vessel*delta_b(i)*dx2  
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) )
                                                          -z_cross(k)*F_H2_e(i)/3600*N_mem;
      Eq_Ci_b_bal3:
      $C_ret(i)*z_b(k,i)*S2_vessel*delta_b(i)*dx2 =  (C_ret(i-1)*z_b(k,i-1)*u_b(i-1)*delta_b(i-1)-C_ret(i)*z_b(k,i)*u_b(i)*delta_b(i))*S2_vessel
                                                        //  + 0.5 * C_ret(i-1)*z_b("O2",i-1)*u_b(i-1)*delta_b(i-1)*S2_vessel*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  // /**r_state("EtOH_ox")*/   no oxidation       by oxidation of EtOH with all the oxygen present
                                                        //  + 0.5 * (C_ret(i-1)*z_b("EtOH",i-1)*u_b(i-1)*delta_b(i-1)*S2_vessel-C_ret(i-1)*z_b("O2",i-1)*u_b(i-1)*delta_b(i-1)*S2_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_dec",k)/abs(stoich("EtOH_dec","EtOH")) //  /**r_state("EtOH_dec")*/   by decomposition ofresidual EtOH after oxidation 
                                                          + C_ret(i)*(z_e(k,i)-z_b(k,i))*S2_vessel*delta_b(i)*dx2
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) )
                                                          -z_cross(k)*F_H2_e(i)/3600*N_mem;
      Else
      Eq_Ci_e_bal4:
      $C_ret(i)*z_e(k,i)*S2_vessel*delta_e(i)*dx3 =  (C_ret(i-1)*z_e(k,i-1)*u_e(i-1)*delta_e(i-1)-C_ret(i)*z_e(k,i)*u_e(i)*delta_e(i))*S2_vessel  //avvective flow through the continuos emulsion phase
                                                          + m_s_i(i) * f_cat * sigma(ForEach (j in ReactionList) r_state(j)*r(j,i)*stoich(j,k))
                                                          + C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S2_vessel/**r_state("EtOH_ox")*/*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  // by oxidation of EtOH with all the oxygen present
                                                          + (C_ret(i-1)*z_e("EtOH",i-1)*u_e(i-1)*delta_e(i-1)*S2_vessel-C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S2_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))/**r_state("EtOH_dec")*/*stoich("EtOH_dec",k) //by decomposition ofresidual EtOH after oxidation
                                                          + C_ret(i)*(z_b(k,i)-z_e(k,i))*S2_vessel*delta_b(i)*dx3
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) );
      Eq_Ci_b_bal4:
      $C_ret(i)*z_b(k,i)*S2_vessel*delta_b(i)*dx3 =  (C_ret(i-1)*z_b(k,i-1)*u_b(i-1)*delta_b(i-1)-C_ret(i)*z_b(k,i)*u_b(i)*delta_b(i))*S2_vessel
                                                          + C_ret(i)*(z_e(k,i)-z_b(k,i))*S2_vessel*delta_b(i)*dx3
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) );
                                                          
        EndIf
      EndIf
    EndIf
    EndFor
  EndFor

    z_b(ComponentList,0) = z_ret(ComponentList,0);
    z_e(ComponentList,0) = z_ret(ComponentList,0);

  For i in [1:x.EndNode] do
    //call(Diff_bin (ComponentList,ComponentList,i)) = pDiffus_Bin_Vap(T_ret(i),P_ret(i),z_ret(ComponentList,i));
    call(Diff_eff(ComponentList,i)) = pDiffus_Vap(T_ret(i),P_ret(i),z_ret(ComponentList,i));
  EndFor
  For i in [x2:x.EndNode] do
    call(Diff_eff_per(ComponentList,i)) = pDiffus_Vap(T_per(i),P_per(i),z_per(ComponentList,i));
  EndFor
  

/*
  //---------------------------------
  //----- global MR selectivity -----
  //---------------------------------
  
  Pi_avg_mem_ret(ComponentList) = sigma(ForEach (i in [x2:x3]) P_ret(i)*z_ret(ComponentList,i))/(x3-x2); //bar
  N_sel(ComponentList-"H2") = min(1e-10, k_sel*(Pi_avg_mem_ret(ComponentList-"H2")*1e5)*A_mem_tot*3600);  //kmol/h
  N_sel("H2")=0;

  Selectivity = (Per_out.F*Per_out.z("H2"))/sigma(N_sel(ComponentList-"H2"));
  */
  
  //--------------------
  //----- pressure -----
  //--------------------

  For i in [x2:x.EndNode-1] do
    If i<=x3 then
      Eq_P_per1:  P_per(i) = P_per(i+1);//-64/Re_per(i)*C_per(i)*MW_per(i)*(u_per(i)^2)/2*dx2/(2*t_annulus)*1e-5;
    else
      Eq_P_per2:  P_per(i) = P_per(i+1);//-64/Re_per(i)*C_per(i)*MW_per(i)*(u_per(i)^2)/2*dx3/(2*t_annulus)*1e-5;
    endif
  EndFor
  For i in [x2+1:x.EndNode] do
    If i<x3 then
      Eq_P_per_p1: P_per_p(i) = P_per_p(i-1);// -64/Re_per_p(i)/2*C_per_p(i)*MW_per(x2)*(u_per_p(i)^2)/2*dx2/(2*r_int_pipe)*1e-5;
    Else
      Eq_P_per_p2: P_per_p(i) = P_per_p(i-1);// -64/Re_per_p(i)/2*C_per_p(i)*MW_per(x2)*(u_per_p(i)^2)/2*dx3/(2*r_int_pipe)*1e-5;
    Endif
  EndFor
  Eq_P_per_p3: P_per_p(x2) = P_per(x2)*0.99;// - 5 *C_per(x2)*MW_per(x2)*(u_per(x2)^2)/2*1e-5; //check formula for pressure drop due to annulus-pipe 180° bend


  P_ret(1) = P_ret(0) - p*C_ret(1)*MW_ret(1)*u_ret(1)^2/(2*(0.6*0.1)^2)*1e-5; //Cd = discharge coefficient=0.6; F = fractional free area=0.1
  // Cd = 0.82*(t_plate/d_holes)^0.13;  //thickness plates and holes diameter
  For i in [2:x.EndNode] do
    If i<round(x2+(h_s-L1)/dx2) then  // region with solids
      If u0_umf_ratio(1)<1 then  //fixed bed --> ergun formula
        If i<=x2 then
          P_ret(i)=P_ret(i-1);//-p*dx1*1e-5*(150*(1-eps_0)^2/eps_0^3*mu_ret(i)*u_ret(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_0)/eps_0^3*C_ret(i)*MW_ret(i)*u_ret(i)^2/(d_s*fi_s));
        Else
          If i<=x3 then
            P_ret(i)=P_ret(i-1);//-p*dx2*1e-5*(150*(1-eps_0)^2/eps_0^3*mu_ret(i)*u_ret(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_0)/eps_0^3*C_ret(i)*MW_ret(i)*u_ret(i)^2/(d_s*fi_s));
          Else
            P_ret(i)=P_ret(i-1);//-p*dx3*1e-5*(150*(1-eps_0)^2/eps_0^3*mu_ret(i)*u_ret(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_0)/eps_0^3*C_ret(i)*MW_ret(i)*u_ret(i)^2/(d_s*fi_s));
          EndIf
        EndIf
      Else // fluidized bed
        If i<=x2 then
          P_ret(i)=P_ret(i-1);//
          //-p*dx1*1e-5*(1-eps_e(i))*(rho_s-C_ret(i)*MW_ret(i))
          //-p*dx1*1e-5*(150*(1-eps_mf(i))^2/eps_mf(i)^3*mu_ret(i)*u_mf(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_mf(i))/eps_mf(i)^3*C_ret(i)*MW_ret(i)*u_mf(i)^2/(d_s*fi_s));
          //-dx1*1e-5*(150*(1-eps_e(i))^2/eps_e(i)^3*mu_ret(i)*u_ret(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_e(i))/eps_e(i)^3*C_ret(i)*MW_ret(i)*u_ret(i)^2/(d_s*fi_s));
        Else
          If i<=x3 then
            P_ret(i)=P_ret(i-1);
            //-p*dx2*1e-5*(1-eps_e(i))*(rho_s-C_ret(i)*MW_ret(i))
            //-p*dx2*1e-5*(150*(1-eps_mf(i))^2/eps_mf(i)^3*mu_ret(i)*u_mf(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_mf(i))/eps_mf(i)^3*C_ret(i)*MW_ret(i)*u_mf(i)^2/(d_s*fi_s));
            //-dx2*1e-5*(150*(1-eps_e(i))^2/eps_e(i)^3*mu_ret(i)*u_ret(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_e(i))/eps_e(i)^3*C_ret(i)*MW_ret(i)*u_ret(i)^2/(d_s*fi_s));
          Else
            P_ret(i)=P_ret(i-1);
            //-p*dx3*g*1e-5*(1-eps_e(i))*(rho_s-C_ret(i)*MW_ret(i))
            //-p*dx3*1e-5*(150*(1-eps_mf(i))^2/eps_mf(i)^3*mu_ret(i)*u_mf(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_mf(i))/eps_mf(i)^3*C_ret(i)*MW_ret(i)*u_mf(i)^2/(d_s*fi_s));
            //-dx3*1e-5*(150*(1-eps_e(i))^2/eps_e(i)^3*mu_ret(i)*u_ret(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_e(i))/eps_e(i)^3*C_ret(i)*MW_ret(i)*u_ret(i)^2/(d_s*fi_s));
          EndIf
        EndIf
      EndIf
    Else  //region without catalyst
      P_ret(i)=P_ret(i-1);
    EndIf  
  EndFor
  

  //------------------------
  //----- performances -----
  //------------------------
  Eq_S2EtOH:        S2EtOH      = Feed_in.z("H2O")/Feed_in.z("EtOH");
  Eq_S2EtOH_star:   S2EtOH_star = (Feed_in.F*Feed_in.z("H2O") + Feed_in.F*Feed_in.z("O2")*stoich("EtOH_ox","H2O")/abs(stoich("EtOH_ox","O2"))) / (Feed_in.F*Feed_in.z("EtOH") + Feed_in.F*Feed_in.z("O2")*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")));
  Eq_O22EtOH:       O22EtOH     = Feed_in.z("O2")/Feed_in.z("EtOH");
  Eq_WHSV_EtOH:     WHSV_EtOH   = Feed_in.F*Feed_in.z("EtOH")*MW("EtOH")/(m_s*f_cat); // (kg/h_CH4)/kg_cat
  Eq_HRF_EtOH:      HRF         = Per_out.F*Per_out.z("H2") / (Feed_in.F*Feed_in.z("EtOH")*stoich("EtOH_SR_3","H2")/abs(stoich("EtOH_SR_3","EtOH")));
  Eq_HRF_EtOH_star: HRF_star    = Per_out.F*Per_out.z("H2") / (Feed_in.F*(Feed_in.z("EtOH")+Feed_in.z("O2")*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_SR_3","H2")/abs(stoich("EtOH_SR_3","EtOH")));
  Eq_EtOH_ox:       EtOH_ox     = abs(Feed_in.F*Feed_in.z("O2")*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2"))); //kmol/h
  Eq_Sw2EtOH:       Sw2EtOH     = Sweep_in.F/(Feed_in.F*Feed_in.z("EtOH"));
  Eq_HHV_ret:       HHV_ret     = abs(z_ret("CH4",x.EndNode)*DH0_r("CH4_ox") + z_ret("CO",x.EndNode)*DH0_r("CO_ox") + z_ret("EtOH",x.EndNode)*DH0_r("EtOH_ox") + z_ret("H2",x.EndNode)*DH0_r("H2_ox"));
  Eq_H2perm:        H2perm      = (Per_out.F*Per_out.z("H2")-Sweep_in.F*Sweep_in.z("H2"))*22.414;
  Eq_Load2surf_EtOH:   Load2surf_EtOH   = Feed_in.F*Feed_in.z("EtOH")*22.414/A_mem_tot;
  Eq_Section_fraction: Section_fraction = r_ext_support^2*N_mem/r_vessel^2;
  Eq_LMPD:             LMPD             = (((P_ret(x2i)*1e5*z_ret("H2",x2i))^0.5-(P_per(x2i)*1e5*z_per("H2",x2i))^0.5)-((P_ret(x3)*1e5*z_ret("H2",x3))^0.5-(P_per(x3)*1e5*z_per("H2",x3))^0.5))
                                          /loge(((P_ret(x2i)*1e5*z_ret("H2",x2i))^0.5-(P_per(x2i)*1e5*z_per("H2",x2i))^0.5)/((P_ret(x3)*1e5*z_ret("H2",x3))^0.5-(P_per(x3)*1e5*z_per("H2",x3))^0.5));
/*
  u0_0 = u_ret(0);
  u0_1 = u_ret(1);
  u_mf_0 = u_mf(0);
  u_mf_1 = u_mf(1);
  u0_umf_ratio_0 = u_ret(0)/u_mf(0);
  u0_umf_ratio_1 = u_ret(1)/u_mf(1);
  u0_umf_ratio_x2 = u_ret(x2)/u_mf(x2);

  
For i in [x2:x.EndNode] do
  z_H2_per(i) = z_per("H2",i);
  z_H2_interf(i) = z_interface("H2",i);
EndFor

For i in [0:x.EndNode] do
  z_H2_b(i) = z_b("H2",i);
  z_H2_e(i) = z_e("H2",i);
  z_H2_ret(i) = z_ret("H2",i);
EndFor
*/
   
  //----------------------------
  //----- thermal balances -----
  //----------------------------

For i in [1:x.EndNode] do
    If i<=x2 then
      q_loss(i) = (T_ret(i)-T_amb)/((loge((r_vessel+t_ins)/(r_vessel))/(2*pi*k_ins*1e-3*dx1))+(1/(2*pi*ht_amb*(r_vessel+t_ins)*dx1))); // kW
    Else
      If i<=x3 then
        q_loss(i) = (T_ret(i)-T_amb)/((loge((r_vessel+t_ins)/(r_vessel))/(2*pi*k_ins*1e-3*dx2))+(1/(2*pi*ht_amb*(r_vessel+t_ins)*dx2))); // kW
      Else
        q_loss(i) = (T_ret(i)-T_amb)/((loge((r_vessel+t_ins)/(r_vessel))/(2*pi*k_ins*1e-3*dx3))+(1/(2*pi*ht_amb*(r_vessel+t_ins)*dx3))); // kW
      EndIf
    EndIf        
  EndFor
  
  q_loss(0) = 0;
  Q_loss_tot = sigma(q_loss) + 2*((T_ret(x.EndNode)-T_amb)/(t_ins/(k_ins*1e-3*pi*(r_vessel+t_ins)^2)+1/(ht_amb*pi*(r_vessel+t_ins)^2))) ;
  Eq_T_wall: q_loss(1) = (T_ret(1)-T_wall)/((loge((r_vessel+t_ins)/(r_vessel))/(2*pi*k_ins*1e-3*dx1)));
      
  If Thermal=="T_constant_no_thermal_balance" then
    T_reactor: fixed;
  Else  // thermal_balance active
    //global thermal balance  --> simplified approach to compute  T_per(uniform)
    Feed_in.F*Feed_in.h + Sweep_in.F*Sweep_in.h - Ret_out.F*Ret_out.h - Per_out.F*Per_out.h - Q_loss_tot*1e-6*3600 = 0;  //GJ/h
    T_reactor:free;
  EndIf
  For i in [1:x.EndNode] do      
      T_ret(i) = T_reactor;
    EndFor
    For i in [x2:x.EndNode-1] do
      T_per(i) = T_reactor;
    EndFor
    For i in [x2:x.EndNode] do
      T_per_p(i) = T_reactor;
    EndFor

//SYSTEM SECTION - WARNING: DO NOT EDIT
  Current_Icon : "System";
SystemData : Text
<FORMLIST DEFAULTFORM="AllVariables">
  <FORM NAME="Solids" CLSID="{6BA76840-806B-11D0-BE51-0000C09984EF}">
    { Version : 1
SizeX : 5250
SizeY : 3750
ShowAllVariables : False
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ m_s d_s sph_s rho_s rho_s_loose eps_0 f_cat f_fil x_s_0 x_s ]
AttributesPaths : [ Value Spec Units Description ]
ColumnWidths : [ 2625 1680 1215 2310 2310 ]
}
  </FORM>
  <FORM NAME="Streams" CLSID="{6BA76840-806B-11D0-BE51-0000C09984EF}">
    { Version : 1
SizeX : 10800
SizeY : 8130
ShowAllVariables : False
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ Feed_in.F Feed_in.T Feed_in.P Feed_in.z(*) Feed_in.h Feed_in.V Ret_out.F Ret_out.T Ret_out.P Ret_out.z(*) Ret_out.h Ret_out.V Sweep_in.F Sweep_in.T Sweep_in.P Sweep_in.z(*) Sweep_in.h Sweep_in.V Per_out.F Per_out.T Per_out.P Per_out.z(*) Per_out.h Per_out.V ]
AttributesPaths : [ Value Spec Units Description ]
ColumnWidths : [ 3090 1845 1215 1845 1845 ]
}
  </FORM>
  <FORM NAME="Performances" CLSID="{6BA76840-806B-11D0-BE51-0000C09984EF}">
    { Version : 1
SizeX : 6075
SizeY : 7815
ShowAllVariables : False
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ u0_umf_ratio_min u0_umf_ratio_max WHSV_M S2M S2M_star O22M CH4_ox WHSV_EtOH S2EtOH S2EtOH_star O22EtOH EtOH_ox HRF HRF_star HHV_ret Q_loss_tot check_energy_bal check_mass_bal H2perm ]
AttributesPaths : [ Value Spec Units Description ]
ColumnWidths : [ 3090 1845 1215 1845 1845 ]
}
  </FORM>
  <FORM NAME="P_e" CLSID="{40C692F8-9541-11D4-8062-00C04F89DD44}">
    { Version : 2
SizeX : 6015
SizeY : 6525
Plot3d: 0
YAxisIsTime: 1
MaxIntervals: 3
PhasePlot: 0
PhaseXVariable: -
XProfileName: -
YProfileName: -
VariablesPaths : [ 10 P_CH4_e(*) 10 P_CO2_e(*) 9 P_CO_e(*) 11 P_EtOH_e(*) 9 P_H2_e(*) 10 P_H2O_e(*) 9 P_N2_e(*) 9 P_O2_e(*) ]
HistoryVariablesPaths : [ ]
Times : [ L ]
ProfileNames : [ 8 New¬Profile
New¬Profilea
New¬Profileb
New¬Profilec
New¬Profiled
New¬Profilee
New¬Profilef
New¬Profileg]
NoVars : [ 1 1 1 1 1 1 1 1 ]
UnusedVariablesPaths : [ ]
UnusedProfileDimensions : [ ]
PlotInputFile : { 
Type:0
Title:P_e
Xlab:Index
Ylab:Y Label
Nvars:8
MultiY:0
Subst:UOM
NYaxes:8
RunPlot:0
PhasePlot:0
SizeToData:0
CommunicationIntervals:1
UseVar:0
IgnoreLegend:0
TimeWin:1
TimeScroll:0.2
AlwaysShow:0
PhaseX:
Var:0
AxisMap:0
Label:Index
SubstValue:
Var:1
AxisMap:1
Label:Y Label
Legend:CH4
SubstValue:
Var:2
AxisMap:2
Label:
Legend:CO2
SubstValue:
Var:3
AxisMap:3
Label:
Legend:CO
SubstValue:
Var:4
AxisMap:4
Label:
Legend:EtOH
SubstValue:
Var:5
AxisMap:5
Label:
Legend:H2
SubstValue:
Var:6
AxisMap:6
Label:
Legend:H2O
SubstValue:
Var:7
AxisMap:7
Label:
Legend:N2
SubstValue:
Var:8
AxisMap:8
Label:
Legend:O2
SubstValue:
Axis:0
Range:0 1
AxisInterval:0.1 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:1
Range:0 1
AxisInterval:0.1 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:2
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:3
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:4
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:5
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:6
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:7
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:8
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Attrib:0 4 1 1
Attrib2:0 0 0 0 0
Attrib:1 4 2 2
Attrib2:1 0 0 0 0
Attrib:2 4 3 3
Attrib2:2 0 0 0 0
Attrib:3 4 4 4
Attrib2:3 0 0 0 0
Attrib:4 4 5 5
Attrib2:4 0 0 0 0
Attrib:5 4 6 6
Attrib2:5 0 0 0 0
Attrib:6 4 7 1
Attrib2:6 0 0 0 0
Attrib:7 4 8 2
Attrib2:7 0 0 0 0
Font:0 10 0:Arial
Font:1 10 0:Arial
Font:2 10 0:Arial
Font:3 10 0:Arial
Grid:0
Line:2
Square:0 0 0 0
Marker:4 1
LegendBox:1 1.000000 0.030000
LegendBox2:90 1.250000 5 } 
DisplayAs : Plot
ColumnWidths : [ ]
ProfileDimensions : [ 1 1 1 1 1 1 1 1 ]
}
  </FORM>
  <FORM NAME="P_b" CLSID="{40C692F8-9541-11D4-8062-00C04F89DD44}">
    { Version : 2
SizeX : 5250
SizeY : 7785
Plot3d: 0
YAxisIsTime: 1
MaxIntervals: 3
PhasePlot: 0
PhaseXVariable: -
XProfileName: -
YProfileName: -
VariablesPaths : [ 10 P_CH4_b(*) 10 P_CO2_b(*) 9 P_CO_b(*) 11 P_EtOH_b(*) 9 P_H2_b(*) 10 P_H2O_b(*) 9 P_N2_b(*) 9 P_O2_b(*) ]
HistoryVariablesPaths : [ ]
Times : [ L ]
ProfileNames : [ 8 New¬Profile
New¬Profilea
New¬Profileb
New¬Profilec
New¬Profiled
New¬Profilee
New¬Profilef
New¬Profileg]
NoVars : [ 1 1 1 1 1 1 1 1 ]
UnusedVariablesPaths : [ ]
UnusedProfileDimensions : [ ]
PlotInputFile : { 
Type:0
Title:P_b
Xlab:Index
Ylab:Y Label
Nvars:8
MultiY:0
Subst:UOM
NYaxes:8
RunPlot:0
PhasePlot:0
SizeToData:0
CommunicationIntervals:1
UseVar:0
IgnoreLegend:0
TimeWin:1
TimeScroll:0.2
AlwaysShow:0
PhaseX:
Var:0
AxisMap:0
Label:Index
SubstValue:
Var:1
AxisMap:1
Label:Y Label
Legend:New Profile $UOM
SubstValue:
Var:2
AxisMap:2
Label:
Legend:New Profilea $UOM
SubstValue:
Var:3
AxisMap:3
Label:
Legend:New Profileb $UOM
SubstValue:
Var:4
AxisMap:4
Label:
Legend:New Profilec $UOM
SubstValue:
Var:5
AxisMap:5
Label:
Legend:New Profiled $UOM
SubstValue:
Var:6
AxisMap:6
Label:
Legend:New Profilee $UOM
SubstValue:
Var:7
AxisMap:7
Label:
Legend:New Profilef $UOM
SubstValue:
Var:8
AxisMap:8
Label:
Legend:New Profileg $UOM
SubstValue:
Axis:0
Range:0 1
AxisInterval:0.1 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:1
Range:0 1
AxisInterval:0.2 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:2
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:3
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:4
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:5
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:6
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:7
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:8
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Attrib:0 4 1 1
Attrib2:0 0 0 0 0
Attrib:1 4 2 2
Attrib2:1 0 0 0 0
Attrib:2 4 3 3
Attrib2:2 0 0 0 0
Attrib:3 4 4 4
Attrib2:3 0 0 0 0
Attrib:4 4 5 5
Attrib2:4 0 0 0 0
Attrib:5 4 6 6
Attrib2:5 0 0 0 0
Attrib:6 4 7 1
Attrib2:6 0 0 0 0
Attrib:7 4 8 2
Attrib2:7 0 0 0 0
Font:0 10 0:Arial
Font:1 10 0:Arial
Font:2 10 0:Arial
Font:3 10 0:Arial
Grid:0
Line:2
Square:0 0 0 0
Marker:4 1
LegendBox:0 1.000000 0.030000
LegendBox2:90 1.250000 5 } 
DisplayAs : Plot
ColumnWidths : [ ]
ProfileDimensions : [ 1 1 1 1 1 1 1 1 ]
}
  </FORM>
  <FORM NAME="reactions" CLSID="{40C692F8-9541-11D4-8062-00C04F89DD44}">
    { Version : 2
SizeX : 5250
SizeY : 3750
Plot3d: 0
YAxisIsTime: 1
MaxIntervals: 3
PhasePlot: 0
PhaseXVariable: -
XProfileName: -
YProfileName: -
VariablesPaths : [ 8 r_MSR(*) 8 r_WGS(*) ]
HistoryVariablesPaths : [ ]
Times : [ L ]
ProfileNames : [ 2 New¬Profile
New¬Profilea]
NoVars : [ 1 1 ]
UnusedVariablesPaths : [ ]
UnusedProfileDimensions : [ ]
PlotInputFile : { 
Type:0
Title:reactions
Xlab:Index
Ylab:Y Label
Nvars:2
MultiY:0
Subst:UOM
NYaxes:2
RunPlot:0
PhasePlot:0
SizeToData:0
CommunicationIntervals:1
UseVar:0
IgnoreLegend:0
TimeWin:1
TimeScroll:0.2
AlwaysShow:0
PhaseX:
Var:0
AxisMap:0
Label:Index
SubstValue:
Var:1
AxisMap:1
Label:Y Label
Legend:New Profile $UOM
SubstValue:
Var:2
AxisMap:2
Label:
Legend:New Profilea $UOM
SubstValue:
Axis:0
Range:0 1
AxisInterval:0.1 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:1
Range:0 1
AxisInterval:0.25 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:2
Range:0 1
AxisInterval:0 0
AxisRange:0 1
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Attrib:0 4 1 1
Attrib2:0 0 0 0 0
Attrib:1 4 2 2
Attrib2:1 0 0 0 0
Font:0 10 0:Arial
Font:1 10 0:Arial
Font:2 10 0:Arial
Font:3 10 0:Arial
Grid:0
Line:2
Square:0 0 0 0
Marker:4 1
LegendBox:0 1.000000 0.030000
LegendBox2:90 1.250000 5 } 
DisplayAs : Plot
ColumnWidths : [ ]
ProfileDimensions : [ 1 1 ]
}
  </FORM>
  <FORM NAME="Geometry" CLSID="{6BA76840-806B-11D0-BE51-0000C09984EF}">
    { Version : 1
SizeX : 9225
SizeY : 9525
ShowAllVariables : False
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ L1 L2 L3 Ltot N_mem A_mem_tot dist_mems dx1 dx2 dx3 dV1_vessel dV2_vessel dV3_vessel dV2_annulus dV3_annulus dV2_pipe dV3_pipe dA_mem r_ext_support r_int_support t_support t_annulus t_ins t_mem t_pipe t_vessel r_ext_pipe r_int_pipe r_vessel S1_vessel S2_vessel S_annulus S_int_pipe ]
AttributesPaths : [ Value Spec Units Description ]
ColumnWidths : [ 3090 1845 1215 1845 1845 ]
}
  </FORM>
  <FORM NAME="u" CLSID="{6BA76840-806B-11D0-BE51-0000C09984EF}">
    { Version : 1
SizeX : 5250
SizeY : 3750
ShowAllVariables : False
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ u0_0 u0_1 u_mf_0 u_mf_1 u0_umf_ratio_0 u0_umf_ratio_1 u0_umf_ratio_x2 u0_umf_ratio_max u0_umf_ratio_min ]
AttributesPaths : [ Value Spec Units Description ]
ColumnWidths : [ 3090 1845 1215 1845 1845 ]
}
  </FORM>
  <FORM NAME="z_H2" CLSID="{6BA76840-806B-11D0-BE51-0000C09984EF}">
    { Version : 1
SizeX : 5250
SizeY : 3750
ShowAllVariables : False
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ z_H2_b(*) z_H2_e(*) z_H2_interf(*) z_H2_per(*) z_H2_ret(*) ]
AttributesPaths : [ Value Spec Units Description ]
ColumnWidths : [ 3090 1845 1215 1845 1845 ]
}
  </FORM>
</FORMLIST>
<EXPORTDATA>AS::0::1
DISPLAY::Tubular_membranes
CATEGORY::ACM Models
GUID300::{EF9BB2EF-81F4-43F6-8529-F0617E231944}
PORT::Power::1::Heat::Power::0
PORT::Heat::1::Heat::Heat::0
PORT::Ret_out::1::Mole Fraction::Ret_out::0
PORT::Per_out::1::Mole Fraction::Per_out::0
PORT::Feed_in::1::Mole Fraction::Feed_in::0
PORT::Sweep_in::1::Mole Fraction::Sweep_in::0
QUERY::Solids::1::1::3
QUERY::Streams::1::1::3
QUERY::Performances::1::1::3
QUERY::Geometry::1::1::3
QUERY::AllVariables::1::0::3</EXPORTDATA>
EndText;

//UNCOMPILED SECTION - WARNING: DO NOT EDIT
Model Tubular_membranes

  //---------------------
  //----- Variables -----
  //---------------------



  Parameter Set9 uses StringParameter
    valid as StringSet (["EtOH_decomposition", "EtOH_oxidation", "EtOH_SR_Rossetti", "CH4_oxidation", "H2_oxidation", "WGS", "MSR_FluidCELL", "MSR_Numaguchi_Kikuchi"]);
  End

  Parameter Set10 uses StringParameter
    valid as StringSet (["Permeance", "Permeability"]);
  End

  Parameter Set11 uses StringParameter
    valid as StringSet (["T_constant_no_thermal_balance", "thermal_balance"]);
  End
  
  Parameter Set12 uses StringParameter
    valid as StringSet (["yes", "no"]);
  End
  
  Parameter Set13 uses StringParameter
    valid as StringSet (["exagonal_pattern", "circular_pattern", "no_pattern_u0_umf_fixed" , "no_pattern_r_vessel_fixed", "polynomial"]);
  End

  Parameter Set14 uses StringParameter
    valid as StringSet (["Neglect_support_diff", "Consider_support_diff"]);
  End
  
  Variable reaction_rate_1
    value:0.001;     lower:-1;    upper:1;    PhysicalQuantity:"Reaction Rate [kmol/(kg_cat s)]";
  End
       
  ReactionList as StringSet (["CH4_ox", "CO_ox", "EtOH_dec", "EtOH_ox", "EtOH_SR", "EtOH_SR_2", "EtOH_SR_3", "H2_ox", "MSR", "MSR_2", "WGS"]); //list in alphabetic order!!!
    
  CompList_sw as StringSet (["H2O","N2"]);
  CompList_p as StringSet (["H2"]);
  CompList_per as StringSet(CompList_sw+CompList_p);
  
  

  //constant parameters
  Rgas   as RealParameter (8.314); // kJ/(kmol K)
  g      as RealParameter (9.8); // m/s2
  N_comp as IntegerParameter (size(ComponentList));
  ring as IntegerParameter (3);
  pi     as RealParameter (3.141592654);
  //XDomain
  Ltot  as Length (fixed, 1);
  L1    as Length (fixed, 0.2);  //bottom region without membranes
  L2    as Length (fixed, 0.4);  //central region with membranes
  L3    as Length (free, 0.4);   //top region with tubes, not permeation (membranes supports)
  dx1   as LengthParameter (L1/10);
  dx2   as LengthParameter (L2/10);
  dx3   as LengthParameter (L3/5);
  X     as LengthDomain (HighestOrderDerivative:2, Length:Ltot, NumSections:3, Section(2).Location:L1, Section(3).Location:L1+L2, Section(1).SpacingPreference:dx1, Section(2).SpacingPreference:dx2, Section(3).SpacingPreference:dx3);

//  Solid_lev  as Set8;
  Thermal    as Set11 (value:"T_constant_no_thermal_balance");
  pattern      as Set13 (value:"polynomial");
  b_perm       as Set12 (value:"yes");
  DP           as Set12 (Value:"no");
  b_perm_coeff as notype (fixed);
  p            as notype(fixed);
  supp_diff    as Set14 (value:"Consider_support_diff");
  bed        as notype (Description:"0=packed; 0.5=partially fluidized; 1=smooth fluidization; 2=bubbling; 3=transition to turbolent; 4=other");
  Perm       as Set10 (value:"Permeance");
  solids     as notype;
  
  x2         as IntegerParameter (10);
  x2i        as IntegerParameter (x2+1);
  x3         as IntegerParameter (20);
  x3i        as IntegerParameter (x3+1);
  sweep_in_node  as IntegerParameter (x.EndNode);
  sweep_out_node as IntegerParameter (x.EndNode);
  per_out_node   as IntegerParameter (x.EndNode);
  //Geometry variables
  t_ins         as Length (fixed, 0.15); //m
  t_vessel      as Length (fixed, 0.01);
  r_vessel      as length (free, 0.10);
  D_vessel      as Length;
  t_mem         as Length (fixed, 5e-6);
  t_support     as Length (free, 0.5e-3);
  r_ext_support as Length (free);
  d_ext_support as Length (fixed, 1e-2);
  r_int_support as Length (free);
  d_int_support as Length (fixed, 4e-3); //m
  t_pipe        as Length (fixed, 5e-4);
  r_ext_pipe    as Length (free);
  r_int_pipe    as Length (fixed, 1e-3);
  t_annulus     as Length (free, 1e-3);
  S_annulus     as area (free);
  S1_vessel     as area (free); //m2
  S2_vessel     as area (free);
  S_int_pipe    as area (free);
  dA_mem        as area (free);
  dV2_annulus   as volume (free); //m3
  dV3_annulus   as volume (free);
  dV1_vessel    as volume (free);
  dV2_vessel    as volume (free);
  dV3_vessel    as volume (free);
  dV2_pipe      as volume (free);
  dV3_pipe      as volume (free);
  k_ins         as conductivity (fixed, 0.025); //W/(m K)
  k_vessel      as conductivity (fixed, 100);
  k_support     as conductivity (fixed, 1.5);
  por           as notype (fixed, 0.5);
  tor           as notype (fixed, 3);
  f_pipe        ([x2:x.EndNode]) as notype;
  rough_p       as length (fixed, 1e-7);
  N_mem         as notype (37);
  dist_mems     as length (0.025); //average distance between membranes (find algorithm to compute it!!!)
  A_mem_tot     as area;
  r_por         as length (fixed, 100*1e-9);
  kper_0    as notype (fixed, 0.00217e-3); //kmol/(s m2 bar^n) permeability
  n         as notype (fixed, 0.5);  //exponent in permeation law
  Ea        as notype (fixed, 1e4);  //appearent activation energy in permeation law
  Re_per_p ([x2:x.EndNode]) as notype;
  Re_cr_per      as notype (fixed, 2300);
  z_per       (ComponentList,[x2:x.EndNode])as molefraction; //bulk value in pereatee side
  z_ret       (ComponentList,[0:x.EndNode]) as molefraction; // bulk value in retentate side
  z_support   (ComponentList,[x2:x3])as molefraction; // internal support surface value
  z_interface (ComponentList,[x2:x3])as molefraction; // support/membrane interface
  z_cross     (ComponentList)               as molefraction;
  z_e         (ComponentList,[0:x.EndNode]) as molefraction; //emulsion phase composition
  z_b         (ComponentList,[0:x.EndNode]) as molefraction; //bubble phase composition
  z_per_p     (ComponentList)               as molefraction;
  //streams properties
  h_per    ([x2:x.EndNode]) as enth_mol; //GJ/kmol;
  h_ret    ([0:x.EndNode])  as enth_mol;
  mu_ret   ([0:x.EndNode])  as viscosity;  //cP    1 cP = 1e-3 Pa*s
  mu_per   ([x2:x.EndNode]) as viscosity;
  MW_ret   ([0:x.EndNode])  as molweight; // kg/kmol
  MW_per   ([x2:x.EndNode]) as molweight;
  k_per    ([x2:x.EndNode]) as conductivity; // W(m K)
  k_ret    ([0:x.EndNode])  as conductivity;
  cp_per   ([x2:x.EndNode]) as cp_mol; //kJ/(kmol K)
//  cp_ret   ([0:x.EndNode])  as cp_mol;
  cv_per   ([x2:x.EndNode]) as cv_mol; //kJ/(kmol K)
  cv_ret   ([0:x.EndNode])  as cv_mol;
  C_per    ([x2:x.EndNode]) as dens_mol;  //kmol/m3
  C_per_p  ([x2:x.EndNode]) as dens_mol (initial);
  C_ret    ([0:x.EndNode])  as dens_mol;
  u_per    ([x2:x.EndNode]) as velocity;  //m/s
  u_per_p  ([x2:x.EndNode]) as velocity;
  u_ret    ([0:x.EndNode])  as velocity;
  P_ret    ([0:x.EndNode])  as pressure; //bar
  P_per    ([x2:x.EndNode]) as pressure;
  P_per_p  ([x2:x.EndNode]) as pressure;
  T_ret    ([0:x.EndNode])  as temperature; //°C
  T_per    ([x2:x.EndNode]) as temperature;
  q_loss([0:x.EndNode]) as power; //kW
  Q_loss_tot as power (free, 1);
  T_wall as temperature (free, 50);
  T_amb as temperature (fixed, 20);
  ht_amb as heat_trans_coeff (fixed, 0.01); //kW/(m2 K)
  T_per_p  ([x2:x.EndNode]) as temperature;
  MW(ComponentList) as molweight;
  MW_feed_in as molweight;
  MW_sweep_in as molweight;
  MW_per_out as molweight;
  MW_ret_out as molweight;
  MW_per_p as molweight;

  F_H2_b ([x2:x3]) as flow_mol_vap; //kmol/h
  F_H2_e ([x2:x3]) as flow_mol_vap; //kmol/h
  F_H2   ([x2:x3]) as flow_mol_vap; //kmol/h
  
  //catalyst and fluidized bed properties
  m_s     as notype (free, 10); //kg
  m_s_i   ([0:x.EndNode]) as notype (initial); //kg
  s       ([0:x.EndNode]) as notype;
  m_s_cum_i([0:x.EndNode]) as notype; //kg
  m_s_check as notype;
  d_s     as length (fixed, 100e-6); //m  solid (catalyst and filler) nominal diameter
  fi_s   as fraction (fixed, 1); // solid particles sphericity
  rho_s   as dens_mass (free, 2000); //kg/m3
  rho_s_loose   as dens_mass (fixed, 1000); //kg/m3
  f_cat   as fraction (fixed, 1); //fraction of catalyst particles
  f_fil   as fraction (free, 0.5); //fraction of filler particles
  eps_0   as fraction (fixed, 0.5); //void fraction of the packed solid
  h_s_0   as length (free, 0.4); //m hight of the packed solid
  h_s     as length (free, 0.4); //m hight of the fluidized bed
  Ar      ([0:x.EndNode]) as notype; // Archimede number
  Cd      ([0:x.EndNode]) as notype(lower:1e-5); // Drag coefficient of solid particles
  u_mf    ([0:x.EndNode]) as velocity; //m/s   minimum fluidization velocity (computed at inlet conditions)
  u_t     ([0:x.EndNode]) as velocity; //m/s   solid terminal velocity
  u_t_Gib ([0:x.EndNode]) as velocity; //m/s
//  u_0     as velocity; //m/s   inlet feed velosity
  u_e     ([0:x.EndNode]) as velocity;
  u_b     ([0:x.EndNode]) as velocity;
  u_br    ([0:x.EndNode]) as velocity; //bubble rising velocity
  eps     ([0:x.EndNode]) as fraction (fixed, 0.5); //void fraction of the fluidized solid
  eps_mf  ([0:x.EndNode]) as fraction (free, 0.5); //void fraction of the minumim fluidization
  eps_e   ([0:x.EndNode]) as fraction (upper:1-1e-6, free, 0.5);
  Re_mf   ([0:x.EndNode]) as notype;
  Re_s    ([0:x.EndNode]) as notype;
  Re_mb   ([0:x.EndNode]) as notype;
  Re_c    ([0:x.EndNode]) as notype;
  Re_k    ([0:x.EndNode]) as notype;
  Re_per  ([x2:x.EndNode])as notype;

  mu_app  ([0:x.EndNode])        as notype;
  u0_umf_ratio ([0:x.EndNode])   as notype;
  u0_umf_ratio_min               as notype;
  u0_umf_ratio_min_aux           as notype;
  u0_umf_ratio_max               as notype;
  x_u0_umf_ratio_max             as notype;
  x_u0_umf_ratio_min             as notype;
  x_start_flu_aux                as notype;
  x_start_flu                    as IntegerParameter;
  u0_umf_ratio_min2              as notype;
  u0_umf_0                       as notype;
  u0_umf_1                       as notype;
  u0_umf_x2                      as notype;
  u0_umf_x2i                     as notype;
  u0_0                           as velocity;
  u0_1                           as velocity;
  u_mf_0                         as velocity;
  u_mf_1                         as velocity;
  u0_umf_ratio_0  as notype;
  u0_umf_ratio_1  as notype;
  u0_umf_ratio_x2 as notype;

  time_cross_ret   as notype (Description:"Characteristic crossing time (u_ret)[s]");
  time_cross_b     as notype (Description:"Characteristic crossing time (u_b)[s]");
  time_cross_e     as notype (Description:"Characteristic crossing time (u_e)[s]");
  time_diff        as notype (Description:"Characteristic diffusion time [s]");
  Load2surf_EtOH   as notype;
  Section_fraction as notype;
  
  check_m_b as notype;
  check_t_b as notype;
  check_s_b as notype;
  check_H2_perm as notype;
  err_t_b   as notype;
  err_m_b   as notype;
  bal_C     as notype;
  bal_H     as notype;
  bal_O     as notype;
/*
  z_H2_per ([x2:x.EndNode]) as molefraction;
  z_H2_interf ([x2:x.EndNode]) as  molefraction;
  z_H2_b ([0:x.EndNode]) as molefraction;
  z_H2_e ([0:x.EndNode]) as molefraction;
  z_H2_ret ([0:x.EndNode]) as molefraction;
*/  
  DP_bed  as pressure;
  d_b     ([0:x.EndNode])  as length;
  d_b01   as length;
  d_bmax  ([0:x.EndNode])  as length;
  delta_b ([0:x.EndNode])  as notype; //bubble fraction cross section
  delta_e ([0:x.EndNode])  as notype; //emulsion fraction cross section
  delta_b_avg_mem          as fraction;
  delta_b_min_mem          as fraction;
  delta_b_max_mem          as fraction;
  d_b_avg_mem              as length;
 // dV_s_i  ([0:x.EndNode])  as volume;
 // c_s     ([x2:x.EndNode]) as cp_mass (fixed, 0.7); //kJ/(kg K)
  
  T_reactor as temperature;

  //------------------------------
  //----- Chemical reactions -----
  //------------------------------

  //Ea_MSR                                      as RealParameter (1.069e+5);  //kJ/kmol
  Ea_WGS                                      as RealParameter (5.450e+4);  //kJ/kmol
  //A_MSR                                       as RealParameter (2.502);     //kmol/(kg_cat s) * Pa^xxx
  A_WGS                                       as RealParameter (2.45e-6);  //kmol/(kg_cat s) * Pa^xxx

  k5  as RealParameter (8.02*1e-5); //kmol/(s kg_cat)  //reaction rate constants
  Ea5 as RealParameter (72800);

  r_state  (ReactionList)                as notype;
  stoich  (ReactionList, ComponentList) as RealParameter;
  DH0_r   (ReactionList)                as enth_mol;
  DH0          (ComponentList)                as enth_mol;       //GJ/kmol  of pure species in standard conditions (298K, 1 bar)
  r       (ReactionList, [1:x.EndNode]) as reaction_rate_1;//kmol/(kg_cat s)
  T_std        as temperature (fixed, 25);    //°C
  P_std        as pressure    (fixed, 1);     //bar
  z_pure       (ComponentList, ComponentList) as molefraction;   //pure components
  ref_comp     (ReactionList)                 as StringParameter;
  EtOH_ox       as flow_mol; //kmol/h
  
  //kinetics constants for EtOH  oxidative reforming (FluidCELL)
  nM   as RealParameter (0.96);
  nW   as RealParameter (0.25);
  nC   as RealParameter (0);
  nH   as RealParameter (0);

  S2EtOH           as notype;
  S2EtOH_star      as notype;
  O22EtOH          as notype;
  HRF              as notype;
  HRF_star         as notype;
  HHV_ret          as enth_mol;  //GJ/kmol
  WHSV_EtOH        as notype; // (Description:"EtOH weight hour space velocity [(kg/h_EtOH)/kg_cat]"); //catalyst includes the support material (not the filler)
  Selectivity      as notype;
  N_sel(ComponentList) as flow_mol; //kmol/h
  k_sel            as notype (fixed, 1e-5); //kmol/(s m2 Pa)
  Sw2EtOH          as notype;
  LMPD             as notype(Description:"Log-mean pressure difference");
  Pi_avg_mem_ret (ComponentList) as pressure;
  check_mass_bal as notype;
  check_energy_bal as notype;
  H2perm as notype (Description:"H2 permeate flowrate [Nm3/h]");
  Diff_eff (ComponentList, [1:x.EndNode]) as diffusivity (lower:1e-10, free, 0.05); //cm^2/s
  Diff_eff_per(ComponentList, [x2:x.EndNode]) as diffusivity (lower:1e-10, free, 0.05); //cm^2/s

  //-----------------
  //----- Ports -----
  //-----------------
  Sweep_in   as input MoleFractionPort;
  Feed_in    as input MoleFractionPort;
  Per_out    as output MoleFractionPort;
  Ret_out    as output MoleFractionPort;
  Heat       as input,output HeatPort;
  Power      as input,output HeatPort;
  

  //-------------------------------
  //----- streams connections -----
  //-------------------------------

  If (Feed_in.IsConnected) then
    Feed_in.P : free;
    Feed_in.T : free;
    Feed_in.F : free;
    Feed_in.z(ComponentList) : free;
    Feed_in.h : free;
    Feed_in.V : free;
  Else
  
    Feed_in.P : fixed;
    Feed_in.T : fixed;
    Feed_in.F : fixed;
    Feed_in.z : fixed;
    Feed_in.h : free;
    Feed_in.V : free;
    Feed_in.P : 15;
    Feed_in.T : 500;
    Feed_in.F : 0.3;
    //Feed_in.z(ComponentList) : 1/size(ComponentList);
    Feed_in.z(ComponentList-"EtOH"-"O2"-"H2O"-"N2") : 0;
    Feed_in.z("EtOH") : 0.15;
    Feed_in.z("O2")   : 0.05;
    Feed_in.z("N2")   : 0.25;
    Feed_in.z("H2O")  : 0.55;
    Feed_in.V*C_ret(0)=1;
    call(Feed_in.h) = pEnth_mol(Feed_in.T, Feed_in.P, Feed_in.z(ComponentList));
  EndIf
  
  Feed_in.F = C_ret(0)*u_ret(0)*S1_vessel*3600;
  Feed_in.z(ComponentList) = z_ret(ComponentList, 0);
  Feed_in.P = P_ret(0);
  Feed_in.T = T_ret(0);

  If (Sweep_in.IsConnected) then
    Sweep_in.P : free;
    Sweep_in.T : free;
    Sweep_in.F : free;
    Sweep_in.z(ComponentList) : free;
    Sweep_in.h : free;
    Sweep_in.V : free;
  Else
    Sweep_in.P : fixed;
    Sweep_in.T : fixed;
    Sweep_in.F : fixed;
    Sweep_in.z(ComponentList) : fixed;
    Sweep_in.h : free;
    Sweep_in.V : free;
    Sweep_in.P : 1;
    Sweep_in.T : 500;
    Sweep_in.F : 0.3;
    Sweep_in.z(ComponentList-"H2O"-"H2") : 0;
    Sweep_in.z("H2O") : 1;
    Sweep_in.z("H2") : 0.00;
    Sweep_in.V*C_per(sweep_in_node)=1;
    call(Sweep_in.h) = pEnth_mol(Sweep_in.T, Sweep_in.P, Sweep_in.z(ComponentList));
EndIf
  
  Sweep_in.F = C_per(sweep_in_node)*u_per(sweep_in_node)*S_annulus*N_mem*3600;
  Sweep_in.z(ComponentList) = z_per(ComponentList, sweep_in_node);
  Sweep_in.P = P_per(sweep_in_node);
  Sweep_in.T = T_per(sweep_in_node);

    Ret_out.P = P_ret(x.EndNode);
    Ret_out.T = T_ret(x.EndNode);
    Ret_out.F = C_ret(x.EndNode)*u_ret(x.EndNode)*S2_vessel*3600 ;//- sigma(N_sel(ComponentList-"H2"));
    Ret_out.z(ComponentList) = z_ret(ComponentList,x.EndNode);
    Ret_out.h = h_ret(x.EndNode);
    Ret_out.V = 1/C_ret(x.EndNode);
    
    Per_out.P = P_per_p(per_out_node);
    Per_out.T = T_per(x2);
    Per_out.F = C_per_p(per_out_node)*u_per_p(per_out_node)*S_int_pipe*N_mem*3600 ;//+ sigma(N_sel(ComponentList-"H2"));
    Per_out.z(ComponentList) = z_per(ComponentList,x2);
    call(Per_out.h) = pEnth_mol(Per_out.T, Per_out.P, Per_out.z(ComponentList));
    Per_out.V = 1/C_per_p(per_out_node);


  //--------------------
  //----- Geometry -----
  //--------------------

  Ltot          = L1+L2+L3;
  dA_mem        = pi*2*r_ext_support*dx2;
  t_annulus     = r_int_support-r_ext_pipe;
  r_ext_pipe    = r_int_pipe+t_pipe;
  r_ext_support = r_int_support+t_support;
  d_ext_support = r_ext_support*2;
  d_int_support = r_int_support*2;
  S1_vessel     = pi*r_vessel^2;
  S2_vessel     = pi*(r_vessel^2-r_ext_support^2*N_mem);
  S_annulus     = pi*(r_int_support^2-r_ext_pipe^2);
  S_int_pipe    = pi*r_int_pipe^2;
  dV2_annulus   = S_annulus*dx2;
  dV3_annulus   = S_annulus*dx3;
  dV1_vessel    = S1_vessel*dx1;
  dV2_vessel    = S2_vessel*dx2;
  dV3_vessel    = S2_vessel*dx3;
  dV2_pipe      = S_int_pipe*dx2;
  dV3_pipe      = S_int_pipe*dx3;
  A_mem_tot     = pi*2*r_ext_support*L2*N_mem;
  D_vessel      = 2*r_vessel;

  // membranes pattern
If pattern == "exagonal_pattern" then
  r_vessel: free;
  N_mem: free;
  dist_mems: fixed;
  N_mem = 1+sigma(foreach (i in [1:ring]) i*6);
  r_vessel = r_ext_support + ring*(dist_mems+2*r_ext_support) + dist_mems;
else
  if pattern == "circular_pattern" then
    r_vessel: free;
    dist_mems: fixed;
    r_vessel = r_ext_support + ring*(dist_mems+2*r_ext_support) + dist_mems;
    N_mem: free;
    N_mem = sigma(foreach (i in [1:ring]) truncate((2*pi*(i*dist_mems+(2*i)*r_ext_support))/(2*r_ext_support+dist_mems)));
  else
    if pattern == "polynomial" then //range:D_vessel=0.08-0.40m; dist_mems+d_ext_support=0.02-0.044m;
      r_vessel:fixed;
      dist_mems:fixed;
      N_mem:free;
      N_mem = min(1, round(-20146.95424*(dist_mems+d_ext_support)   +1640.411805*D_vessel
                           +1286119.585*(dist_mems+d_ext_support)^2 -168946.1591*(dist_mems+d_ext_support)  *D_vessel +5727.773358*D_vessel^2 
                           -33667079.03*(dist_mems+d_ext_support)^3 +5538295.554*(dist_mems+d_ext_support)^2*D_vessel -251764.9726*(dist_mems+d_ext_support)  *D_vessel^2 -2.916925107*(D_vessel)^3
                           +309806795  *(dist_mems+d_ext_support)^4 -58114373.37*(dist_mems+d_ext_support)^3*D_vessel +2949031.103*(dist_mems+d_ext_support)^2*D_vessel^2 +5197.760616*(dist_mems+d_ext_support)*D_vessel^3     -138.3494849*(D_vessel)^4 +105.7854398));
    else
      if pattern == "no_pattern_r_vessel_fixed" then //--> there is no control on the geometric feaseablility of the membranes distance (like in Delphi software)
        r_vessel: fixed;
        dist_mems: fixed;
        N_mem: fixed;
      else //"no_pattern_u0_umf_fixed"
        r_vessel: free;
        u0_umf_ratio(0): fixed;
      endif
    endif
  endif
endif

If (d_s>40e-6 and d_s<500e-6) then
    If (rho_s>1.4e+3 and rho_s<4e+3) then
      Solids=2;  // Geldart_B; limited on dimensions and density 
    Else
      If rho_s<1.4e+3 then
        Solids=1; //Geldart_A; same dimension, lighter solid
      Else
        Solids=4; //Geldart_D;
      EndIf
    EndIf
  Else
    If d_s<40e-6 then
      Solids=3; //Geldart_C;  //very small particles
    Else
      Solids=4; //Geldart_D  //very coarse particles
    EndIf
  EndIf

  If b_perm == "yes" then
    b_perm_coeff: 1;
  Else
    b_perm_coeff: 0;
  EndIf

  If DP == "yes" then
    p: 1;
  Else
    p: 0;
  EndIf

  If max(u0_umf_ratio)<1 then
    bed = 0; //packed bed
  else
    if (min(u0_umf_ratio)<1 and max(u0_umf_ratio)>1) then
      bed = 0.5; //partially fluidized bed
    else
      if max(Re_s) < min(Re_mb) then
        bed = 1; //homogeneus fluidization (minimum, no bubbles)
      else
        if max(Re_s) < min(Re_c) then
          bed = 2; //bubbling bed
        else
          if max(Re_s) < min(Re_k) then
          bed = 3; //transition bubbling to turbolent
          else
          bed = 4; //turbolent or fast fluidization
          endif
        endif
      endif
    endif
  endif

  time_cross_ret = h_s/(sigma(u_ret)/sigma(s));  //s
  time_cross_e = h_s/(sigma(u_e)/sigma(s));  //s
  time_cross_b = h_s/(sigma(u_b)/sigma(s));  //s
  
  WHSV_EtOH = C_ret(0)*u_ret(0)*MW("EtOH")*z_ret("EtOH",0)*S1_vessel/sigma(foreach (i in [x2i:x3]) m_s_i(i)*f_cat); // (kg/_EtOH)/kg_cat = 1/h

  z_cross(ComponentList-"H2")=0;
  z_cross("H2")=1;

  //creation of dummy vectros for pure components properties
  For m in ComponentList do
    For n in componentList do
      If m==n then
        z_pure(m,n) = 1;
      Else
        z_pure(m,n) = 0;
      Endif
    EndFor
  EndFor

  call(MW(ComponentList))= pMolWeights();

  check_m_b = C_ret(0)*u_ret(0)*S1_vessel*3600*MW_ret(0) + C_per(x.EndNode)*u_per(x.EndNode)*S_annulus*N_mem*3600*MW_per(x.EndNode)
            - C_ret(x.EndNode)*u_ret(x.EndNode)*S2_vessel*3600*MW_ret(x.EndNode) - C_per_p(x.EndNode)*u_per_p(x.EndNode)*S_int_pipe*N_mem*3600*MW_per_p; // kg/h
  check_t_b = (Feed_in.F*Feed_in.h + Sweep_in.F*Sweep_in.h - Ret_out.F*Ret_out.h - Per_out.F*Per_out.h)/3600*1e6 - Q_loss_tot;   //kW
  err_t_b = (check_t_b*3600/1e6)/(abs(Feed_in.F*z_ret("O2",0)/2*DH0_r("EtOH_ox")))*100;  //%
  err_m_b = check_m_b/(C_ret(0)*u_ret(0)*S1_vessel*3600*MW_ret(0))*100; //%

  check_H2_perm = sigma(ForEach(i in [x2:x3])F_H2(i))*N_mem - Per_out.F*Per_out.z("H2");

  // check atom balance //kmol/h
    bal_C = Feed_in.F*(2*Feed_in.z("EtOH")+1*Feed_in.z("CH4")+1*Feed_in.z("CO")+1*Feed_in.z("CO2")+0*Feed_in.z("H2")+0*Feed_in.z("H2O")+0*Feed_in.z("N2")+0*Feed_in.z("O2"))
           +Sweep_in.F*(2*Sweep_in.z("EtOH")+1*Sweep_in.z("CH4")+1*Sweep_in.z("CO")+1*Sweep_in.z("CO2")+0*Sweep_in.z("H2")+0*Sweep_in.z("H2O")+0*Sweep_in.z("N2")+0*Sweep_in.z("O2"))
           -Ret_out.F*(2*Ret_out.z("EtOH")+1*Ret_out.z("CH4")+1*Ret_out.z("CO")+1*Ret_out.z("CO2")+0*Ret_out.z("H2")+0*Ret_out.z("H2O")+0*Ret_out.z("N2")+0*Ret_out.z("O2"))
           -Per_out.F*(2*Per_out.z("EtOH")+1*Per_out.z("CH4")+1*Per_out.z("CO")+1*Per_out.z("CO2")+0*Per_out.z("H2")+0*Per_out.z("H2O")+0*Per_out.z("N2")+0*Per_out.z("O2"));

    bal_H = Feed_in.F*(6*Feed_in.z("EtOH")+4*Feed_in.z("CH4")+0*Feed_in.z("CO")+0*Feed_in.z("CO2")+2*Feed_in.z("H2")+2*Feed_in.z("H2O")+0*Feed_in.z("N2")+0*Feed_in.z("O2"))
           +Sweep_in.F*(6*Sweep_in.z("EtOH")+4*Sweep_in.z("CH4")+0*Sweep_in.z("CO")+0*Sweep_in.z("CO2")+2*Sweep_in.z("H2")+2*Sweep_in.z("H2O")+0*Sweep_in.z("N2")+0*Sweep_in.z("O2"))
           -Ret_out.F*(6*Ret_out.z("EtOH")+4*Ret_out.z("CH4")+0*Ret_out.z("CO")+0*Ret_out.z("CO2")+2*Ret_out.z("H2")+2*Ret_out.z("H2O")+0*Ret_out.z("N2")+0*Ret_out.z("O2"))
           -Per_out.F*(6*Per_out.z("EtOH")+4*Per_out.z("CH4")+0*Per_out.z("CO")+0*Per_out.z("CO2")+2*Per_out.z("H2")+2*Per_out.z("H2O")+0*Per_out.z("N2")+0*Per_out.z("O2"));

    bal_O = Feed_in.F*(1*Feed_in.z("EtOH")+0*Feed_in.z("CH4")+1*Feed_in.z("CO")+2*Feed_in.z("CO2")+0*Feed_in.z("H2")+1*Feed_in.z("H2O")+0*Feed_in.z("N2")+2*Feed_in.z("O2"))
           +Sweep_in.F*(1*Sweep_in.z("EtOH")+0*Sweep_in.z("CH4")+1*Sweep_in.z("CO")+2*Sweep_in.z("CO2")+0*Sweep_in.z("H2")+1*Sweep_in.z("H2O")+0*Sweep_in.z("N2")+2*Sweep_in.z("O2"))
           -Ret_out.F*(1*Ret_out.z("EtOH")+0*Ret_out.z("CH4")+1*Ret_out.z("CO")+2*Ret_out.z("CO2")+0*Ret_out.z("H2")+1*Ret_out.z("H2O")+0*Ret_out.z("N2")+2*Ret_out.z("O2"))
           -Per_out.F*(1*Per_out.z("EtOH")+0*Per_out.z("CH4")+1*Per_out.z("CO")+2*Per_out.z("CO2")+0*Per_out.z("H2")+1*Per_out.z("H2O")+0*Per_out.z("N2")+2*Per_out.z("O2"));
    
  //--------------------
  //--------------------
  //--------------------

  For i in [x2:x.EndNode] do
    Eq_C_per:           C_per(i) = P_per(i)*1e5/(Rgas*(T_per(i)+273.15))*1e-3; //kmol/m3
    Eq_C_per_p:         C_per_p(i) = P_per_p(i)*1e5/(Rgas*(T_per(x2)+273.15))*1e-3;
    Eq_h_per:           call(h_per(i))  = pEnth_Mol   (T_per(i), P_per(i), z_per(ComponentList,i)); //GJ/kmol
    Eq_mu_per:          call(mu_per(i)) = pVisc_Vap   (T_per(i), P_per(i), z_per(ComponentList,i)); //cP
    Eq_MW_per:          call(MW_per(i)) = pMolWeight  (z_per(ComponentList,i));
    //dimensionless numbers
    Eq_Re_per:          Re_per(i) = C_per(i)*MW_per(i)*abs(u_per(i))*(2*t_support)/(mu_per(i)*1e-3);
    Eq_Re_per_p:        Re_per_p(i) = C_per_p(i)*MW_per(x2)*abs(u_per_p(i))*2*r_int_pipe/(mu_per(x2)*1e-3);
  EndFor
  
  For i in [0:x.EndNode] do
    //ideal gas molar density
    Eq_C_ret:      C_ret(i) = P_ret(i)*1e5/(Rgas*(T_ret(i)+273.15))*1e-3; //kmol/m3
    //streams properties
    Eq_h_ret:      call(h_ret(i))  = pEnth_Mol   (T_ret(i), P_ret(i), z_ret(ComponentList,i)); //GJ/kmol
    Eq_mu_ret:     call(mu_ret(i)) = pVisc_Vap   (T_ret(i), P_ret(i), z_ret(ComponentList,i));
    Eq_MW_ret:     call(MW_ret(i)) = pMolWeight  (z_ret(ComponentList,i)); //kg/kmol 
  EndFor

  //------------------------
  //----- fluidization -----
  //------------------------

  Eq_rho_s_loose:            rho_s_loose = rho_s*(1-eps_0);
  Eq_f_fil:                  f_fil = 1 - f_cat;
  Eq_u0_umf_ratio_min:       u0_umf_ratio_min = min(u0_umf_ratio);
  Eq_u0_umf_ratio_max:       u0_umf_ratio_max = max(u0_umf_ratio);
  
   //to be computed in each section, but very small
  If bed<1 then
    d_b01 = 0;
  Else
    Eq_db01:       d_b01 = 2.78/g*(u_ret(0)-u_mf(0))^2*1e-2; //m  check units of measure!!! valid for high gas flow rates through distributors and porous plates [5.19]
  EndIf

  For i in [1:x.EndNode] do
    If bed==1 then  //smooth fluidization
      Eq_delta_b1:   delta_b(i) = 0.001; // it should be 0, no bubbles 
      Eq_delta_e1:   delta_e(i) = 1-delta_b(i);
    else      
      Eq_delta_b2:    delta_b(i) = (u_ret(i)-u_e(i)*delta_e(i))/u_b(i); //(u_ret(i)-u_mf(i))/(u_b(i)-u_mf(i));
      Eq_delta_e2:    delta_e(i) = 1-delta_b(i);  //-delta_w(i)-delta_c(i);
    endif
  EndFor
  delta_e(0) = 1;
  delta_b(0) = 0;

  delta_b_avg_mem = sigma(foreach (i in [x2i:x3]) delta_b(i))/(x3-x2i);
  delta_b_min_mem = min(delta_b([x2i:x3]));
  delta_b_max_mem = max(delta_b([x2i:x3]));
  d_b_avg_mem = sigma(foreach (i in [x2i:x3]) d_b(i))/(x3-x2i);
   
  For i in [0:x.EndNode] do
  Eq_Ar:           Ar(i) = d_s^3*C_ret(i)*MW_ret(i)*(rho_s-C_ret(i)*MW_ret(i))*g/(mu_ret(i)*1e-3)^2;
//  Eq_mu_app:       mu_app(i) = mu_ret(i)*(1+2.5*(1-eps_e(i))+10.05*(1-eps_e(i))^2+0.00273*exp(16.6*(1-eps_e(i))));   // Thomas model --> ok for zero bouyancy, not this case
//  Eq_eps_mf:       eps_mf(i) = 0.586*(Ar(i)^(-0.029))*(C_ret(i)*MW_ret(i)/rho_s)^0.021; --> substitute 0.586 with (1-eps_0)
  // Equation from Martin van Sint Annaland:
  Eq_eps_mf:       eps_mf(i) = 0.382*(Ar(i)^(-0.196)*(rho_s/(C_ret(i)*MW_ret(i)))^(-0.143)+1)*((T_ret(i)+273)/298)^0.083;
//Eq_u_mf:         1.75*Re_s_mf(i)^2/(eps_mf(i)^3*fi_s)+150*(1-eps_mf(i))/(eps_mf(i)^3*fi_s^2)*Re_s_mf(i) = Ar(i);
  // here written with Re_mf explicit
  //Eq_u_mf:         1.75*(d_s*u_mf(i)*C_ret(i)*MW_ret(i)/(mu_ret(i)*1e-3))^2/(eps_mf(i)^3*fi_s) + 150*(1-eps_mf(i))/(eps_mf(i)^3*fi_s^2)*(d_s*u_mf(i)*C_ret(i)*MW_ret(i)/(mu_ret(i)*1e-3)) = Ar(i);
  Eq_u_mf:         u_mf(i) = mu_ret(i)*1e-3/(d_s*C_ret(i)*MW_ret(i))*(sqrt(27.2^2+0.0408*Ar(i))-27.2);
  Eq_u0_umf:       u0_umf_ratio(i) = u_ret(i)/u_mf(i);
//  Eq_Re_b:       Re_b(i) = d_b(i)*u_br(i)*(rho_s*(1-eps_e(i)+C_ret(i)*MW_ret(i)*eps_e(i)))/(850*1e-3); // denominaror is appearent emulsion phase viscosity (suggested 400-1300 cP)
  Eq_Re_s:         Re_s(i) = d_s*u_ret(i)*C_ret(i)*MW_ret(i)/(mu_ret(i)*1e-3);
  Eq_Re_mb:        Re_mb(i) = 0.00464*Ar(i)^(2/3);
  Eq_Re_c:         Re_c(i) = 0.0791*Ar(i)^(0.435);
  Eq_Re_k:         Re_k(i) = 1.31*Ar(i)^(0.450);

  Eq_d_bmax1:     d_bmax(i) = max(2e-8, 0.65*(pi*r_vessel^2*abs(u_ret(i)-u_mf(i)))^0.4); // [6.5]  //d_bmax not limited by the membranes (to obtain a continuous profile of d_b along the reactor)
  
  If i<=x2 then
    Eq_d_b1:        d_b(i) = max(1e-8, d_bmax(i)-(d_bmax(i)-d_b01)*exp(-0.3*i*dx1/D_vessel)); // [6.4]
    If d_b(i)/D_vessel<0.125 then
      Eq_u_br1:       u_br(i) = 0.711*(g*d_b(i))^0.5;
    Else
      If d_b(i)/D_vessel<0.6 then
        Eq_u_br2:       u_br(i) = 0.711*(g*d_b(i))^0.5*1.2*exp(-1.49*d_b(i)/D_vessel);
      Else  //slug flow
        Eq_u_br3:       u_br(i) = 0.35*(g*D_vessel)^0.5;
      Endif
    Endif
  Else
    If i<=x3 then
      If d_b(x2)<dist_mems then
        Eq_d_b2:        d_b(i) = max(1e-8, min(dist_mems, d_bmax(i)-(d_bmax(i)-d_b01)*exp(-0.3*((i-x2)*dx2+L1)/D_vessel)));
        If d_b(i)/dist_mems<0.125 then
          Eq_u_br4:       u_br(i) = 0.711*(g*d_b(i))^0.5;
        Else
          If d_b(i)/dist_mems<=0.6 then      //2*r_vessel substitued by dist_mems;  limit of 0.6 increased to 1 to pass to slug flow; DOUBT: WHEN SLUG RAISES BETWEEN MEMBRANES?
            Eq_u_br5:       u_br(i) = 0.711*(g*d_b(i))^0.5*1.2*exp(-1.49*d_b(i)/D_vessel);
          Else
            Eq_u_br6:       u_br(i) = 0.35*(g*dist_mems)^0.5;
          Endif
        Endif
      Else
        Eq_d_b3:        d_b(i) = max(1e-8, d_bmax(i)-(d_bmax(i)-d_b01)*exp(-0.3*((i-x2)*dx2+L1)/D_vessel));
        If d_b(i)/D_vessel<0.125 then
          Eq_u_br7:       u_br(i) = 0.711*(g*d_b(i))^0.5;
        Else
          If d_b(i)/D_vessel<=0.6 then
            Eq_u_br8:       u_br(i) = 0.711*(g*d_b(i))^0.5*1.2*exp(-1.49*d_b(i)/D_vessel);
          Else
            Eq_u_br9:       u_br(i) = 0.35*(g*D_vessel)^0.5;
          Endif
        Endif
      Endif
    Else
      If d_b(x2)<dist_mems then
        Eq_d_b4:        d_b(i) = max(1e-8, min(dist_mems, d_bmax(i)-(d_bmax(i)-d_b01)*exp(-0.3*((i-x3)*dx3+L2)/D_vessel)));
        If d_b(i)/dist_mems<0.125 then
          Eq_u_br10:       u_br(i) = 0.711*(g*d_b(i))^0.5;
        Else
          If d_b(i)/dist_mems<=0.6 then
            Eq_u_br11:       u_br(i) = 0.711*(g*d_b(i))^0.5*1.2*exp(-1.49*d_b(i)/D_vessel);
          Else
            Eq_u_br12:       u_br(i) = 0.35*(g*dist_mems)^0.5;
          Endif
        Endif
      Else
        Eq_d_b5:        d_b(i) = max(1e-8, d_bmax(i)-(d_bmax(i)-d_b01)*exp(-0.3*((i-x2-1)*dx2+L1)/D_vessel));
        If d_b(i)/D_vessel<0.125 then
          Eq_u_br13:       u_br(i) = 0.711*(g*d_b(i))^0.5;
        Else
          If d_b(i)/D_vessel<=0.6 then
            Eq_u_br14:       u_br(i) = 0.711*(g*d_b(i))^0.5*1.2*exp(-1.49*d_b(i)/D_vessel);
          Else
            Eq_u_br15:       u_br(i) = 0.35*(g*D_vessel)^0.5;
          Endif
        Endif
      Endif
    EndIf 
  EndIf
  Eq_eps_e1:      eps_e(i) = eps_mf(i);
  EndFor

For i in [1:x.EndNode] do
  Eq_u_b1:        u_b(i) = u_ret(i)-u_mf(i)+u_br(i);
  Eq_u_e1:        u_e(i) = u_mf(i);
  //Eq_u_e1:        (eps_e(i)/eps_mf(i))^3 *(1-eps_mf(i))/(e-epse(i)) = (u_e(i)/u_mf)^0.7;
EndFor
u_b(0) = 0;
u_e(0) = u_ret(0);

// ----------  
// methode 3: compute local solid mass till specified heigh and the corresponding total mass
// ----------
// suggested in design mode, because it is possible to set the desired heigh of the bed (the same as the embranes level, as in Delphi model from TU/e) and compute the corresponding mass

  For i in [1:x.EndNode] do
        If i<=x2 then  //bottom region
          Eq_m_s_i5:         m_s_i(i) = rho_s*(1-eps_e(i))*dx1*S1_vessel*(1-delta_b(i));
        Else  //membranes region
          If i<=x3 then
            Eq_m_s_i6:         m_s_i(i) = rho_s*(1-eps_e(i))*dx2*S2_vessel*(1-delta_b(i));
          Else  //supports region
            Eq_m_s_i7:         m_s_i(i) = 1e-20; //rho_s*(1-eps_e(i))*dx3*S2_vessel*(1-delta_b(i));
          EndIf
        EndIf
  EndFor
  Eq_m_s_i8:         m_s_i(0) = 1e-20;
  Eq_h_s_0:
  If m_s/(rho_s*(1-eps_0)) <= L1 then
    m_s/(rho_s*(1-eps_0)) = h_s_0*S1_vessel;
  Else
    m_s/(rho_s*(1-eps_0)) = L1*(S1_vessel-S2_vessel)+h_s_0*S2_vessel;
  EndIf
  Eq_h_s:            h_s = L1+L2;
  Eq_s_cum_i0: m_s_cum_i(0) = 0;
  For i in [1:x.EndNode] do
    Eq_s_cum_i: m_s_cum_i(i) = m_s_cum_i(i-1)+m_s_i(i);
    If m_s_i(i) > 1e-5 then
      s(i) = 1;
    else
      s(i) = 0;
    endif
  EndFor
  m_s = max(m_s_cum_i);
  s(0) = 0;
  // solid balance check
  Eq_check_s_b:   check_s_b = sigma(m_s_i)-m_s;

  //------------------------------
  //----- Chemical reactions -----
  //------------------------------
    //stoichiometric coefficients of listed chemical reactions
    //Eq_stc_MSR: CH4 + H2O --> CO + 3 H2
    stoich("MSR","CH4"): -1;
    stoich("MSR","H2O"): -1;
    stoich("MSR","CO"):   1;
    stoich("MSR","H2"):   3;
    stoich("MSR",ComponentList-"CH4"-"H2O"-"CO"-"H2"): 0;
    //Eq_stc_MSR_2: CH4 + 2 H2O --> CO2 + 4 H2
    stoich("MSR_2","CH4"): -1;
    stoich("MSR_2","H2O"): -2;
    stoich("MSR_2","CO2"):  1;
    stoich("MSR_2","H2"):   4;
    stoich("MSR_2",ComponentList-"CH4"-"H2O"-"CO2"-"H2"): 0;
    //Eq_stc_WGS: CO + H2O --> CO2 + H2
    stoich("WGS","CO"):   -1;
    stoich("WGS","H2O"):  -1;
    stoich("WGS","CO2"):   1;
    stoich("WGS","H2"):    1;
    stoich("WGS",ComponentList-"CO"-"H2O"-"CO2"-"H2"): 0;
    //Eq_stc_EtOH_decomposition: EtOH --> CH4 + CO + H2
    stoich("EtOH_dec","EtOH"): -1;
    stoich("EtOH_dec","CH4"):   1;
    stoich("EtOH_dec","CO"):    1;
    stoich("EtOH_dec","H2"):    1;
    stoich("EtOH_dec",ComponentList-"EtOH"-"CH4"-"CO"-"H2"):0;
    //Eq_stc_EtOH_oxidation: EtOH + 3 O2 --> 2 CO2 + 3 H2O
    stoich("EtOH_ox","EtOH"): -1.0;
    stoich("EtOH_ox","O2"):   -3.0;
    stoich("EtOH_ox","CO2"):   2.0;
    stoich("EtOH_ox","H2O"):   3.0;
    stoich("EtOH_ox",ComponentList-"EtOH"-"O2"-"CO2"-"H2O"):0;
    //Eq_stc_EtOH_SR: EtOH + 2 H2O --> 2 CO + 5 H2
    stoich("EtOH_SR","EtOH"): -1;
    stoich("EtOH_SR","H2O"):  -1;
    stoich("EtOH_SR","CO"):    2;
    stoich("EtOH_SR","H2"):    5;
    stoich("EtOH_SR",ComponentList-"EtOH"-"H2O"-"CO"-"H2"):0;
    //Eq_stc_EtOH_SR_2: EtOH + H2O --> CO2 + CH4 + 2 H2
    stoich("EtOH_SR_2","EtOH"): -1;
    stoich("EtOH_SR_2","H2O"):  -1;
    stoich("EtOH_SR_2","CO2"):   1;
    stoich("EtOH_SR_2","CH4"):   1;
    stoich("EtOH_SR_2","H2"):    2;
    stoich("EtOH_SR_2",ComponentList-"EtOH"-"H2O"-"CO2"-"CH4"-"H2"):0;
    //Eq_stc_EtOH_SR_3: EtOH + 3 H2O --> 2 CO2 + 6 H2
    stoich("EtOH_SR_3","EtOH"): -1;
    stoich("EtOH_SR_3","H2O"):  -3;
    stoich("EtOH_SR_3","CO2"):   2;
    stoich("EtOH_SR_3","H2"):    6;
    stoich("EtOH_SR_3",ComponentList-"EtOH"-"H2O"-"CO2"-"H2"):0;
    //Eq_stc_CH4_ox: CH4 + 2 O2 --> CO2 + 2 H2O
    stoich("CH4_ox","CH4"):  -1;
    stoich("CH4_ox","O2"):   -2;
    stoich("CH4_ox","CO2"):   1;
    stoich("CH4_ox","H2O"):   2;
    stoich("CH4_ox",ComponentList-"CH4"-"O2"-"CO2"-"H2O"):0;
    //Eq_stc_H2_ox: H2 + 0.5 O2 --> H2O
    stoich("H2_ox","H2"):  -1.0;
    stoich("H2_ox","O2"):  -0.5;
    stoich("H2_ox","H2O"):  1.0;
    stoich("H2_ox",ComponentList-"H2"-"O2"-"H2O"):0;
    //Eq_stc_CO_ox: CO + 0.5 O2 --> CO2
    stoich("CO_ox","CO"):  -1.0;
    stoich("CO_ox","O2"):  -0.5;
    stoich("CO_ox","CO2"):  1.0;
    stoich("CO_ox",ComponentList-"CO"-"O2"-"CO2"):0;
    //put zero all other reactions (just in case some are listed but not necessay and approved)
    stoich(ReactionList-"CH4_ox"-"CO_ox"-"EtOH_dec"-"EtOH_ox"-"EtOH_SR"-"EtOH_SR_2"-"EtOH_SR_3"-"H2_ox"-"MSR"-"MSR_2"-"WGS",ComponentList):0;

    ref_comp("MSR"):"CH4";
    ref_comp("MSR_2"):"CH4";
    ref_comp("WGS"):"CO";
    ref_comp("EtOH_dec"):"EtOH";
    ref_comp("EtOH_ox"):"EtOH";
    ref_comp("EtOH_SR"):"EtOH";
    ref_comp("EtOH_SR_2"):"EtOH";
    ref_comp("EtOH_SR_3"):"EtOH";
    ref_comp("CH4_ox"):"CH4";
    ref_comp("H2_ox"):"H2";
    ref_comp("CO_ox"):"CO";
  
    
  // DH0 (Tstd,Pstd) of listed chemical reactions
  For k in ReactionList do
    Eq_DH0_r:        DH0_r(k) = sigma(stoich(k,ComponentList)*DH0(ComponentList));
  EndFor
  // DH0 (formation: T_std, P_std) of pure species 
  For m in ComponentList do
    Eq_DH0_species:  call(DH0(m)) = pEnth_Mol_Vap(T_std, P_std, z_pure(m,ComponentList));
  EndFor

  r_state("MSR") = 1;
  r_state("WGS") = 1;
  r_state("CH4_ox") = 0;
  r_state(ReactionList-"MSR"-"WGS"-"CH4_ox") = 0;

  For i in [1:x.EndNode] do
    Eq_r_MSR_FluiCELL:     r("MSR",i) = k5*exp(-Ea5/(Rgas*(T_ret(i)+273))) * (max(0.0000001, P_ret(i)*z_e("CH4",i)*1e5))^nM * (max(0.0000001, P_ret(i)*z_e("H2O",i)*1e5))^nW * (max(0.0000001, P_ret(i)*z_e("CO",i)*1e5))^nC * (max(0.0000001, P_ret(i)*z_e("H2",i)*1e5))^nH * ( 1 - (max(0.0000001, P_ret(i)*1e5*z_e("H2",i)))^3*(max(0.0000001, P_ret(i)*1e5*z_e("CO",i)))^1*(max(0.0000001, P_ret(i)*1e5*z_e("CH4",i)))^(-1)*(max(0.0000001, P_ret(i)*1e5*z_e("H2O",i)))^(-1)/(119.8*1e21*exp(-26830/(T_ret(i)+273)))  );     //exp(-(53717-60.25*(T_ret(i)+273))/(1.987*(T_ret(i)+273))) ) ;  //kmol/(s kg_cat);;// *a(i); //
    Eq_r_WGS:              r("WGS",i) = A_WGS*exp(-Ea_WGS/(Rgas*(T_ret(i)+273))) * (max(0.00001, P_ret(i)*1e5*z_e("H2O",i)))^(-1)     * (P_ret(i)*1e5*z_e("H2O",i) * P_ret(i)*1e5*z_e("CO",i)  - (P_ret(i)*1e5*z_e("H2",i) * P_ret(i)*1e5*z_e("CO2",i))    / (1.767*1e-2*exp(4400/(T_ret(i)+273)))    /*(exp(-DG0_r("WGS",i)*1e6/(Rgas*(T_ret(i)+273))))*/ );                     //(exp(-DG0_r("WGS",i)*1e6/(Rgas*(T_ret(i)+273)))) );
    Eq_r_CH4_ox_Trimm_Lam: r("CH4_ox",i) = ((8.11e-5*exp(-86000/Rgas/(T_ret(i)+273))*P_ret(i)*z_ret("CH4",i)*1e5*P_ret(i)*z_ret("O2",i)*1e5)
                                            / (1 + 1.26e-6*exp(27000/Rgas/(T_ret(i)+273))*max(1e-5, P_ret(i)*z_ret("CH4",i)*1e5) + 7.82e-2*exp(92800/Rgas/(T_ret(i)+273))*max(1e-5, P_ret(i)*z_ret("O2",i)*1e5))^2
                                            + (6.82e-5*exp(-86000/Rgas/(T_ret(i)+273))*P_ret(i)*z_ret("CH4",i)*1e5*P_ret(i)*z_ret("O2",i)*1e5)
                                            / (1 + 1.26e-6*exp(27000/Rgas/(T_ret(i)+273))*max(1e-5, P_ret(i)*z_ret("CH4",i)*1e5) + 7.82e-2*exp(92800/Rgas/(T_ret(i)+273))*max(1e-5, P_ret(i)*z_ret("O2",i)*1e5)))*1e-3; //kmol/(s kg_cat)
    Eq_r_others_FluiCELL:  r(ReactionList-"MSR"-"WGS"-"CH4_ox",i) = 0;
  //r_NK(i)  = A_MSR*exp(-Ea_MSR/(Rgas*(T_ret(i)+273))) * (max(0.00001, P_ret(i)*z_e("H2O",i)*1e+5))^(-1.596) * (P_ret(i)*z_e("H2O",i)*1e+5 * P_ret(i)*z_e("CH4",i)*1e+5 - (P_ret(i)*z_e("CO",i)*1e+5 * (P_ret(i)*z_e("H2",i)*1e+5)^3)/ (119.8*1e21*exp(-26830/(T_ret(i)+273)));            //(exp(-DG0_r("MSR",i)*1e6/(Rgas*(T_ret(i)+273))))  );
  EndFor


  //--------------------------
  //----- moles balances -----
  //--------------------------

  Eq_check_mass_bal:         check_mass_bal   = Feed_in.F*MW_feed_in  + Sweep_in.F*MW_sweep_in  - Per_out.F*MW_per_out  - Ret_out.F*MW_ret_out;
  Eq_check_energy_bal:       check_energy_bal = Feed_in.F*Feed_in.h   + Sweep_in.F*Sweep_in.h   - Per_out.F*Per_out.h   - Ret_out.F*Ret_out.h - Q_loss_tot*3600*1e-6;
  
  call(MW_feed_in)   = pMolWeight(Feed_in.z);
  call(MW_sweep_in)  = pMolWeight(Sweep_in.z);
  call(MW_per_out)   = pMolWeight(Per_out.z);
  call(MW_ret_out)   = pMolWeight(Ret_out.z);

  //---------------------------------------------------------------------
  //with bubble/emulsion separation, chemical reactions and mass transfer
  //---------------------------------------------------------------------

  //hydrogen permeation flow //kmol/h/mem
  For i in [x2i:x3] do
    F_H2_e(i) = kper_0*exp(-Ea/Rgas/(T_ret(i)+273))*(max(1e-5, P_ret(i-1)*z_e("H2",i-1)*1e5)^n-max(1e-5, P_per(i)*z_interface("H2",i)*1e5)^n)*dA_mem*delta_e(i)*3600;
    F_H2_b(i) = kper_0*exp(-Ea/Rgas/(T_ret(i)+273))*(max(1e-5, P_ret(i-1)*z_b("H2",i-1)*1e5)^n-max(1e-5, P_per(i)*z_interface("H2",i)*1e5)^n)*dA_mem*delta_b(i)*3600*b_perm_coeff;
    F_H2(i) = F_H2_e(i)+F_H2_b(i);
    Eq_z_interface1:       z_interface(ComponentList-"H2"-"H2O",i) = 0;
    Eq_z_interface2:       z_interface("H2O",i) = 1-z_interface("H2",i);
    If supp_diff == "Consider_support_diff" then
      Eq_z_interface3:       z_interface("H2",i) = (z_per("H2",i)-1)*(r_ext_support/r_int_support)^( (-F_H2(i)/3600/dA_mem)*tor*r_ext_support/(C_per(i)*por)*(1e4/Diff_eff_per("H2",i) + 1/(2/3*r_por*sqrt(8*Rgas*(T_per(i)+273)/pi/MW("H2")*1e3))))+1; //cylindrical support
    Else  // neglect suport effect
      Eq_z_interface4:       z_interface("H2",i) = z_per("H2",i);
    EndIf
  EndFor
  F_H2(x2) = 0;
  F_H2_e(x2) = 0;
  F_H2_b(x2) = 0;
  //z_interface(ComponentList, x2) = 0;

  //molar fraction definition
  For i in [1:x.EndNode] do
    Eq_z_sum_ret:       1 = sigma(z_ret(ComponentList,i));
    C_ret(i)*z_ret(ComponentList,i)*u_ret(i) = C_ret(i)*z_e(ComponentList,i)*u_e(i)*delta_e(i) + C_ret(i)*z_b(ComponentList,i)*u_b(i)*delta_b(i); 
  EndFor

  z_per_p(ComponentList) = z_per(ComponentList, x2);

  For i in [x2:x.EndNode-1] do

    Eq_z_sum_per:       1 = sigma(z_per(ComponentList,i));

    If i<=x3 then
      //mole balance permeate, annulus side
      Eq_Ci_per_bal1:
      $C_per(i)*z_per(ComponentList-"H2",i)*dV2_annulus = (C_per(i+1)*z_per(ComponentList-"H2",i+1)*u_per(i+1)-C_per(i)*z_per(ComponentList-"H2",i)*u_per(i))*S_annulus;

      $C_per(i)*z_per("H2",i)*dV2_annulus = (C_per(i+1)*z_per("H2",i+1)*u_per(i+1)-C_per(i)*z_per("H2",i)*u_per(i))*S_annulus + F_H2(i)/3600;
      Else
      //mole balance permeate, annulus side
      Eq_Ci_per_bal2:
      $C_per(i)*z_per(ComponentList,i)*dV3_annulus = (C_per(i+1)*z_per(ComponentList,i+1)*u_per(i+1)-C_per(i)*z_per(ComponentList,i)*u_per(i))*S_annulus;
    EndIf
  EndFor

  For i in [x2i:x.EndNode] do
    If i<=x3 then                      
      //mole balance permeate, pipe side
      Eq_C_per_p_bal1:
      $C_per_p(i)*dV2_pipe = (C_per_p(i-1)*u_per_p(i-1)-C_per_p(i)*u_per_p(i))*S_int_pipe;
    Else
      //mole balance permeate, pipe side
      Eq_C_per_p_bal2:
      $C_per_p(i)*dV3_pipe = (C_per_p(i-1)*u_per_p(i-1)-C_per_p(i)*u_per_p(i))*S_int_pipe;
    EndIf
  EndFor
  
  Eq_C_per_C_per_p:          C_per_p(x2)*u_per_p(x2)*S_int_pipe = C_per(x2)*u_per(x2)*S_annulus;
  Eq_MW_per_p:               MW_per_p = MW_per(x2);

  
  
  For i in [1:x.EndNode] do
    For k in ComponentList do
 
  If i<=x2 then //mole balance bottom region retentate side
      Eq_Ci_e_bal1:
      $C_ret(i)*z_e(k,i)*delta_e(i)*S1_vessel*dx1 =  (C_ret(i-1)*z_e(k,i-1)*u_e(i-1)*delta_e(i-1)-C_ret(i)*z_e(k,i)*u_e(i)*delta_e(i))*S1_vessel  //avvective flow through the continuos emulsion phase
                                                          + m_s_i(i) * f_cat * sigma(ForEach (j in ReactionList) r_state(j)*r(j,i)*stoich(j,k))  // in the case of reactions with kinetics
                                                          + 0.7 *  C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  //  /**r_state("EtOH_ox")*/    by oxidation of EtOH with all the oxygen present
                                                          + 0.7 * (C_ret(i-1)*z_e("EtOH",i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel-C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_dec",k)/abs(stoich("EtOH_dec","EtOH")) //  /**r_state("EtOH_dec")*/   by decomposition ofresidual EtOH after oxidation 
                                                          + C_ret(i)*(z_b(k,i)-z_e(k,i))*S1_vessel*delta_b(i)*dx1       //diffusive flow e-c on single bubble volume basis
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) );
      Eq_Ci_b_bal1:
      $C_ret(i)*z_b(k,i)*delta_b(i)*S1_vessel*dx1 =  (C_ret(i-1)*z_b(k,i-1)*u_b(i-1)*delta_b(i-1)-C_ret(i)*z_b(k,i)*u_b(i)*delta_b(i))*S1_vessel
                                                          //+ 0.5 * C_ret(i-1)*z_b("O2",i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  // /**r_state("EtOH_ox")*/   no oxidation       by oxidation of EtOH with all the oxygen present
                                                          //+ 0.5 * (C_ret(i-1)*z_b("EtOH",i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel-C_ret(i-1)*z_b("O2",i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_dec",k)/abs(stoich("EtOH_dec","EtOH")) //    /**r_state("EtOH_dec")*/   by decomposition ofresidual EtOH after oxidation 
                                                          + C_ret(i)*(z_e(k,i)-z_b(k,i))*S1_vessel*delta_b(i)*dx1    
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) );
    Else
    If i==x2i then
      Eq_Ci_e_bal2:
      $C_ret(i)*z_e(k,i)*delta_e(i)*S2_vessel*dx2 =  (C_ret(i-1)*z_e(k,i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel-C_ret(i)*z_e(k,i)*u_e(i)*delta_e(i)*S2_vessel)  //avvective flow through the continuos emulsion phase
                                                          + m_s_i(i) * f_cat * sigma(ForEach (j in ReactionList) r_state(j)*r(j,i)*stoich(j,k))
                                                          + 0.5 * C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  // /**r_state("EtOH_ox")*/   by oxidation of EtOH with all the oxygen present
                                                          + 0.5 * (C_ret(i-1)*z_e("EtOH",i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel-C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S1_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_dec",k) //   /**r_state("EtOH_dec")*/  by decomposition ofresidual EtOH after oxidation
                                                          + C_ret(i)*(z_b(k,i)-z_e(k,i))*S2_vessel*delta_b(i)*dx2         //diffusive flow e-c on single bubble volume basis
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) )
                                                          - z_cross(k)*F_H2_e(i)/3600*N_mem;
      Eq_Ci_b_bal2:
      $C_ret(i)*z_b(k,i)*delta_b(i)*S2_vessel*dx2 =  (C_ret(i-1)*z_b(k,i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel-C_ret(i)*z_b(k,i)*u_b(i)*delta_b(i)*S2_vessel)
                                                        //  + 0.5 * C_ret(i-1)*z_b("O2",i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  // /**r_state("EtOH_ox")*/   no oxidation       by oxidation of EtOH with all the oxygen present
                                                        //  + 0.5 * (C_ret(i-1)*z_b("EtOH",i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel-C_ret(i-1)*z_b("O2",i-1)*u_b(i-1)*delta_b(i-1)*S1_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_dec",k)/abs(stoich("EtOH_dec","EtOH")) //  /**r_state("EtOH_dec")*/   by decomposition ofresidual EtOH after oxidation 
                                                          + C_ret(i)*(z_e(k,i)-z_b(k,i))*S2_vessel*delta_b(i)*dx2       
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) )
                                                          -z_cross(k)*F_H2_b(i)/3600*N_mem;
    Else  //mole balance membrane region retentate side
      If i<=x3 then
        
      Eq_Ci_e_bal3:
      $C_ret(i)*z_e(k,i)*S2_vessel*delta_e(i)*dx2 =  (C_ret(i-1)*z_e(k,i-1)*u_e(i-1)*delta_e(i-1)-C_ret(i)*z_e(k,i)*u_e(i)*delta_e(i))*S2_vessel  //avvective flow through the continuos emulsion phase
                                                          + m_s_i(i) * f_cat * sigma(ForEach (j in ReactionList) r_state(j)*r(j,i)*stoich(j,k))
                                                          + 0.5 * C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S2_vessel*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  //  /**r_state("EtOH_ox")*/   by oxidation of EtOH with all the oxygen present
                                                          + 0.5 * (C_ret(i-1)*z_e("EtOH",i-1)*u_e(i-1)*delta_e(i-1)*S2_vessel-C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S2_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_dec",k) //   /**r_state("EtOH_dec")*/  by decomposition ofresidual EtOH after oxidation
                                                          + C_ret(i)*(z_b(k,i)-z_e(k,i))*S2_vessel*delta_b(i)*dx2  
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) )
                                                          -z_cross(k)*F_H2_e(i)/3600*N_mem;
      Eq_Ci_b_bal3:
      $C_ret(i)*z_b(k,i)*S2_vessel*delta_b(i)*dx2 =  (C_ret(i-1)*z_b(k,i-1)*u_b(i-1)*delta_b(i-1)-C_ret(i)*z_b(k,i)*u_b(i)*delta_b(i))*S2_vessel
                                                        //  + 0.5 * C_ret(i-1)*z_b("O2",i-1)*u_b(i-1)*delta_b(i-1)*S2_vessel*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  // /**r_state("EtOH_ox")*/   no oxidation       by oxidation of EtOH with all the oxygen present
                                                        //  + 0.5 * (C_ret(i-1)*z_b("EtOH",i-1)*u_b(i-1)*delta_b(i-1)*S2_vessel-C_ret(i-1)*z_b("O2",i-1)*u_b(i-1)*delta_b(i-1)*S2_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_dec",k)/abs(stoich("EtOH_dec","EtOH")) //  /**r_state("EtOH_dec")*/   by decomposition ofresidual EtOH after oxidation 
                                                          + C_ret(i)*(z_e(k,i)-z_b(k,i))*S2_vessel*delta_b(i)*dx2
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) )
                                                          -z_cross(k)*F_H2_e(i)/3600*N_mem;
      Else
      Eq_Ci_e_bal4:
      $C_ret(i)*z_e(k,i)*S2_vessel*delta_e(i)*dx3 =  (C_ret(i-1)*z_e(k,i-1)*u_e(i-1)*delta_e(i-1)-C_ret(i)*z_e(k,i)*u_e(i)*delta_e(i))*S2_vessel  //avvective flow through the continuos emulsion phase
                                                          + m_s_i(i) * f_cat * sigma(ForEach (j in ReactionList) r_state(j)*r(j,i)*stoich(j,k))
                                                          + C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S2_vessel/**r_state("EtOH_ox")*/*stoich("EtOH_ox",k)/abs(stoich("EtOH_ox","O2"))  // by oxidation of EtOH with all the oxygen present
                                                          + (C_ret(i-1)*z_e("EtOH",i-1)*u_e(i-1)*delta_e(i-1)*S2_vessel-C_ret(i-1)*z_e("O2",i-1)*u_e(i-1)*delta_e(i-1)*S2_vessel*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))/**r_state("EtOH_dec")*/*stoich("EtOH_dec",k) //by decomposition ofresidual EtOH after oxidation
                                                          + C_ret(i)*(z_b(k,i)-z_e(k,i))*S2_vessel*delta_b(i)*dx3
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) );
      Eq_Ci_b_bal4:
      $C_ret(i)*z_b(k,i)*S2_vessel*delta_b(i)*dx3 =  (C_ret(i-1)*z_b(k,i-1)*u_b(i-1)*delta_b(i-1)-C_ret(i)*z_b(k,i)*u_b(i)*delta_b(i))*S2_vessel
                                                          + C_ret(i)*(z_e(k,i)-z_b(k,i))*S2_vessel*delta_b(i)*dx3
                                                          / (1 / (4.5*u_mf(i)/d_b(i) + 5.85*(Diff_eff(k,i)*1e-4)^0.5*(g/d_b(i)^5)^0.25) + 1 / (6.77*(Diff_eff(k,i)*1e-4*eps_mf(i)*u_br(i)/d_b(i)^3)^0.5) );
                                                          
        EndIf
      EndIf
    EndIf
    EndFor
  EndFor

    z_b(ComponentList,0) = z_ret(ComponentList,0);
    z_e(ComponentList,0) = z_ret(ComponentList,0);

  For i in [1:x.EndNode] do
    //call(Diff_bin (ComponentList,ComponentList,i)) = pDiffus_Bin_Vap(T_ret(i),P_ret(i),z_ret(ComponentList,i));
    call(Diff_eff(ComponentList,i)) = pDiffus_Vap(T_ret(i),P_ret(i),z_ret(ComponentList,i));
  EndFor
  For i in [x2:x.EndNode] do
    call(Diff_eff_per(ComponentList,i)) = pDiffus_Vap(T_per(i),P_per(i),z_per(ComponentList,i));
  EndFor
  

/*
  //---------------------------------
  //----- global MR selectivity -----
  //---------------------------------
  
  Pi_avg_mem_ret(ComponentList) = sigma(ForEach (i in [x2:x3]) P_ret(i)*z_ret(ComponentList,i))/(x3-x2); //bar
  N_sel(ComponentList-"H2") = min(1e-10, k_sel*(Pi_avg_mem_ret(ComponentList-"H2")*1e5)*A_mem_tot*3600);  //kmol/h
  N_sel("H2")=0;

  Selectivity = (Per_out.F*Per_out.z("H2"))/sigma(N_sel(ComponentList-"H2"));
  */
  
  //--------------------
  //----- pressure -----
  //--------------------

  For i in [x2:x.EndNode-1] do
    If i<=x3 then
      Eq_P_per1:  P_per(i) = P_per(i+1);//-64/Re_per(i)*C_per(i)*MW_per(i)*(u_per(i)^2)/2*dx2/(2*t_annulus)*1e-5;
    else
      Eq_P_per2:  P_per(i) = P_per(i+1);//-64/Re_per(i)*C_per(i)*MW_per(i)*(u_per(i)^2)/2*dx3/(2*t_annulus)*1e-5;
    endif
  EndFor
  For i in [x2+1:x.EndNode] do
    If i<x3 then
      Eq_P_per_p1: P_per_p(i) = P_per_p(i-1);// -64/Re_per_p(i)/2*C_per_p(i)*MW_per(x2)*(u_per_p(i)^2)/2*dx2/(2*r_int_pipe)*1e-5;
    Else
      Eq_P_per_p2: P_per_p(i) = P_per_p(i-1);// -64/Re_per_p(i)/2*C_per_p(i)*MW_per(x2)*(u_per_p(i)^2)/2*dx3/(2*r_int_pipe)*1e-5;
    Endif
  EndFor
  Eq_P_per_p3: P_per_p(x2) = P_per(x2)*0.99;// - 5 *C_per(x2)*MW_per(x2)*(u_per(x2)^2)/2*1e-5; //check formula for pressure drop due to annulus-pipe 180° bend


  P_ret(1) = P_ret(0) - p*C_ret(1)*MW_ret(1)*u_ret(1)^2/(2*(0.6*0.1)^2)*1e-5; //Cd = discharge coefficient=0.6; F = fractional free area=0.1
  // Cd = 0.82*(t_plate/d_holes)^0.13;  //thickness plates and holes diameter
  For i in [2:x.EndNode] do
    If i<round(x2+(h_s-L1)/dx2) then  // region with solids
      If u0_umf_ratio(1)<1 then  //fixed bed --> ergun formula
        If i<=x2 then
          P_ret(i)=P_ret(i-1);//-p*dx1*1e-5*(150*(1-eps_0)^2/eps_0^3*mu_ret(i)*u_ret(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_0)/eps_0^3*C_ret(i)*MW_ret(i)*u_ret(i)^2/(d_s*fi_s));
        Else
          If i<=x3 then
            P_ret(i)=P_ret(i-1);//-p*dx2*1e-5*(150*(1-eps_0)^2/eps_0^3*mu_ret(i)*u_ret(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_0)/eps_0^3*C_ret(i)*MW_ret(i)*u_ret(i)^2/(d_s*fi_s));
          Else
            P_ret(i)=P_ret(i-1);//-p*dx3*1e-5*(150*(1-eps_0)^2/eps_0^3*mu_ret(i)*u_ret(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_0)/eps_0^3*C_ret(i)*MW_ret(i)*u_ret(i)^2/(d_s*fi_s));
          EndIf
        EndIf
      Else // fluidized bed
        If i<=x2 then
          P_ret(i)=P_ret(i-1);//
          //-p*dx1*1e-5*(1-eps_e(i))*(rho_s-C_ret(i)*MW_ret(i))
          //-p*dx1*1e-5*(150*(1-eps_mf(i))^2/eps_mf(i)^3*mu_ret(i)*u_mf(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_mf(i))/eps_mf(i)^3*C_ret(i)*MW_ret(i)*u_mf(i)^2/(d_s*fi_s));
          //-dx1*1e-5*(150*(1-eps_e(i))^2/eps_e(i)^3*mu_ret(i)*u_ret(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_e(i))/eps_e(i)^3*C_ret(i)*MW_ret(i)*u_ret(i)^2/(d_s*fi_s));
        Else
          If i<=x3 then
            P_ret(i)=P_ret(i-1);
            //-p*dx2*1e-5*(1-eps_e(i))*(rho_s-C_ret(i)*MW_ret(i))
            //-p*dx2*1e-5*(150*(1-eps_mf(i))^2/eps_mf(i)^3*mu_ret(i)*u_mf(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_mf(i))/eps_mf(i)^3*C_ret(i)*MW_ret(i)*u_mf(i)^2/(d_s*fi_s));
            //-dx2*1e-5*(150*(1-eps_e(i))^2/eps_e(i)^3*mu_ret(i)*u_ret(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_e(i))/eps_e(i)^3*C_ret(i)*MW_ret(i)*u_ret(i)^2/(d_s*fi_s));
          Else
            P_ret(i)=P_ret(i-1);
            //-p*dx3*g*1e-5*(1-eps_e(i))*(rho_s-C_ret(i)*MW_ret(i))
            //-p*dx3*1e-5*(150*(1-eps_mf(i))^2/eps_mf(i)^3*mu_ret(i)*u_mf(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_mf(i))/eps_mf(i)^3*C_ret(i)*MW_ret(i)*u_mf(i)^2/(d_s*fi_s));
            //-dx3*1e-5*(150*(1-eps_e(i))^2/eps_e(i)^3*mu_ret(i)*u_ret(i)*1e-3/(d_s*fi_s)^2 + 1.75*(1-eps_e(i))/eps_e(i)^3*C_ret(i)*MW_ret(i)*u_ret(i)^2/(d_s*fi_s));
          EndIf
        EndIf
      EndIf
    Else  //region without catalyst
      P_ret(i)=P_ret(i-1);
    EndIf  
  EndFor
  

  //------------------------
  //----- performances -----
  //------------------------
  Eq_S2EtOH:        S2EtOH      = Feed_in.z("H2O")/Feed_in.z("EtOH");
  Eq_S2EtOH_star:   S2EtOH_star = (Feed_in.F*Feed_in.z("H2O") + Feed_in.F*Feed_in.z("O2")*stoich("EtOH_ox","H2O")/abs(stoich("EtOH_ox","O2"))) / (Feed_in.F*Feed_in.z("EtOH") + Feed_in.F*Feed_in.z("O2")*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")));
  Eq_O22EtOH:       O22EtOH     = Feed_in.z("O2")/Feed_in.z("EtOH");
  Eq_WHSV_EtOH:     WHSV_EtOH   = Feed_in.F*Feed_in.z("EtOH")*MW("EtOH")/(m_s*f_cat); // (kg/h_CH4)/kg_cat
  Eq_HRF_EtOH:      HRF         = Per_out.F*Per_out.z("H2") / (Feed_in.F*Feed_in.z("EtOH")*stoich("EtOH_SR_3","H2")/abs(stoich("EtOH_SR_3","EtOH")));
  Eq_HRF_EtOH_star: HRF_star    = Per_out.F*Per_out.z("H2") / (Feed_in.F*(Feed_in.z("EtOH")+Feed_in.z("O2")*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2")))*stoich("EtOH_SR_3","H2")/abs(stoich("EtOH_SR_3","EtOH")));
  Eq_EtOH_ox:       EtOH_ox     = abs(Feed_in.F*Feed_in.z("O2")*stoich("EtOH_ox","EtOH")/abs(stoich("EtOH_ox","O2"))); //kmol/h
  Eq_Sw2EtOH:       Sw2EtOH     = Sweep_in.F/(Feed_in.F*Feed_in.z("EtOH"));
  Eq_HHV_ret:       HHV_ret     = abs(z_ret("CH4",x.EndNode)*DH0_r("CH4_ox") + z_ret("CO",x.EndNode)*DH0_r("CO_ox") + z_ret("EtOH",x.EndNode)*DH0_r("EtOH_ox") + z_ret("H2",x.EndNode)*DH0_r("H2_ox"));
  Eq_H2perm:        H2perm      = (Per_out.F*Per_out.z("H2")-Sweep_in.F*Sweep_in.z("H2"))*22.414;
  Eq_Load2surf_EtOH:   Load2surf_EtOH   = Feed_in.F*Feed_in.z("EtOH")*22.414/A_mem_tot;
  Eq_Section_fraction: Section_fraction = r_ext_support^2*N_mem/r_vessel^2;
  Eq_LMPD:             LMPD             = (((P_ret(x2i)*1e5*z_ret("H2",x2i))^0.5-(P_per(x2i)*1e5*z_per("H2",x2i))^0.5)-((P_ret(x3)*1e5*z_ret("H2",x3))^0.5-(P_per(x3)*1e5*z_per("H2",x3))^0.5))
                                          /loge(((P_ret(x2i)*1e5*z_ret("H2",x2i))^0.5-(P_per(x2i)*1e5*z_per("H2",x2i))^0.5)/((P_ret(x3)*1e5*z_ret("H2",x3))^0.5-(P_per(x3)*1e5*z_per("H2",x3))^0.5));
/*
  u0_0 = u_ret(0);
  u0_1 = u_ret(1);
  u_mf_0 = u_mf(0);
  u_mf_1 = u_mf(1);
  u0_umf_ratio_0 = u_ret(0)/u_mf(0);
  u0_umf_ratio_1 = u_ret(1)/u_mf(1);
  u0_umf_ratio_x2 = u_ret(x2)/u_mf(x2);

  
For i in [x2:x.EndNode] do
  z_H2_per(i) = z_per("H2",i);
  z_H2_interf(i) = z_interface("H2",i);
EndFor

For i in [0:x.EndNode] do
  z_H2_b(i) = z_b("H2",i);
  z_H2_e(i) = z_e("H2",i);
  z_H2_ret(i) = z_ret("H2",i);
EndFor
*/
   
  //----------------------------
  //----- thermal balances -----
  //----------------------------

For i in [1:x.EndNode] do
    If i<=x2 then
      q_loss(i) = (T_ret(i)-T_amb)/((loge((r_vessel+t_ins)/(r_vessel))/(2*pi*k_ins*1e-3*dx1))+(1/(2*pi*ht_amb*(r_vessel+t_ins)*dx1))); // kW
    Else
      If i<=x3 then
        q_loss(i) = (T_ret(i)-T_amb)/((loge((r_vessel+t_ins)/(r_vessel))/(2*pi*k_ins*1e-3*dx2))+(1/(2*pi*ht_amb*(r_vessel+t_ins)*dx2))); // kW
      Else
        q_loss(i) = (T_ret(i)-T_amb)/((loge((r_vessel+t_ins)/(r_vessel))/(2*pi*k_ins*1e-3*dx3))+(1/(2*pi*ht_amb*(r_vessel+t_ins)*dx3))); // kW
      EndIf
    EndIf        
  EndFor
  
  q_loss(0) = 0;
  Q_loss_tot = sigma(q_loss) + 2*((T_ret(x.EndNode)-T_amb)/(t_ins/(k_ins*1e-3*pi*(r_vessel+t_ins)^2)+1/(ht_amb*pi*(r_vessel+t_ins)^2))) ;
  Eq_T_wall: q_loss(1) = (T_ret(1)-T_wall)/((loge((r_vessel+t_ins)/(r_vessel))/(2*pi*k_ins*1e-3*dx1)));
      
  If Thermal=="T_constant_no_thermal_balance" then
    T_reactor: fixed;
  Else  // thermal_balance active
    //global thermal balance  --> simplified approach to compute  T_per(uniform)
    Feed_in.F*Feed_in.h + Sweep_in.F*Sweep_in.h - Ret_out.F*Ret_out.h - Per_out.F*Per_out.h - Q_loss_tot*1e-6*3600 = 0;  //GJ/h
    T_reactor:free;
  EndIf
  For i in [1:x.EndNode] do      
      T_ret(i) = T_reactor;
    EndFor
    For i in [x2:x.EndNode-1] do
      T_per(i) = T_reactor;
    EndFor
    For i in [x2:x.EndNode] do
      T_per_p(i) = T_reactor;
    EndFor

End
//UNCOMPILED SECTION END

//SYSTEM SECTION END
End
SystemData : Text
globaldatasection
EndText;
SystemData : Text
<FORMLIST DEFAULTFORM="AllGlobals">
  <FORM NAME="AllGlobals" CLSID="{6BA76840-806B-11D0-BE51-0000C09984EF}">
    { Version : 1
SizeX : 5250
SizeY : 3750
ShowAllVariables : True
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ ]
AttributesPaths : [ ]
ColumnWidths : [ ]
}
  </FORM>
</FORMLIST>
EndText;

FLOWSHEET
  B1 as Tubular_membranes;

CONSTRAINTS
  // Flowsheet variables and equations...
END

//SYSTEM SECTION - WARNING: DO NOT EDIT
SystemData : Text
<FORMLIST DEFAULTFORM="AllVariables">
  <FORM NAME="Solids" MODEL="B1">
    { Version : 1
SizeX : 7665
SizeY : 3750
ShowAllVariables : False
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ m_s d_s sph_s rho_s rho_s_loose eps_0 f_cat f_fil x_s_0 x_s ]
AttributesPaths : [ Value Spec Units Description ]
ColumnWidths : [ 3090 2205 1215 1845 1845 ]
}  </FORM>
  <FORM NAME="Streams" MODEL="B1">
    { Version : 1
SizeX : 11655
SizeY : 13500
ShowAllVariables : False
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ Feed_in.F Feed_in.T Feed_in.P Feed_in.z(*) Feed_in.h Feed_in.V Ret_out.F Ret_out.T Ret_out.P Ret_out.z(*) Ret_out.h Ret_out.V Sweep_in.F Sweep_in.T Sweep_in.P Sweep_in.z(*) Sweep_in.h Sweep_in.V Per_out.F Per_out.T Per_out.P Per_out.z(*) Per_out.h Per_out.V ]
AttributesPaths : [ Value Spec Units Description ]
ColumnWidths : [ 3090 2205 1215 1845 1845 ]
}  </FORM>
  <FORM NAME="Performances" MODEL="B1">
    { Version : 1
SizeX : 9645
SizeY : 7815
ShowAllVariables : False
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ u0_umf_ratio_min u0_umf_ratio_max WHSV_M S2M S2M_star O22M CH4_ox WHSV_EtOH S2EtOH S2EtOH_star O22EtOH EtOH_ox HRF HRF_star HHV_ret Q_loss_tot ]
AttributesPaths : [ Value Spec Units Description ]
ColumnWidths : [ 3090 2205 1215 1845 1845 ]
}  </FORM>
  <FORM NAME="P_e" MODEL="B1">
    { Version : 2
SizeX : 18915
SizeY : 9060
Plot3d: 0
YAxisIsTime: 1
MaxIntervals: 3
PhasePlot: 0
PhaseXVariable: -
XProfileName: -
YProfileName: -
VariablesPaths : [ 10 P_CH4_e(*) 10 P_CO2_e(*) 9 P_CO_e(*) 11 P_EtOH_e(*) 9 P_H2_e(*) 10 P_H2O_e(*) 9 P_N2_e(*) 9 P_O2_e(*) ]
HistoryVariablesPaths : [ ]
Times : [ L ]
ProfileNames : [ 8 New¬Profile
New¬Profilea
New¬Profileb
New¬Profilec
New¬Profiled
New¬Profilee
New¬Profilef
New¬Profileg]
NoVars : [ 1 1 1 1 1 1 1 1 ]
UnusedVariablesPaths : [ ]
UnusedProfileDimensions : [ ]
PlotInputFile : { 
Type:0
Title:P_e
Xlab:Index
Ylab:Y Label
Nvars:8
MultiY:0
Subst:UOM
NYaxes:1
RunPlot:0
PhasePlot:0
SizeToData:0
CommunicationIntervals:1
UseVar:0
IgnoreLegend:0
TimeWin:1
TimeScroll:0.2
AlwaysShow:0
PhaseX:
Var:0
AxisMap:0
Label:Index
SubstValue:
Var:1
AxisMap:1
Label:Y Label
Legend:New Profile $UOM
SubstValue:bar
Var:2
AxisMap:1
Label:
Legend:New Profilea $UOM
SubstValue:bar
Var:3
AxisMap:1
Label:
Legend:New Profileb $UOM
SubstValue:bar
Var:4
AxisMap:1
Label:
Legend:New Profilec $UOM
SubstValue:bar
Var:5
AxisMap:1
Label:
Legend:New Profiled $UOM
SubstValue:bar
Var:6
AxisMap:1
Label:
Legend:New Profilee $UOM
SubstValue:bar
Var:7
AxisMap:1
Label:
Legend:New Profilef $UOM
SubstValue:bar
Var:8
AxisMap:1
Label:
Legend:New Profileg $UOM
SubstValue:bar
Axis:0
Range:1 25
AxisInterval:2 0
AxisRange:0 26
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:1
Range:-5.09603e-007 8.51601e-006
AxisInterval:5e-007 0
AxisRange:-5.09603e-007 8.51601e-006
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Attrib:0 4 1 1
Attrib2:0 0 0 0 0
Attrib:1 4 2 2
Attrib2:1 0 0 0 0
Attrib:2 4 3 3
Attrib2:2 0 0 0 0
Attrib:3 4 4 4
Attrib2:3 0 0 0 0
Attrib:4 4 5 5
Attrib2:4 0 0 0 0
Attrib:5 4 6 6
Attrib2:5 0 0 0 0
Attrib:6 4 7 1
Attrib2:6 0 0 0 0
Attrib:7 4 8 2
Attrib2:7 0 0 0 0
Font:0 10 0:Arial
Font:1 10 0:Arial
Font:2 10 0:Arial
Font:3 10 0:Arial
Grid:0
Line:2
Square:0 0 0 0
Marker:4 1
LegendBox:0 1.136450 0.030000
LegendBox2:90 1.250000 5 } 
DisplayAs : Plot
ColumnWidths : [ ]
ProfileDimensions : [ 1 1 1 1 1 1 1 1 ]
}  </FORM>
  <FORM NAME="P_b" MODEL="B1">
    { Version : 2
SizeX : 19545
SizeY : 7785
Plot3d: 0
YAxisIsTime: 1
MaxIntervals: 3
PhasePlot: 0
PhaseXVariable: -
XProfileName: -
YProfileName: -
VariablesPaths : [ 10 P_CH4_b(*) 10 P_CO2_b(*) 9 P_CO_b(*) 11 P_EtOH_b(*) 9 P_H2_b(*) 10 P_H2O_b(*) 9 P_N2_b(*) 9 P_O2_b(*) ]
HistoryVariablesPaths : [ ]
Times : [ L ]
ProfileNames : [ 8 New¬Profile
New¬Profilea
New¬Profileb
New¬Profilec
New¬Profiled
New¬Profilee
New¬Profilef
New¬Profileg]
NoVars : [ 1 1 1 1 1 1 1 1 ]
UnusedVariablesPaths : [ ]
UnusedProfileDimensions : [ ]
PlotInputFile : { 
Type:0
Title:P_b
Xlab:Index
Ylab:Y Label
Nvars:8
MultiY:0
Subst:UOM
NYaxes:1
RunPlot:0
PhasePlot:0
SizeToData:0
CommunicationIntervals:1
UseVar:0
IgnoreLegend:0
TimeWin:1
TimeScroll:0.2
AlwaysShow:0
PhaseX:
Var:0
AxisMap:0
Label:Index
SubstValue:
Var:1
AxisMap:1
Label:Y Label
Legend:New Profile $UOM
SubstValue:bar
Var:2
AxisMap:1
Label:
Legend:New Profilea $UOM
SubstValue:bar
Var:3
AxisMap:1
Label:
Legend:New Profileb $UOM
SubstValue:bar
Var:4
AxisMap:1
Label:
Legend:New Profilec $UOM
SubstValue:bar
Var:5
AxisMap:1
Label:
Legend:New Profiled $UOM
SubstValue:bar
Var:6
AxisMap:1
Label:
Legend:New Profilee $UOM
SubstValue:bar
Var:7
AxisMap:1
Label:
Legend:New Profilef $UOM
SubstValue:bar
Var:8
AxisMap:1
Label:
Legend:New Profileg $UOM
SubstValue:bar
Axis:0
Range:1 25
AxisInterval:2 0
AxisRange:0 26
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:1
Range:1e-030 6.16635e-005
AxisInterval:5e-006 0
AxisRange:0 6.5e-005
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Attrib:0 4 1 1
Attrib2:0 0 0 0 0
Attrib:1 4 2 2
Attrib2:1 0 0 0 0
Attrib:2 4 3 3
Attrib2:2 0 0 0 0
Attrib:3 4 4 4
Attrib2:3 0 0 0 0
Attrib:4 4 5 5
Attrib2:4 0 0 0 0
Attrib:5 4 6 6
Attrib2:5 0 0 0 0
Attrib:6 4 7 1
Attrib2:6 0 0 0 0
Attrib:7 4 8 2
Attrib2:7 0 0 0 0
Font:0 10 0:Arial
Font:1 10 0:Arial
Font:2 10 0:Arial
Font:3 10 0:Arial
Grid:0
Line:2
Square:0 0 0 0
Marker:4 1
LegendBox:0 1.000000 0.030000
LegendBox2:90 1.250000 5 } 
DisplayAs : Plot
ColumnWidths : [ ]
ProfileDimensions : [ 1 1 1 1 1 1 1 1 ]
}  </FORM>
  <FORM NAME="reactions" MODEL="B1">
    { Version : 2
SizeX : 18195
SizeY : 10590
Plot3d: 0
YAxisIsTime: 1
MaxIntervals: 3
PhasePlot: 0
PhaseXVariable: -
XProfileName: -
YProfileName: -
VariablesPaths : [ 8 r_MSR(*) 8 r_WGS(*) ]
HistoryVariablesPaths : [ ]
Times : [ L ]
ProfileNames : [ 2 New¬Profile
New¬Profilea]
NoVars : [ 1 1 ]
UnusedVariablesPaths : [ ]
UnusedProfileDimensions : [ ]
PlotInputFile : { 
Type:0
Title:reactions
Xlab:Index
Ylab:Y Label
Nvars:2
MultiY:0
Subst:UOM
NYaxes:1
RunPlot:0
PhasePlot:0
SizeToData:0
CommunicationIntervals:1
UseVar:0
IgnoreLegend:0
TimeWin:1
TimeScroll:0.2
AlwaysShow:0
PhaseX:
Var:0
AxisMap:0
Label:Index
SubstValue:
Var:1
AxisMap:1
Label:Y Label
Legend:New Profile $UOM
SubstValue:
Var:2
AxisMap:1
Label:
Legend:New Profilea $UOM
SubstValue:
Axis:0
Range:1 25
AxisInterval:2 0
AxisRange:0 26
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Axis:1
Range:-4.5003e-006 3.5005e-006
AxisInterval:5e-007 0
AxisRange:-4.5003e-006 3.5005e-006
AxisResetRange:1
AxisScale:0 0
Multiplier:0
MultiplierType:0
AxisFlag:0
Attrib:0 4 1 1
Attrib2:0 0 0 0 0
Attrib:1 4 2 2
Attrib2:1 0 0 0 0
Font:0 10 0:Arial
Font:1 10 0:Arial
Font:2 10 0:Arial
Font:3 10 0:Arial
Grid:0
Line:2
Square:0 0 0 0
Marker:4 1
LegendBox:0 1.000000 0.030000
LegendBox2:90 1.250000 5 } 
DisplayAs : Plot
ColumnWidths : [ ]
ProfileDimensions : [ 1 1 ]
}  </FORM>
  <FORM NAME="Geometry" MODEL="B1">
    { Version : 1
SizeX : 9225
SizeY : 10005
ShowAllVariables : False
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ L1 L2 L3 Ltot N_mem A_mem_tot dx1 dx2 dx3 dV1_vessel dV2_vessel dV3_vessel dV2_annulus dV3_annulus dV2_pipe dV3_pipe dA_mem r_ext_support r_int_support t_support t_annulus t_ins t_mem t_pipe t_vessel r_ext_pipe r_int_pipe r_vessel S1_vessel S2_vessel S_annulus S_int_pipe ]
AttributesPaths : [ Value Spec Units Description ]
ColumnWidths : [ 3090 2205 1215 1845 1845 ]
}  </FORM>
  <FORM NAME="u" MODEL="B1">
    { Version : 1
SizeX : 9180
SizeY : 3750
ShowAllVariables : False
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ u0_0 u0_1 u_mf_0 u_mf_1 u0_umf_ratio_0 u0_umf_ratio_1 u0_umf_ratio_x2 u0_umf_ratio_max u0_umf_ratio_min ]
AttributesPaths : [ Value Spec Units Description ]
ColumnWidths : [ 3090 2205 1215 1845 1845 ]
}  </FORM>
  <FORM NAME="z_H2" MODEL="B1">
    { Version : 1
SizeX : 7590
SizeY : 11070
ShowAllVariables : False
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ z_H2_b(*) z_H2_e(*) z_H2_interf(*) z_H2_per(*) z_H2_ret(*) ]
AttributesPaths : [ Value Spec Units Description ]
ColumnWidths : [ 3090 2205 1215 1845 1845 ]
}  </FORM>
  <FORM NAME="AllVariables" MODEL="B1">
    { Version : 1
SizeX : 11460
SizeY : 9765
ShowAllVariables : True
ShowAllAttributes : False
ExpandAll : True
ShowRegistryAttributes : True
VariablesPaths : [ ]
AttributesPaths : [ ]
ColumnWidths : [ ]
}  </FORM>
</FORMLIST>
EndText;

//SYSTEM SECTION END
  ActiveTasks : [];
  B1.A_mem_tot : 0.5275200000000001;
  B1.Ar(0) : 90.1944093298505;
  B1.Ar(1) : 36.983417099336;
  B1.Ar(10) : 37.31620034121215;
  B1.Ar(11) : 38.32631449174589;
  B1.Ar(12) : 39.19947574592216;
  B1.Ar(13) : 39.97043382447301;
  B1.Ar(14) : 40.64405799220024;
  B1.Ar(15) : 41.21805722736374;
  B1.Ar(16) : 41.69289178547081;
  B1.Ar(17) : 42.07435195844028;
  B1.Ar(18) : 42.37276684582142;
  B1.Ar(19) : 42.60099172568741;
  B1.Ar(2) : 36.70491254027928;
  B1.Ar(20) : 42.53713800463606;
  B1.Ar(21) : 42.64255595756155;
  B1.Ar(22) : 42.64255595756156;
  B1.Ar(23) : 42.64255595756156;
  B1.Ar(24) : 42.64255595756157;
  B1.Ar(25) : 42.64255595756156;
  B1.Ar(3) : 36.49479296415861;
  B1.Ar(4) : 36.34063175148304;
  B1.Ar(5) : 36.22646737280491;
  B1.Ar(6) : 36.13948403649816;
  B1.Ar(7) : 36.07145909101625;
  B1.Ar(8) : 36.01718951839021;
  B1.Ar(9) : 35.97325080193137;
  B1.C_per(10) : 4.667103953564431e-003;
  B1.C_per(11) : 4.667103953564431e-003;
  B1.C_per(12) : 4.667103953564431e-003;
  B1.C_per(13) : 4.667103953564431e-003;
  B1.C_per(14) : 4.667103953564431e-003;
  B1.C_per(15) : 4.667103953564431e-003;
  B1.C_per(16) : 4.667103953564431e-003;
  B1.C_per(17) : 4.667103953564431e-003;
  B1.C_per(18) : 4.667103953564431e-003;
  B1.C_per(19) : 4.667103953564431e-003;
  B1.C_per(20) : 4.667103953564431e-003;
  B1.C_per(21) : 4.667103953564431e-003;
  B1.C_per(22) : 4.667103953564431e-003;
  B1.C_per(23) : 4.667103953564431e-003;
  B1.C_per(24) : 4.667103953564431e-003;
  B1.C_per(25) : 4.667103953564431e-003;
  B1.C_per_p(10) : 4.667103953564431e-003;
  B1.C_per_p(11) : 4.667103953564431e-003;
  B1.C_per_p(12) : 4.667103953564431e-003;
  B1.C_per_p(13) : 4.667103953564431e-003;
  B1.C_per_p(14) : 4.667103953564431e-003;
  B1.C_per_p(15) : 4.667103953564431e-003;
  B1.C_per_p(16) : 4.667103953564431e-003;
  B1.C_per_p(17) : 4.667103953564431e-003;
  B1.C_per_p(18) : 4.667103953564431e-003;
  B1.C_per_p(19) : 4.667103953564431e-003;
  B1.C_per_p(20) : 4.667103953564431e-003;
  B1.C_per_p(21) : 4.667103953564431e-003;
  B1.C_per_p(22) : 4.667103953564431e-003;
  B1.C_per_p(23) : 4.667103953564431e-003;
  B1.C_per_p(24) : 4.667103953564431e-003;
  B1.C_per_p(25) : 4.667103953564431e-003;
  B1.C_ret(0) : 0.1199189169076237;
  B1.C_ret(1) : 9.334207907128862e-002;
  B1.C_ret(10) : 9.334207907128862e-002;
  B1.C_ret(11) : 9.334207907128862e-002;
  B1.C_ret(12) : 9.334207907128862e-002;
  B1.C_ret(13) : 9.334207907128862e-002;
  B1.C_ret(14) : 9.334207907128862e-002;
  B1.C_ret(15) : 9.334207907128862e-002;
  B1.C_ret(16) : 9.334207907128862e-002;
  B1.C_ret(17) : 9.334207907128862e-002;
  B1.C_ret(18) : 9.334207907128862e-002;
  B1.C_ret(19) : 9.334207907128862e-002;
  B1.C_ret(2) : 9.334207907128862e-002;
  B1.C_ret(20) : 9.334207907128862e-002;
  B1.C_ret(21) : 9.334207907128862e-002;
  B1.C_ret(22) : 9.334207907128862e-002;
  B1.C_ret(23) : 9.334207907128862e-002;
  B1.C_ret(24) : 9.334207907128862e-002;
  B1.C_ret(25) : 9.334207907128862e-002;
  B1.C_ret(3) : 9.334207907128862e-002;
  B1.C_ret(4) : 9.334207907128862e-002;
  B1.C_ret(5) : 9.334207907128862e-002;
  B1.C_ret(6) : 9.334207907128862e-002;
  B1.C_ret(7) : 9.334207907128862e-002;
  B1.C_ret(8) : 9.334207907128862e-002;
  B1.C_ret(9) : 9.334207907128862e-002;
  B1.check_energy_bal : 2.78820228072435e-004;
  B1.check_mass_bal : -1.138087935004251e-008;
  B1.cp_per(10) : 29.51267931054406;
  B1.cp_per(11) : 29.51267931054406;
  B1.cp_per(12) : 29.51267931054406;
  B1.cp_per(13) : 29.51267931054406;
  B1.cp_per(14) : 29.51267931054406;
  B1.cp_per(15) : 29.51267931054406;
  B1.cp_per(16) : 29.51267931054406;
  B1.cp_per(17) : 29.51267931054406;
  B1.cp_per(18) : 29.51267931054406;
  B1.cp_per(19) : 29.51267931054406;
  B1.cp_per(20) : 29.51267931054406;
  B1.cp_per(21) : 29.51267931054406;
  B1.cp_per(22) : 29.51267931054406;
  B1.cp_per(23) : 29.51267931054406;
  B1.cp_per(24) : 29.51267931054406;
  B1.cp_per(25) : 29.51267931054406;
  B1.cv_per(10) : 21.19003498054376;
  B1.cv_per(11) : 21.19003498054376;
  B1.cv_per(12) : 21.19003498054376;
  B1.cv_per(13) : 21.19003498054376;
  B1.cv_per(14) : 21.19003498054376;
  B1.cv_per(15) : 21.19003498054376;
  B1.cv_per(16) : 21.19003498054376;
  B1.cv_per(17) : 21.19003498054376;
  B1.cv_per(18) : 21.19003498054376;
  B1.cv_per(19) : 21.19003498054376;
  B1.cv_per(20) : 21.19003498054376;
  B1.cv_per(21) : 21.19003498054376;
  B1.cv_per(22) : 21.19003498054376;
  B1.cv_per(23) : 21.19003498054376;
  B1.cv_per(24) : 21.19003498054376;
  B1.cv_per(25) : 21.19003498054376;
  B1.cv_ret(0) : 35.7716292023474;
  B1.cv_ret(1) : 32.31987193420465;
  B1.cv_ret(10) : 31.66144804848921;
  B1.cv_ret(11) : 31.62125594151786;
  B1.cv_ret(12) : 31.55019947231927;
  B1.cv_ret(13) : 31.47528320674127;
  B1.cv_ret(14) : 31.4059595518187;
  B1.cv_ret(15) : 31.34478613533375;
  B1.cv_ret(16) : 31.29172311873603;
  B1.cv_ret(17) : 31.24578087529405;
  B1.cv_ret(18) : 31.20573432895642;
  B1.cv_ret(19) : 31.1704676566766;
  B1.cv_ret(2) : 32.17293045808021;
  B1.cv_ret(20) : 31.10550827236396;
  B1.cv_ret(21) : 31.18433987509884;
  B1.cv_ret(22) : 31.18433987509884;
  B1.cv_ret(23) : 31.18433987509884;
  B1.cv_ret(24) : 31.18433987509884;
  B1.cv_ret(25) : 31.18433987509884;
  B1.cv_ret(3) : 32.03077505478691;
  B1.cv_ret(4) : 31.90944301111707;
  B1.cv_ret(5) : 31.80955999984995;
  B1.cv_ret(6) : 31.72703321030916;
  B1.cv_ret(7) : 31.65817948271555;
  B1.cv_ret(8) : 31.60021167164951;
  B1.cv_ret(9) : 31.55103417832691;
  B1.d_b(0).Record : True;
  B1.d_b(0) : 9.371946519398655e-007;
  B1.d_b(1).Record : True;
  B1.d_b(1) : 2.141658662149073e-003;
  B1.d_b(10).Record : True;
  B1.d_b(10) : 9.003487430949397e-003;
  B1.d_b(11).Record : True;
  B1.d_b(11) : 8.666813086291228e-003;
  B1.d_b(12).Record : True;
  B1.d_b(12) : 8.445861933226273e-003;
  B1.d_b(13).Record : True;
  B1.d_b(13) : 8.286701320953901e-003;
  B1.d_b(14).Record : True;
  B1.d_b(14) : 8.165734397606653e-003;
  B1.d_b(15).Record : True;
  B1.d_b(15) : 8.0719004891984e-003;
  B1.d_b(16).Record : True;
  B1.d_b(16) : 7.99908706571734e-003;
  B1.d_b(17).Record : True;
  B1.d_b(17) : 7.943104209804862e-003;
  B1.d_b(18).Record : True;
  B1.d_b(18) : 7.90059159853407e-003;
  B1.d_b(19).Record : True;
  B1.d_b(19) : 7.868694518206928e-003;
  B1.d_b(2).Record : True;
  B1.d_b(2) : 4.226482721119077e-003;
  B1.d_b(20).Record : True;
  B1.d_b(20) : 7.882774599467483e-003;
  B1.d_b(21).Record : True;
  B1.d_b(21) : 7.868466632734997e-003;
  B1.d_b(22).Record : True;
  B1.d_b(22) : 7.86722677967658e-003;
  B1.d_b(23).Record : True;
  B1.d_b(23) : 7.86701034395511e-003;
  B1.d_b(24).Record : True;
  B1.d_b(24) : 7.866972561718569e-003;
  B1.d_b(25).Record : True;
  B1.d_b(25) : 7.866965966238914e-003;
  B1.d_b(3).Record : True;
  B1.d_b(3) : 6.251401267034359e-003;
  B1.d_b(4).Record : True;
  B1.d_b(4) : 8.214745317431566e-003;
  B1.d_b(5).Record : True;
  B1.d_b(5) : 1.011651995421924e-002;
  B1.d_b(6).Record : True;
  B1.d_b(6) : 1.195774709387269e-002;
  B1.d_b(7).Record : True;
  B1.d_b(7) : 1.373984598867308e-002;
  B1.d_b(8).Record : True;
  B1.d_b(8) : 1.546438768862513e-002;
  B1.d_b(9).Record : True;
  B1.d_b(9) : 1.713300206308924e-002;
  B1.d_b01 : 9.371946519366002e-007;
  B1.d_bmax(0) : 5.244517934828481e-002;
  B1.d_bmax(1) : 6.529888829171908e-002;
  B1.d_bmax(10) : 8.74796900457693e-003;
  B1.d_bmax(11) : 8.55763142298172e-003;
  B1.d_bmax(12) : 8.399402980132109e-003;
  B1.d_bmax(13) : 8.26699599819066e-003;
  B1.d_bmax(14) : 8.157399533905686e-003;
  B1.d_bmax(15) : 8.068383558729492e-003;
  B1.d_bmax(16) : 7.997606181908987e-003;
  B1.d_bmax(17) : 7.942481747476192e-003;
  B1.d_bmax(18) : 7.900330334439258e-003;
  B1.d_bmax(19) : 7.868584983993282e-003;
  B1.d_bmax(2) : 6.552036636909385e-002;
  B1.d_bmax(20) : 7.874176731310943e-003;
  B1.d_bmax(21) : 7.866964571404816e-003;
  B1.d_bmax(22) : 7.866964571404815e-003;
  B1.d_bmax(23) : 7.866964571404815e-003;
  B1.d_bmax(24) : 7.866964571404815e-003;
  B1.d_bmax(25) : 7.866964571404815e-003;
  B1.d_bmax(3) : 6.568288847613688e-002;
  B1.d_bmax(4) : 6.580263968168391e-002;
  B1.d_bmax(5) : 6.589265433620836e-002;
  B1.d_bmax(6) : 6.59625390783105e-002;
  B1.d_bmax(7) : 6.601833263314587e-002;
  B1.d_bmax(8) : 6.606382744773583e-002;
  B1.d_bmax(9) : 6.610151306653324e-002;
  B1.d_vessel : 0.18;
  B1.dA_mem : 1.256e-003;
  B1.delta_b(0).Record : True;
  B1.delta_b(0) : 0.;
  B1.delta_b(1).Record : True;
  B1.delta_b(1) : 0.241859543784408;
  B1.delta_b(10).Record : True;
  B1.delta_b(10) : 0.1461511113094487;
  B1.delta_b(11).Record : True;
  B1.delta_b(11) : 0.1417524458992034;
  B1.delta_b(12).Record : True;
  B1.delta_b(12) : 0.1377127844920556;
  B1.delta_b(13).Record : True;
  B1.delta_b(13) : 0.1341746528820604;
  B1.delta_b(14).Record : True;
  B1.delta_b(14) : 0.1311888348423399;
  B1.delta_b(15).Record : True;
  B1.delta_b(15) : 0.1287463128690572;
  B1.delta_b(16).Record : True;
  B1.delta_b(16) : 0.126800918292711;
  B1.delta_b(17).Record : True;
  B1.delta_b(17) : 0.1252865694434315;
  B1.delta_b(18).Record : True;
  B1.delta_b(18) : 0.1241301120954161;
  B1.delta_b(19).Record : True;
  B1.delta_b(19) : 0.1232603822025757;
  B1.delta_b(2).Record : True;
  B1.delta_b(2) : 0.184393461518357;
  B1.delta_b(20).Record : True;
  B1.delta_b(20) : 0.1233536599077142;
  B1.delta_b(21).Record : True;
  B1.delta_b(21) : 0.1232070236638676;
  B1.delta_b(22).Record : True;
  B1.delta_b(22) : 0.1232157232173634;
  B1.delta_b(23).Record : True;
  B1.delta_b(23) : 0.1232172420565722;
  B1.delta_b(24).Record : True;
  B1.delta_b(24) : 0.1232175071996656;
  B1.delta_b(25).Record : True;
  B1.delta_b(25) : 0.1232175534847171;
  B1.delta_b(3).Record : True;
  B1.delta_b(3) : 0.1568297729776544;
  B1.delta_b(4).Record : True;
  B1.delta_b(4) : 0.1397555062656449;
  B1.delta_b(5).Record : True;
  B1.delta_b(5) : 0.127833577325017;
  B1.delta_b(6).Record : True;
  B1.delta_b(6) : 0.1189061280853701;
  B1.delta_b(7).Record : True;
  B1.delta_b(7) : 0.1119054309519696;
  B1.delta_b(8).Record : True;
  B1.delta_b(8) : 0.106232457129411;
  B1.delta_b(9).Record : True;
  B1.delta_b(9) : 0.1015209561453434;
  B1.delta_e(0) : 1.;
  B1.delta_e(1) : 0.758140456215592;
  B1.delta_e(10) : 0.8538488886905512;
  B1.delta_e(11) : 0.8582475541007966;
  B1.delta_e(12) : 0.8622872155079444;
  B1.delta_e(13) : 0.8658253471179395;
  B1.delta_e(14) : 0.8688111651576601;
  B1.delta_e(15) : 0.8712536871309428;
  B1.delta_e(16) : 0.8731990817072891;
  B1.delta_e(17) : 0.8747134305565685;
  B1.delta_e(18) : 0.875869887904584;
  B1.delta_e(19) : 0.8767396177974243;
  B1.delta_e(2) : 0.815606538481643;
  B1.delta_e(20) : 0.8766463400922858;
  B1.delta_e(21) : 0.8767929763361324;
  B1.delta_e(22) : 0.8767842767826366;
  B1.delta_e(23) : 0.8767827579434278;
  B1.delta_e(24) : 0.8767824928003344;
  B1.delta_e(25) : 0.8767824465152829;
  B1.delta_e(3) : 0.8431702270223456;
  B1.delta_e(4) : 0.8602444937343552;
  B1.delta_e(5) : 0.8721664226749829;
  B1.delta_e(6) : 0.88109387191463;
  B1.delta_e(7) : 0.8880945690480304;
  B1.delta_e(8) : 0.8937675428705889;
  B1.delta_e(9) : 0.8984790438546566;
  B1.DH0("CH4") : -7.452000021776599e-002;
  B1.DH0("CO") : -0.1105300001778426;
  B1.DH0("CO2") : -0.393510000227315;
  B1.DH0("ETOH") : -0.2349500003973844;
  B1.DH0("H2") : -1.756315305829048e-010;
  B1.DH0("H2O") : -0.241818000204944;
  B1.DH0("N2") : -1.777707859873772e-010;
  B1.DH0("O2") : -1.791187673807144e-010;
  B1.DH0_r("CH4_ox") : -0.8026260000611996;
  B1.DH0_r("CO_ox") : -0.2829799999599131;
  B1.DH0_r("EtOH_dec") : 4.98999998261443e-002;
  B1.DH0_r("EtOH_ox") : -1.277524000134721;
  B1.DH0_r("EtOH_SR") : 0.2557079993684857;
  B1.DH0_r("EtOH_SR_2") : 8.737999805984359e-003;
  B1.DH0_r("EtOH_SR_3") : 0.1733839995037974;
  B1.DH0_r("H2_ox") : -0.2418179999397531;
  B1.DH0_r("MSR") : 0.2058079997179728;
  B1.DH0_r("MSR_2") : 0.1646459996978129;
  B1.DH0_r("WGS") : -4.116200002015991e-002;
  B1.Diff_eff("CH4",1) : 0.2317368140823738;
  B1.Diff_eff("CH4",10) : 0.2315208150753572;
  B1.Diff_eff("CH4",11) : 0.2270230792828894;
  B1.Diff_eff("CH4",12) : 0.2234810380104033;
  B1.Diff_eff("CH4",13) : 0.2205983672740873;
  B1.Diff_eff("CH4",14) : 0.2182432205866249;
  B1.Diff_eff("CH4",15) : 0.2163430230038203;
  B1.Diff_eff("CH4",16) : 0.2148388690377093;
  B1.Diff_eff("CH4",17) : 0.2136725724371564;
  B1.Diff_eff("CH4",18) : 0.2127859810472658;
  B1.Diff_eff("CH4",19) : 0.2121238725072937;
  B1.Diff_eff("CH4",2) : 0.2339488700531152;
  B1.Diff_eff("CH4",20) : 0.2123461161728259;
  B1.Diff_eff("CH4",21) : 0.2120907081291719;
  B1.Diff_eff("CH4",22) : 0.2120907081291719;
  B1.Diff_eff("CH4",23) : 0.212090708129172;
  B1.Diff_eff("CH4",24) : 0.2120907081291719;
  B1.Diff_eff("CH4",25) : 0.2120907081291719;
  B1.Diff_eff("CH4",3) : 0.2353434956183193;
  B1.Diff_eff("CH4",4) : 0.2362830083655184;
  B1.Diff_eff("CH4",5) : 0.2369499432625402;
  B1.Diff_eff("CH4",6) : 0.2374475236627348;
  B1.Diff_eff("CH4",7) : 0.2378336783208815;
  B1.Diff_eff("CH4",8) : 0.2381422199816214;
  B1.Diff_eff("CH4",9) : 0.2383940721324095;
  B1.Diff_eff("CO",1) : 0.2159948187505159;
  B1.Diff_eff("CO",10) : 0.2150884302508481;
  B1.Diff_eff("CO",11) : 0.2109558355469481;
  B1.Diff_eff("CO",12) : 0.2075917338366227;
  B1.Diff_eff("CO",13) : 0.204771907143718;
  B1.Diff_eff("CO",14) : 0.2024133238937118;
  B1.Diff_eff("CO",15) : 0.2004756467130974;
  B1.Diff_eff("CO",16) : 0.1989208062110914;
  B1.Diff_eff("CO",17) : 0.1977030085879925;
  B1.Diff_eff("CO",18) : 0.1967704361239327;
  B1.Diff_eff("CO",19) : 0.1960702507941219;
  B1.Diff_eff("CO",2) : 0.2175791210292287;
  B1.Diff_eff("CO",20) : 0.1962982396621747;
  B1.Diff_eff("CO",21) : 0.1960290041707462;
  B1.Diff_eff("CO",22) : 0.1960290041707463;
  B1.Diff_eff("CO",23) : 0.1960290041707462;
  B1.Diff_eff("CO",24) : 0.1960290041707463;
  B1.Diff_eff("CO",25) : 0.1960290041707463;
  B1.Diff_eff("CO",3) : 0.2186550650581833;
  B1.Diff_eff("CO",4) : 0.2194030161444646;
  B1.Diff_eff("CO",5) : 0.219941497110139;
  B1.Diff_eff("CO",6) : 0.2203462869805543;
  B1.Diff_eff("CO",7) : 0.2206620122062921;
  B1.Diff_eff("CO",8) : 0.2209153128991266;
  B1.Diff_eff("CO",9) : 0.2211228619968284;
  B1.Diff_eff("CO2",1) : 0.181079038476209;
  B1.Diff_eff("CO2",10) : 0.186406299162617;
  B1.Diff_eff("CO2",11) : 0.1845381238910565;
  B1.Diff_eff("CO2",12) : 0.1832221461310854;
  B1.Diff_eff("CO2",13) : 0.182194617834159;
  B1.Diff_eff("CO2",14) : 0.1813520083964813;
  B1.Diff_eff("CO2",15) : 0.1806626208165185;
  B1.Diff_eff("CO2",16) : 0.180115409951569;
  B1.Diff_eff("CO2",17) : 0.1797002871401964;
  B1.Diff_eff("CO2",18) : 0.1794026981942879;
  B1.Diff_eff("CO2",19) : 0.1792041791370656;
  B1.Diff_eff("CO2",2) : 0.1843590644744644;
  B1.Diff_eff("CO2",20) : 0.1796653462854019;
  B1.Diff_eff("CO2",21) : 0.1793324274144257;
  B1.Diff_eff("CO2",22) : 0.1793324274144258;
  B1.Diff_eff("CO2",23) : 0.1793324274144257;
  B1.Diff_eff("CO2",24) : 0.1793324274144258;
  B1.Diff_eff("CO2",25) : 0.1793324274144258;
  B1.Diff_eff("CO2",3) : 0.1863468734873177;
  B1.Diff_eff("CO2",4) : 0.1876686575942853;
  B1.Diff_eff("CO2",5) : 0.1886070487840325;
  B1.Diff_eff("CO2",6) : 0.1893113733438296;
  B1.Diff_eff("CO2",7) : 0.1898630008340545;
  B1.Diff_eff("CO2",8) : 0.1903086614862203;
  B1.Diff_eff("CO2",9) : 0.1906769507155083;
  B1.Diff_eff("ETOH",1) : 0.1313452060788576;
  B1.Diff_eff("ETOH",10) : 0.1297288734762349;
  B1.Diff_eff("ETOH",11) : 0.1271391872744913;
  B1.Diff_eff("ETOH",12) : 0.1250370513373981;
  B1.Diff_eff("ETOH",13) : 0.1232741968676872;
  B1.Diff_eff("ETOH",14) : 0.1217937168501275;
  B1.Diff_eff("ETOH",15) : 0.1205688575904519;
  B1.Diff_eff("ETOH",16) : 0.1195761644722503;
  B1.Diff_eff("ETOH",17) : 0.1187882914224224;
  B1.Diff_eff("ETOH",18) : 0.1181744893320037;
  B1.Diff_eff("ETOH",19) : 0.1177033780995833;
  B1.Diff_eff("ETOH",2) : 0.1323288931389857;
  B1.Diff_eff("ETOH",20) : 0.1177366138677159;
  B1.Diff_eff("ETOH",21) : 0.117650902080009;
  B1.Diff_eff("ETOH",22) : 0.117650902080009;
  B1.Diff_eff("ETOH",23) : 0.1176509020800089;
  B1.Diff_eff("ETOH",24) : 0.117650902080009;
  B1.Diff_eff("ETOH",25) : 0.117650902080009;
  B1.Diff_eff("ETOH",3) : 0.1328911886598591;
  B1.Diff_eff("ETOH",4) : 0.1332056770658603;
  B1.Diff_eff("ETOH",5) : 0.1333839042694795;
  B1.Diff_eff("ETOH",6) : 0.1334873024289235;
  B1.Diff_eff("ETOH",7) : 0.1335485881942287;
  B1.Diff_eff("ETOH",8) : 0.1335853904622025;
  B1.Diff_eff("ETOH",9) : 0.1336074949797459;
  B1.Diff_eff("H2",1) : 0.6046387460100269;
  B1.Diff_eff("H2",10) : 0.6015904042262418;
  B1.Diff_eff("H2",11) : 0.5984327128846253;
  B1.Diff_eff("H2",12) : 0.5954942144691259;
  B1.Diff_eff("H2",13) : 0.5928787794939945;
  B1.Diff_eff("H2",14) : 0.5906455719439084;
  B1.Diff_eff("H2",15) : 0.5888074820967533;
  B1.Diff_eff("H2",16) : 0.587344566726817;
  B1.Diff_eff("H2",17) : 0.5862156396984445;
  B1.Diff_eff("H2",18) : 0.5853687007610203;
  B1.Diff_eff("H2",19) : 0.5847495773115581;
  B1.Diff_eff("H2",2) : 0.6034499870946906;
  B1.Diff_eff("H2",20) : 0.5850575225115371;
  B1.Diff_eff("H2",21) : 0.5847769457701524;
  B1.Diff_eff("H2",22) : 0.5847769457701524;
  B1.Diff_eff("H2",23) : 0.5847769457701524;
  B1.Diff_eff("H2",24) : 0.5847769457701524;
  B1.Diff_eff("H2",25) : 0.5847769457701524;
  B1.Diff_eff("H2",3) : 0.6030908383142695;
  B1.Diff_eff("H2",4) : 0.6030946994994734;
  B1.Diff_eff("H2",5) : 0.6032445655226468;
  B1.Diff_eff("H2",6) : 0.6034476202617243;
  B1.Diff_eff("H2",7) : 0.603662572385011;
  B1.Diff_eff("H2",8) : 0.6038710522550845;
  B1.Diff_eff("H2",9) : 0.6040653593856943;
  B1.Diff_eff("H2O",1) : 0.2538623625280784;
  B1.Diff_eff("H2O",10) : 0.256423856760979;
  B1.Diff_eff("H2O",11) : 0.2505304932771888;
  B1.Diff_eff("H2O",12) : 0.2462510634142744;
  B1.Diff_eff("H2O",13) : 0.2429495200340393;
  B1.Diff_eff("H2O",14) : 0.2403398367022143;
  B1.Diff_eff("H2O",15) : 0.2382783134725624;
  B1.Diff_eff("H2O",16) : 0.2366694773475311;
  B1.Diff_eff("H2O",17) : 0.2354344883585157;
  B1.Diff_eff("H2O",18) : 0.2345027316983439;
  B1.Diff_eff("H2O",19) : 0.2338110360944381;
  B1.Diff_eff("H2O",2) : 0.2585469772753239;
  B1.Diff_eff("H2O",20) : 0.2341263853881928;
  B1.Diff_eff("H2O",21) : 0.2336504954403632;
  B1.Diff_eff("H2O",22) : 0.2336504954403632;
  B1.Diff_eff("H2O",23) : 0.2336504954403632;
  B1.Diff_eff("H2O",24) : 0.2336504954403632;
  B1.Diff_eff("H2O",25) : 0.2336504954403632;
  B1.Diff_eff("H2O",3) : 0.2613528493238175;
  B1.Diff_eff("H2O",4) : 0.2631695826294721;
  B1.Diff_eff("H2O",5) : 0.2644179742738093;
  B1.Diff_eff("H2O",6) : 0.2653241293152784;
  B1.Diff_eff("H2O",7) : 0.266011213323457;
  B1.Diff_eff("H2O",8) : 0.2665494586326823;
  B1.Diff_eff("H2O",9) : 0.2669813851137196;
  B1.Diff_eff("N2",1) : 0.2290802102351681;
  B1.Diff_eff("N2",10) : 0.2290309403270106;
  B1.Diff_eff("N2",11) : 0.2235589914220425;
  B1.Diff_eff("N2",12) : 0.2190416516018672;
  B1.Diff_eff("N2",13) : 0.2151952078822017;
  B1.Diff_eff("N2",14) : 0.2119263042374386;
  B1.Diff_eff("N2",15) : 0.2092015108233055;
  B1.Diff_eff("N2",16) : 0.2069878553605829;
  B1.Diff_eff("N2",17) : 0.2052365453865748;
  B1.Diff_eff("N2",18) : 0.2038848682152723;
  B1.Diff_eff("N2",19) : 0.2028640445425467;
  B1.Diff_eff("N2",2) : 0.2317781093320926;
  B1.Diff_eff("N2",20) : 0.2032067054621214;
  B1.Diff_eff("N2",21) : 0.2028201603166561;
  B1.Diff_eff("N2",22) : 0.2028201603166561;
  B1.Diff_eff("N2",23) : 0.2028201603166561;
  B1.Diff_eff("N2",24) : 0.2028201603166561;
  B1.Diff_eff("N2",25) : 0.2028201603166561;
  B1.Diff_eff("N2",3) : 0.2334857500406723;
  B1.Diff_eff("N2",4) : 0.2346284525131611;
  B1.Diff_eff("N2",5) : 0.23543212775937;
  B1.Diff_eff("N2",6) : 0.2360265322895345;
  B1.Diff_eff("N2",7) : 0.2364846988756186;
  B1.Diff_eff("N2",8) : 0.2368490802704804;
  B1.Diff_eff("N2",9) : 0.2371457165188513;
  B1.Diff_eff("O2",1) : 0.2230076389018578;
  B1.Diff_eff("O2",10) : 0.222018280363329;
  B1.Diff_eff("O2",11) : 0.2175075029898791;
  B1.Diff_eff("O2",12) : 0.2138400491529925;
  B1.Diff_eff("O2",13) : 0.2107735718755946;
  B1.Diff_eff("O2",14) : 0.2082142217422254;
  B1.Diff_eff("O2",15) : 0.2061149293462667;
  B1.Diff_eff("O2",16) : 0.2044320958291863;
  B1.Diff_eff("O2",17) : 0.2031146425931034;
  B1.Diff_eff("O2",18) : 0.2021056322822715;
  B1.Diff_eff("O2",19) : 0.2013474829171693;
  B1.Diff_eff("O2",2) : 0.2249393044770155;
  B1.Diff_eff("O2",20) : 0.2015728336992181;
  B1.Diff_eff("O2",21) : 0.2013048192302644;
  B1.Diff_eff("O2",22) : 0.2013048192302644;
  B1.Diff_eff("O2",23) : 0.2013048192302644;
  B1.Diff_eff("O2",24) : 0.2013048192302644;
  B1.Diff_eff("O2",25) : 0.2013048192302644;
  B1.Diff_eff("O2",3) : 0.2261581206647003;
  B1.Diff_eff("O2",4) : 0.2269630799684947;
  B1.Diff_eff("O2",5) : 0.2275193336992997;
  B1.Diff_eff("O2",6) : 0.2279227632393845;
  B1.Diff_eff("O2",7) : 0.2282274952867897;
  B1.Diff_eff("O2",8) : 0.2284649795082887;
  B1.Diff_eff("O2",9) : 0.2286544529104888;
  B1.dV1_vessel : 5.086800000000001e-004;
  B1.dV2_annulus : 1.425246e-006;
  B1.dV2_pipe : 9.074600000000001e-008;
  B1.dV2_vessel : 8.8548e-004;
  B1.dV3_annulus : 2.850492000000001e-006;
  B1.dV3_pipe : 1.81492e-007;
  B1.dV3_vessel : 1.77096e-003;
  B1.eps_e(0) : 0.4489443986017275;
  B1.eps_e(1) : 0.4567576362149093;
  B1.eps_e(10) : 0.4568937699669854;
  B1.eps_e(11) : 0.4569439501311861;
  B1.eps_e(12) : 0.4569872548975763;
  B1.eps_e(13) : 0.4570199413010621;
  B1.eps_e(14) : 0.4570426731382538;
  B1.eps_e(15) : 0.4570575789118065;
  B1.eps_e(16) : 0.4570669299903649;
  B1.eps_e(17) : 0.4570726376070749;
  B1.eps_e(18) : 0.4570761147827766;
  B1.eps_e(19) : 0.457078306230045;
  B1.eps_e(2) : 0.4567866685958196;
  B1.eps_e(20) : 0.457083422473192;
  B1.eps_e(21) : 0.457069283772689;
  B1.eps_e(22) : 0.457069283772689;
  B1.eps_e(23) : 0.457069283772689;
  B1.eps_e(24) : 0.457069283772689;
  B1.eps_e(25) : 0.457069283772689;
  B1.eps_e(3) : 0.4568107791743556;
  B1.eps_e(4) : 0.456828646537258;
  B1.eps_e(5) : 0.4568416181849794;
  B1.eps_e(6) : 0.4568511705713531;
  B1.eps_e(7) : 0.4568583214362068;
  B1.eps_e(8) : 0.4568637356408568;
  B1.eps_e(9) : 0.4568678586540115;
  B1.eps_mf(0) : 0.4489443986017275;
  B1.eps_mf(1) : 0.4567576362149093;
  B1.eps_mf(10) : 0.4568937699669854;
  B1.eps_mf(11) : 0.4569439501311861;
  B1.eps_mf(12) : 0.4569872548975763;
  B1.eps_mf(13) : 0.4570199413010621;
  B1.eps_mf(14) : 0.4570426731382538;
  B1.eps_mf(15) : 0.4570575789118065;
  B1.eps_mf(16) : 0.4570669299903649;
  B1.eps_mf(17) : 0.4570726376070749;
  B1.eps_mf(18) : 0.4570761147827766;
  B1.eps_mf(19) : 0.457078306230045;
  B1.eps_mf(2) : 0.4567866685958196;
  B1.eps_mf(20) : 0.457083422473192;
  B1.eps_mf(21) : 0.457069283772689;
  B1.eps_mf(22) : 0.457069283772689;
  B1.eps_mf(23) : 0.457069283772689;
  B1.eps_mf(24) : 0.457069283772689;
  B1.eps_mf(25) : 0.457069283772689;
  B1.eps_mf(3) : 0.4568107791743556;
  B1.eps_mf(4) : 0.456828646537258;
  B1.eps_mf(5) : 0.4568416181849794;
  B1.eps_mf(6) : 0.4568511705713531;
  B1.eps_mf(7) : 0.4568583214362068;
  B1.eps_mf(8) : 0.4568637356408568;
  B1.eps_mf(9) : 0.4568678586540115;
  B1.EtOH_ox : 6.723202137400057e-003;
  B1.f_fil : 0.;
  B1.f_pipe(11) : 0.7718421873000227;
  B1.f_pipe(12) : 0.7718421873000227;
  B1.f_pipe(13) : 0.7718421873000227;
  B1.f_pipe(14) : 0.7718421873000227;
  B1.f_pipe(15) : 0.7718421873000227;
  B1.f_pipe(16) : 0.7718421873000227;
  B1.f_pipe(17) : 0.7718421873000227;
  B1.f_pipe(18) : 0.7718421873000227;
  B1.f_pipe(19) : 0.7718421873000227;
  B1.f_pipe(20) : 0.7718421873000227;
  B1.f_pipe(21) : 0.7718421873000227;
  B1.f_pipe(22) : 0.7718421873000227;
  B1.f_pipe(23) : 0.7718421873000227;
  B1.f_pipe(24) : 0.7718421873000227;
  B1.f_pipe(25) : 0.7718421873000227;
  B1.Feed_in.h : -0.1398807206082672;
  B1.Feed_in.V : 8.339293312929769;
  B1.H2perm : 3.182841659667312;
  B1.h_per(10) : 1.390454249341475e-002;
  B1.h_per(11) : 1.390454249341475e-002;
  B1.h_per(12) : 1.390454249341475e-002;
  B1.h_per(13) : 1.390454249341475e-002;
  B1.h_per(14) : 1.390454249341475e-002;
  B1.h_per(15) : 1.390454249341475e-002;
  B1.h_per(16) : 1.390454249341475e-002;
  B1.h_per(17) : 1.390454249341475e-002;
  B1.h_per(18) : 1.390454249341475e-002;
  B1.h_per(19) : 1.390454249341475e-002;
  B1.h_per(20) : 1.390454249341475e-002;
  B1.h_per(21) : 1.390454249341475e-002;
  B1.h_per(22) : 1.390454249341475e-002;
  B1.h_per(23) : 1.390454249341475e-002;
  B1.h_per(24) : 1.390454249341475e-002;
  B1.h_per(25) : 1.390454249341475e-002;
  B1.h_ret(0) : -0.1398807178001719;
  B1.h_ret(1) : -0.130013968250816;
  B1.h_ret(10) : -0.1374697289314301;
  B1.h_ret(11) : -0.142657999134665;
  B1.h_ret(12) : -0.1471585020688121;
  B1.h_ret(13) : -0.1511510645073375;
  B1.h_ret(14) : -0.1546706341951081;
  B1.h_ret(15) : -0.1577146092429183;
  B1.h_ret(16) : -0.1602894682202784;
  B1.h_ret(17) : -0.1624232446131607;
  B1.h_ret(18) : -0.1641627837714896;
  B1.h_ret(19) : -0.1655655453775132;
  B1.h_ret(2) : -0.1298170699230948;
  B1.h_ret(20) : -0.1659474420178687;
  B1.h_ret(21) : -0.1663234817746159;
  B1.h_ret(22) : -0.1663234817746158;
  B1.h_ret(23) : -0.1663234817746159;
  B1.h_ret(24) : -0.1663234817746158;
  B1.h_ret(25) : -0.1663234817696999;
  B1.h_ret(3) : -0.1296624538826854;
  B1.h_ret(4) : -0.1296786824486117;
  B1.h_ret(5) : -0.1298067227575107;
  B1.h_ret(6) : -0.129993917056041;
  B1.h_ret(7) : -0.1302082087635721;
  B1.h_ret(8) : -0.1304316155887001;
  B1.h_ret(9) : -0.130654277547679;
  B1.h_s : 0.5268710792647513;
  B1.h_s_0 : 0.5151260370277725;
  B1.HHV_ret : 3.631141724032611e-002;
  B1.HRF : 0.6586039780171566;
  B1.HRF_star : 0.8101830549960608;
  B1.k_per(10) : 0.3710073612871068;
  B1.k_per(11) : 0.3710073612871068;
  B1.k_per(12) : 0.3710073612871068;
  B1.k_per(13) : 0.3710073612871068;
  B1.k_per(14) : 0.3710073612871068;
  B1.k_per(15) : 0.3710073612871068;
  B1.k_per(16) : 0.3710073612871068;
  B1.k_per(17) : 0.3710073612871068;
  B1.k_per(18) : 0.3710073612871068;
  B1.k_per(19) : 0.3710073612871068;
  B1.k_per(20) : 0.3710073612871068;
  B1.k_per(21) : 0.3710073612871068;
  B1.k_per(22) : 0.3710073612871068;
  B1.k_per(23) : 0.3710073612871068;
  B1.k_per(24) : 0.3710073612871068;
  B1.k_per(25) : 0.3710073612871068;
  B1.k_ret(0) : 4.840726830173617e-002;
  B1.k_ret(1) : 8.175817223849126e-002;
  B1.k_ret(10) : 8.372013626005014e-002;
  B1.k_ret(11) : 8.047274315135876e-002;
  B1.k_ret(12) : 7.802375381473878e-002;
  B1.k_ret(13) : 7.603900139970898e-002;
  B1.k_ret(14) : 7.438510676704385e-002;
  B1.k_ret(15) : 7.301222930937718e-002;
  B1.k_ret(16) : 7.189243595560942e-002;
  B1.k_ret(17) : 7.099850792776158e-002;
  B1.k_ret(18) : 7.029953396769208e-002;
  B1.k_ret(19) : 6.976255120271559e-002;
  B1.k_ret(2) : 8.515847589992981e-002;
  B1.k_ret(20) : 6.98806322492988e-002;
  B1.k_ret(21) : 6.970720856024504e-002;
  B1.k_ret(22) : 6.970720856024504e-002;
  B1.k_ret(23) : 6.970720856024504e-002;
  B1.k_ret(24) : 6.970720856024504e-002;
  B1.k_ret(25) : 6.970720856024504e-002;
  B1.k_ret(3) : 8.702017769854095e-002;
  B1.k_ret(4) : 8.810559710146551e-002;
  B1.k_ret(5) : 8.877636082025596e-002;
  B1.k_ret(6) : 8.921508739022281e-002;
  B1.k_ret(7) : 8.951673029735456e-002;
  B1.k_ret(8) : 8.97328388802825e-002;
  B1.k_ret(9) : 8.989285909710576e-002;
  B1.m_s : 13.10171562576436;
  B1.m_s_cum_i(0) : 0.;
  B1.m_s_cum_i(1) : 0.4190037991902949;
  B1.m_s_cum_i(10) : 4.732733640412032;
  B1.m_s_cum_i(11) : 5.558136525852509;
  B1.m_s_cum_i(12) : 6.387358347371205;
  B1.m_s_cum_i(13) : 7.219932507341086;
  B1.m_s_cum_i(14) : 8.055342842006859;
  B1.m_s_cum_i(15) : 8.89307879867269;
  B1.m_s_cum_i(16) : 9.73267084872937;
  B1.m_s_cum_i(17) : 10.57371012294293;
  B1.m_s_cum_i(18) : 11.41585594039821;
  B1.m_s_cum_i(19) : 12.25883459749111;
  B1.m_s_cum_i(2) : 0.8697434633411179;
  B1.m_s_cum_i(20) : 13.10171562576436;
  B1.m_s_cum_i(21) : 13.10171562576436;
  B1.m_s_cum_i(22) : 13.10171562576436;
  B1.m_s_cum_i(23) : 13.10171562576436;
  B1.m_s_cum_i(24) : 13.10171562576436;
  B1.m_s_cum_i(25) : 13.10171562576436;
  B1.m_s_cum_i(3) : 1.33569533896995;
  B1.m_s_cum_i(4) : 1.811067141421758;
  B1.m_s_cum_i(5) : 2.293015501604138;
  B1.m_s_cum_i(6) : 2.779888496976677;
  B1.m_s_cum_i(7) : 3.27062346193005;
  B1.m_s_cum_i(8) : 3.764488222488913;
  B1.m_s_cum_i(9) : 4.260952625356858;
  B1.m_s_i(0) : 1.e-020;
  B1.m_s_i(1) : 0.4190037991902949;
  B1.m_s_i(10) : 0.4717810150551742;
  B1.m_s_i(11) : 0.8254028854404771;
  B1.m_s_i(12) : 0.8292218215186958;
  B1.m_s_i(13) : 0.8325741599698799;
  B1.m_s_i(14) : 0.835410334665773;
  B1.m_s_i(15) : 0.8377359566658322;
  B1.m_s_i(16) : 0.8395920500566811;
  B1.m_s_i(17) : 0.8410392742135578;
  B1.m_s_i(18) : 0.8421458174552797;
  B1.m_s_i(19) : 0.842978657092901;
  B1.m_s_i(2) : 0.450739664150823;
  B1.m_s_i(20) : 0.8428810282732552;
  B1.m_s_i(21) : 1.e-020;
  B1.m_s_i(22) : 1.e-020;
  B1.m_s_i(23) : 1.e-020;
  B1.m_s_i(24) : 1.e-020;
  B1.m_s_i(25) : 1.e-020;
  B1.m_s_i(3) : 0.4659518756288318;
  B1.m_s_i(4) : 0.475371802451808;
  B1.m_s_i(5) : 0.4819483601823804;
  B1.m_s_i(6) : 0.4868729953725388;
  B1.m_s_i(7) : 0.4907349649533729;
  B1.m_s_i(8) : 0.4938647605588623;
  B1.m_s_i(9) : 0.4964644028679459;
  B1.mu_app(0) : 0.3191192734213318;
  B1.mu_app(1) : 0.3252985281615142;
  B1.mu_app(10) : 0.3256064465551716;
  B1.mu_app(11) : 0.3250262982322683;
  B1.mu_app(12) : 0.324456680041083;
  B1.mu_app(13) : 0.3238770216154487;
  B1.mu_app(14) : 0.3232730526105148;
  B1.mu_app(15) : 0.3226308811806442;
  B1.mu_app(16) : 0.3219328111241786;
  B1.mu_app(17) : 0.3211513550593263;
  B1.mu_app(18) : 0.3202356156064092;
  B1.mu_app(19) : 0.3190641452744951;
  B1.mu_app(2) : 0.3257134983960859;
  B1.mu_app(20) : 0.3191932439198084;
  B1.mu_app(21) : 0.3192321684250163;
  B1.mu_app(22) : 0.3192321680884515;
  B1.mu_app(23) : 0.3192321678172001;
  B1.mu_app(24) : 0.3192321675986678;
  B1.mu_app(25) : 0.3192321674226561;
  B1.mu_app(3) : 0.3259177143227732;
  B1.mu_app(4) : 0.326041190103163;
  B1.mu_app(5) : 0.3261228475462952;
  B1.mu_app(6) : 0.3261799823811493;
  B1.mu_app(7) : 0.3262214852166873;
  B1.mu_app(8) : 0.3262523882750426;
  B1.mu_app(9) : 0.3262757977732123;
  B1.mu_per(10) : 1.710954702004397e-002;
  B1.mu_per(11) : 1.710954702004397e-002;
  B1.mu_per(12) : 1.710954702004397e-002;
  B1.mu_per(13) : 1.710954702004397e-002;
  B1.mu_per(14) : 1.710954702004397e-002;
  B1.mu_per(15) : 1.710954702004397e-002;
  B1.mu_per(16) : 1.710954702004397e-002;
  B1.mu_per(17) : 1.710954702004397e-002;
  B1.mu_per(18) : 1.710954702004397e-002;
  B1.mu_per(19) : 1.710954702004397e-002;
  B1.mu_per(20) : 1.710954702004397e-002;
  B1.mu_per(21) : 1.710954702004397e-002;
  B1.mu_per(22) : 1.710954702004397e-002;
  B1.mu_per(23) : 1.710954702004397e-002;
  B1.mu_per(24) : 1.710954702004397e-002;
  B1.mu_per(25) : 1.710954702004397e-002;
  B1.mu_ret(0) : 2.593214779516432e-002;
  B1.mu_ret(1) : 3.300776186979274e-002;
  B1.mu_ret(10) : 3.329910015455484e-002;
  B1.mu_ret(11) : 3.355580641637248e-002;
  B1.mu_ret(12) : 3.377554542999287e-002;
  B1.mu_ret(13) : 3.395826321550735e-002;
  B1.mu_ret(14) : 3.410638549828393e-002;
  B1.mu_ret(15) : 3.422373961248881e-002;
  B1.mu_ret(16) : 3.431484180698186e-002;
  B1.mu_ret(17) : 3.438435824861214e-002;
  B1.mu_ret(18) : 3.443669162614133e-002;
  B1.mu_ret(19) : 3.447570971875208e-002;
  B1.mu_ret(2) : 3.301031411578387e-002;
  B1.mu_ret(20) : 3.447508184034339e-002;
  B1.mu_ret(21) : 3.446590263660171e-002;
  B1.mu_ret(22) : 3.446590263660171e-002;
  B1.mu_ret(23) : 3.446590263660171e-002;
  B1.mu_ret(24) : 3.446590263660171e-002;
  B1.mu_ret(25) : 3.446590263660171e-002;
  B1.mu_ret(3) : 3.301579230053824e-002;
  B1.mu_ret(4) : 3.301998418780302e-002;
  B1.mu_ret(5) : 3.302256813061749e-002;
  B1.mu_ret(6) : 3.302392581244078e-002;
  B1.mu_ret(7) : 3.302441262120323e-002;
  B1.mu_ret(8) : 3.302428505900201e-002;
  B1.mu_ret(9) : 3.302372331250276e-002;
  B1.MW("CH4") : 16.04276000000001;
  B1.MW("CO") : 28.0104;
  B1.MW("CO2") : 44.00980000000001;
  B1.MW("ETOH") : 46.06904000000001;
  B1.MW("H2") : 2.015880000000001;
  B1.MW("H2O") : 18.01528;
  B1.MW("N2") : 28.01348;
  B1.MW("O2") : 31.99880000000001;
  B1.MW_feed_in : 25.845655301721;
  B1.MW_per(10) : 2.015880000000001;
  B1.MW_per(11) : 2.015880000000001;
  B1.MW_per(12) : 2.015880000000001;
  B1.MW_per(13) : 2.015880000000001;
  B1.MW_per(14) : 2.015880000000001;
  B1.MW_per(15) : 2.015880000000001;
  B1.MW_per(16) : 2.015880000000001;
  B1.MW_per(17) : 2.015880000000001;
  B1.MW_per(18) : 2.015880000000001;
  B1.MW_per(19) : 2.015880000000001;
  B1.MW_per(20) : 2.015880000000001;
  B1.MW_per(21) : 2.015880000000001;
  B1.MW_per(22) : 2.015880000000001;
  B1.MW_per(23) : 2.015880000000001;
  B1.MW_per(24) : 2.015880000000001;
  B1.MW_per(25) : 2.015880000000001;
  B1.MW_per_out : 2.015880000000001;
  B1.MW_per_p : 2.015880000000001;
  B1.MW_ret(0) : 25.845655301721;
  B1.MW_ret(1) : 22.04716501367402;
  B1.MW_ret(10) : 22.64060430386821;
  B1.MW_ret(11) : 23.61444716143651;
  B1.MW_ret(12) : 24.47077593749662;
  B1.MW_ret(13) : 25.22364350561065;
  B1.MW_ret(14) : 25.87376716393723;
  B1.MW_ret(15) : 26.42072641146704;
  B1.MW_ret(16) : 26.8681281175836;
  B1.MW_ret(17) : 27.22437393857067;
  B1.MW_ret(18) : 27.50134329283084;
  B1.MW_ret(19) : 27.71243355703819;
  B1.MW_ret(2) : 21.88435576400745;
  B1.MW_ret(20) : 27.66983300822018;
  B1.MW_ret(21) : 27.72370668009882;
  B1.MW_ret(22) : 27.72370668009882;
  B1.MW_ret(23) : 27.72370668009882;
  B1.MW_ret(24) : 27.72370668009883;
  B1.MW_ret(25) : 27.72370668009882;
  B1.MW_ret(3) : 21.76617982313548;
  B1.MW_ret(4) : 21.67965167859518;
  B1.MW_ret(5) : 21.61486196615983;
  B1.MW_ret(6) : 21.56468509558758;
  B1.MW_ret(7) : 21.52468849246329;
  B1.MW_ret(8) : 21.49210581139198;
  B1.MW_ret(9) : 21.46512946802975;
  B1.MW_ret_out : 27.72370668009882;
  B1.MW_sweep_in : 2.015880000000001;
  B1.N_mem : 42.;
  B1.N_sel("CH4") : 1.e-010;
  B1.N_sel("CO") : 1.e-010;
  B1.N_sel("CO2") : 1.e-010;
  B1.N_sel("ETOH") : 1.e-010;
  B1.N_sel("H2") : 0.;
  B1.N_sel("H2O") : 1.e-010;
  B1.N_sel("N2") : 1.e-010;
  B1.N_sel("O2") : 1.e-010;
  B1.O22EtOH : 0.561277143643696;
  B1.P_per(10) : 0.3000000000000002;
  B1.P_per(11) : 0.3000000000000002;
  B1.P_per(12) : 0.3000000000000002;
  B1.P_per(13) : 0.3000000000000002;
  B1.P_per(14) : 0.3000000000000002;
  B1.P_per(15) : 0.3000000000000002;
  B1.P_per(16) : 0.3000000000000002;
  B1.P_per(17) : 0.3000000000000002;
  B1.P_per(18) : 0.3000000000000002;
  B1.P_per(19) : 0.3000000000000002;
  B1.P_per(20) : 0.3000000000000002;
  B1.P_per(21) : 0.3000000000000002;
  B1.P_per(22) : 0.3000000000000002;
  B1.P_per(23) : 0.3000000000000002;
  B1.P_per(24) : 0.3000000000000002;
  B1.P_per(25) : 0.3000000000000002;
  B1.P_per_p(10) : 0.3000000000000002;
  B1.P_per_p(11) : 0.3000000000000002;
  B1.P_per_p(12) : 0.3000000000000002;
  B1.P_per_p(13) : 0.3000000000000002;
  B1.P_per_p(14) : 0.3000000000000002;
  B1.P_per_p(15) : 0.3000000000000002;
  B1.P_per_p(16) : 0.3000000000000002;
  B1.P_per_p(17) : 0.3000000000000002;
  B1.P_per_p(18) : 0.3000000000000002;
  B1.P_per_p(19) : 0.3000000000000002;
  B1.P_per_p(20) : 0.3000000000000002;
  B1.P_per_p(21) : 0.3000000000000002;
  B1.P_per_p(22) : 0.3000000000000002;
  B1.P_per_p(23) : 0.3000000000000002;
  B1.P_per_p(24) : 0.3000000000000002;
  B1.P_per_p(25) : 0.3000000000000002;
  B1.P_ret(0) : 6.;
  B1.P_ret(1) : 6.;
  B1.P_ret(10) : 6.;
  B1.P_ret(11) : 6.;
  B1.P_ret(12) : 6.;
  B1.P_ret(13) : 6.;
  B1.P_ret(14) : 6.;
  B1.P_ret(15) : 6.;
  B1.P_ret(16) : 6.;
  B1.P_ret(17) : 6.;
  B1.P_ret(18) : 6.;
  B1.P_ret(19) : 6.;
  B1.P_ret(2) : 6.;
  B1.P_ret(20) : 6.;
  B1.P_ret(21) : 6.;
  B1.P_ret(22) : 6.;
  B1.P_ret(23) : 6.;
  B1.P_ret(24) : 6.;
  B1.P_ret(25) : 6.;
  B1.P_ret(3) : 6.;
  B1.P_ret(4) : 6.;
  B1.P_ret(5) : 6.;
  B1.P_ret(6) : 6.;
  B1.P_ret(7) : 6.;
  B1.P_ret(8) : 6.;
  B1.P_ret(9) : 6.;
  B1.pattern : "exagonal_pattern";
  B1.Per_out.F : 0.1420023940245968;
  B1.Per_out.h : 1.390454249341475e-002;
  B1.Per_out.P : 0.3000000000000002;
  B1.Per_out.T : 500.;
  B1.Per_out.V : 214.2656366666667;
  B1.Per_out.z("CH4") : 0.;
  B1.Per_out.z("CO") : 0.;
  B1.Per_out.z("CO2") : 0.;
  B1.Per_out.z("ETOH") : 0.;
  B1.Per_out.z("H2") : 1.;
  B1.Per_out.z("H2O") : 0.;
  B1.Per_out.z("N2") : 0.;
  B1.Per_out.z("O2") : 0.;
  B1.Pi_avg_mem_ret("CH4") : 10.2311034156365;
  B1.Pi_avg_mem_ret("CO") : 10.2311034156365;
  B1.Pi_avg_mem_ret("CO2") : 10.2311034156365;
  B1.Pi_avg_mem_ret("ETOH") : 10.2311034156365;
  B1.Pi_avg_mem_ret("H2") : 10.2311034156365;
  B1.Pi_avg_mem_ret("H2O") : 10.2311034156365;
  B1.Pi_avg_mem_ret("N2") : 10.2311034156365;
  B1.Pi_avg_mem_ret("O2") : 10.2311034156365;
  B1.por : 0.48;
  B1.q_loss(0) : 0.;
  B1.q_loss(1) : 1.321761875901622e-003;
  B1.q_loss(10) : 1.321761875901622e-003;
  B1.q_loss(11) : 2.643523751803244e-003;
  B1.q_loss(12) : 2.643523751803244e-003;
  B1.q_loss(13) : 2.643523751803244e-003;
  B1.q_loss(14) : 2.643523751803244e-003;
  B1.q_loss(15) : 2.643523751803244e-003;
  B1.q_loss(16) : 2.643523751803244e-003;
  B1.q_loss(17) : 2.643523751803244e-003;
  B1.q_loss(18) : 2.643523751803244e-003;
  B1.q_loss(19) : 2.643523751803244e-003;
  B1.q_loss(2) : 1.321761875901622e-003;
  B1.q_loss(20) : 2.643523751803244e-003;
  B1.q_loss(21) : 5.287047503606488e-003;
  B1.q_loss(22) : 5.287047503606488e-003;
  B1.q_loss(23) : 5.287047503606488e-003;
  B1.q_loss(24) : 5.287047503606488e-003;
  B1.q_loss(25) : 5.287047503606488e-003;
  B1.q_loss(3) : 1.321761875901622e-003;
  B1.q_loss(4) : 1.321761875901622e-003;
  B1.q_loss(5) : 1.321761875901622e-003;
  B1.q_loss(6) : 1.321761875901622e-003;
  B1.q_loss(7) : 1.321761875901622e-003;
  B1.q_loss(8) : 1.321761875901622e-003;
  B1.q_loss(9) : 1.321761875901622e-003;
  B1.Q_loss_tot : 7.745006302585034e-002;
  B1.r_ext_pipe : 9.5e-004;
  B1.r_int_pipe : 1.e-003;
  B1.r_int_support : 3.5e-003;
  B1.r_por : 3.6e-007;
  B1.r_state("CH4_ox") : 0.;
  B1.r_state("CO_ox") : 0.;
  B1.r_state("EtOH_dec") : 0.;
  B1.r_state("EtOH_ox") : 0.;
  B1.r_state("EtOH_SR") : 0.;
  B1.r_state("EtOH_SR_2") : 0.;
  B1.r_state("EtOH_SR_3") : 0.;
  B1.r_state("H2_ox") : 0.;
  B1.r_state("MSR_2") : 0.;
  B1.Re_per(10) : 9.316685916210277;
  B1.Re_per(11) : 7.401276332901199;
  B1.Re_per(12) : 5.763003116087604;
  B1.Re_per(13) : 4.39766233145454;
  B1.Re_per(14) : 3.269331501364738;
  B1.Re_per(15) : 2.35115024259277;
  B1.Re_per(16) : 1.617256156109532;
  B1.Re_per(17) : 1.041045550318382;
  B1.Re_per(18) : 0.5958578251478734;
  B1.Re_per(19) : 0.2563916471751796;
  B1.Re_per(20) : 3.772295334339388e-007;
  B1.Re_per(21) : 3.772295334339388e-007;
  B1.Re_per(22) : 3.772295334339388e-007;
  B1.Re_per(23) : 3.772295334339388e-007;
  B1.Re_per(24) : 3.772295334339388e-007;
  B1.Re_per(25) : 3.772295334339388e-007;
  B1.Re_per_p(10) : 82.91850465427146;
  B1.Re_per_p(11) : 82.91850465427146;
  B1.Re_per_p(12) : 82.91850465427146;
  B1.Re_per_p(13) : 82.91850465427146;
  B1.Re_per_p(14) : 82.91850465427146;
  B1.Re_per_p(15) : 82.91850465427146;
  B1.Re_per_p(16) : 82.91850465427146;
  B1.Re_per_p(17) : 82.91850465427146;
  B1.Re_per_p(18) : 82.91850465427146;
  B1.Re_per_p(19) : 82.91850465427146;
  B1.Re_per_p(20) : 82.91850465427146;
  B1.Re_per_p(21) : 82.91850465427146;
  B1.Re_per_p(22) : 82.91850465427146;
  B1.Re_per_p(23) : 82.91850465427146;
  B1.Re_per_p(24) : 82.91850465427146;
  B1.Re_per_p(25) : 82.91850465427146;
  B1.Re_s(0) : 0.4609794058965386;
  B1.Re_s(1) : 0.1063224629682705;
  B1.Re_s(10) : 0.1054578940540884;
  B1.Re_s(11) : 0.1070935351172057;
  B1.Re_s(12) : 0.1087275733134864;
  B1.Re_s(13) : 0.1104195424054223;
  B1.Re_s(14) : 0.1122143529967077;
  B1.Re_s(15) : 0.1141591206725027;
  B1.Re_s(16) : 0.1163167132968795;
  B1.Re_s(17) : 0.1187871521327725;
  B1.Re_s(18) : 0.1217582413496964;
  B1.Re_s(19) : 0.1256828091776477;
  B1.Re_s(2) : 0.1051591879533745;
  B1.Re_s(20) : 0.1252433477069349;
  B1.Re_s(21) : 0.1251111881933577;
  B1.Re_s(22) : 0.1251111893354041;
  B1.Re_s(23) : 0.125111190255826;
  B1.Re_s(24) : 0.1251111909973604;
  B1.Re_s(25) : 0.1251111915946107;
  B1.Re_s(3) : 0.1045920264070495;
  B1.Re_s(4) : 0.1042507871060278;
  B1.Re_s(5) : 0.1040258121127901;
  B1.Re_s(6) : 0.1038687273926119;
  B1.Re_s(7) : 0.1037547897164006;
  B1.Re_s(8) : 0.1036700437863196;
  B1.Re_s(9) : 0.1036058998907463;
  B1.Ret_out.F : 0.2335959629067583;
  B1.Ret_out.h : -0.1663234817696999;
  B1.Ret_out.P : 6.;
  B1.Ret_out.T : 500.;
  B1.Ret_out.V : 10.71328183333333;
  B1.Ret_out.z("CH4") : 2.223521694524608e-002;
  B1.Ret_out.z("CO") : 9.976191444241785e-003;
  B1.Ret_out.z("CO2") : 0.2714519775119918;
  B1.Ret_out.z("ETOH") : 2.003157413476845e-003;
  B1.Ret_out.z("H2") : 5.410147168562141e-002;
  B1.Ret_out.z("H2O") : 0.3041072422079035;
  B1.Ret_out.z("N2") : 0.324817849866152;
  B1.Ret_out.z("O2") : 1.130689292536636e-002;
  B1.rho_s : 2000.;
  B1.S1_vessel : 2.5434e-002;
  B1.S2_vessel : 2.2137e-002;
  B1.S2EtOH : 3.608294930875576;
  B1.S2EtOH_star : 5.129207769941964;
  B1.S_annulus : 3.563115e-005;
  B1.S_int_pipe : 2.26865e-006;
  B1.Selectivity : 96927386.44625871;
  B1.Sw2EtOH.spec : Free;
  B1.Sw2EtOH : 2.782786835252509e-009;
  B1.Sweep_in.F : 1.e-008;
  B1.Sweep_in.h : 1.390454249341475e-002;
  B1.Sweep_in.P : 0.3;
  B1.Sweep_in.T : 500.;
  B1.Sweep_in.V : 214.2656366666667;
  B1.Sweep_in.z("CH4") : 0.;
  B1.Sweep_in.z("CO") : 0.;
  B1.Sweep_in.z("CO2") : 0.;
  B1.Sweep_in.z("ETOH") : 0.;
  B1.Sweep_in.z("H2") : 1.;
  B1.Sweep_in.z("H2O") : 0.;
  B1.Sweep_in.z("N2") : 0.;
  B1.Sweep_in.z("O2") : 0.;
  B1.t_annulus : 2.55e-003;
  B1.t_ins : 0.1;
  B1.T_per(10) : 500.;
  B1.T_per(11) : 500.;
  B1.T_per(12) : 500.;
  B1.T_per(13) : 500.;
  B1.T_per(14) : 500.;
  B1.T_per(15) : 500.;
  B1.T_per(16) : 500.;
  B1.T_per(17) : 500.;
  B1.T_per(18) : 500.;
  B1.T_per(19) : 500.;
  B1.T_per(20) : 500.;
  B1.T_per(21) : 500.;
  B1.T_per(22) : 500.;
  B1.T_per(23) : 500.;
  B1.T_per(24) : 500.;
  B1.T_per(25) : 500.;
  B1.T_per_p(10) : 500.;
  B1.T_per_p(11) : 500.;
  B1.T_per_p(12) : 500.;
  B1.T_per_p(13) : 500.;
  B1.T_per_p(14) : 500.;
  B1.T_per_p(15) : 500.;
  B1.T_per_p(16) : 500.;
  B1.T_per_p(17) : 500.;
  B1.T_per_p(18) : 500.;
  B1.T_per_p(19) : 500.;
  B1.T_per_p(20) : 500.;
  B1.T_per_p(21) : 500.;
  B1.T_per_p(22) : 500.;
  B1.T_per_p(23) : 500.;
  B1.T_per_p(24) : 500.;
  B1.T_per_p(25) : 500.;
  B1.t_pipe : 5.e-004;
  B1.T_reactor : 500.;
  B1.T_ret(0) : 500.;
  B1.T_ret(1) : 500.;
  B1.T_ret(10) : 500.;
  B1.T_ret(11) : 500.;
  B1.T_ret(12) : 500.;
  B1.T_ret(13) : 500.;
  B1.T_ret(14) : 500.;
  B1.T_ret(15) : 500.;
  B1.T_ret(16) : 500.;
  B1.T_ret(17) : 500.;
  B1.T_ret(18) : 500.;
  B1.T_ret(19) : 500.;
  B1.T_ret(2) : 500.;
  B1.T_ret(20) : 500.;
  B1.T_ret(21) : 500.;
  B1.T_ret(22) : 500.;
  B1.T_ret(23) : 500.;
  B1.T_ret(24) : 500.;
  B1.T_ret(25) : 500.;
  B1.T_ret(3) : 500.;
  B1.T_ret(4) : 500.;
  B1.T_ret(5) : 500.;
  B1.T_ret(6) : 500.;
  B1.T_ret(7) : 500.;
  B1.T_ret(8) : 500.;
  B1.T_ret(9) : 500.;
  B1.t_support : 3.e-003;
  B1.T_wall : 35.03368830643333;
  B1.Thermal : "thermal_balance";
  B1.tor : 3.2;
  B1.u0_0 : 2.382914847622937e-002;
  B1.u0_1 : 3.588837826465281e-002;
  B1.u0_umf_ratio(0) : 4.215435824929022;
  B1.u0_umf_ratio(1) : 8.070881104783439;
  B1.u0_umf_ratio(10) : 9.030585669662356;
  B1.u0_umf_ratio(11) : 8.659916855205056;
  B1.u0_umf_ratio(12) : 8.358993913423756;
  B1.u0_umf_ratio(13) : 8.110984018810907;
  B1.u0_umf_ratio(14) : 7.907917852460281;
  B1.u0_umf_ratio(15) : 7.744355693767795;
  B1.u0_umf_ratio(16) : 7.615164074583054;
  B1.u0_umf_ratio(17) : 7.515077389797492;
  B1.u0_umf_ratio(18) : 7.438875759112476;
  B1.u0_umf_ratio(19) : 7.381693760751825;
  B1.u0_umf_ratio(2) : 8.131460319400135;
  B1.u0_umf_ratio(20) : 7.39290277783564;
  B1.u0_umf_ratio(21) : 7.376601324138351;
  B1.u0_umf_ratio(22) : 7.376601324138311;
  B1.u0_umf_ratio(23) : 7.376601324138312;
  B1.u0_umf_ratio(24) : 7.376601324138305;
  B1.u0_umf_ratio(25) : 7.376601324138309;
  B1.u0_umf_ratio(3) : 8.176896739617419;
  B1.u0_umf_ratio(4) : 8.21052420752871;
  B1.u0_umf_ratio(5) : 8.235741495838136;
  B1.u0_umf_ratio(6) : 8.255214634196635;
  B1.u0_umf_ratio(7) : 8.270652971991215;
  B1.u0_umf_ratio(8) : 8.283140739514066;
  B1.u0_umf_ratio(9) : 8.293394050220604;
  B1.u0_umf_ratio_0 : 4.215435824929022;
  B1.u0_umf_ratio_1 : 8.070881104783439;
  B1.u0_umf_ratio_max : 9.030585669662356;
  B1.u0_umf_ratio_min : 4.215435824929022;
  B1.u0_umf_ratio_x2 : 9.030585669662356;
  B1.u_b(0).Record : True;
  B1.u_b(0) : 0.;
  B1.u_b(1).Record : True;
  B1.u_b(1) : 0.1344466006373269;
  B1.u_b(10).Record : True;
  B1.u_b(10) : 0.2465927642593326;
  B1.u_b(11).Record : True;
  B1.u_b(11) : 0.2407123807523143;
  B1.u_b(12).Record : True;
  B1.u_b(12) : 0.2365268377113524;
  B1.u_b(13).Record : True;
  B1.u_b(13) : 0.2333450543241408;
  B1.u_b(14).Record : True;
  B1.u_b(14) : 0.2308524067601518;
  B1.u_b(15).Record : True;
  B1.u_b(15) : 0.2288892657012753;
  B1.u_b(16).Record : True;
  B1.u_b(16) : 0.2273552959724242;
  B1.u_b(17).Record : True;
  B1.u_b(17) : 0.226172560555328;
  B1.u_b(18).Record : True;
  B1.u_b(18) : 0.2252735954925971;
  B1.u_b(19).Record : True;
  B1.u_b(19) : 0.2245990592292937;
  B1.u_b(2).Record : True;
  B1.u_b(2) : 0.1764102326391923;
  B1.u_b(20).Record : True;
  B1.u_b(20) : 0.2248239049388506;
  B1.u_b(21).Record : True;
  B1.u_b(21) : 0.2245822196078142;
  B1.u_b(22).Record : True;
  B1.u_b(22) : 0.2245666637159309;
  B1.u_b(23).Record : True;
  B1.u_b(23) : 0.2245639480663109;
  B1.u_b(24).Record : True;
  B1.u_b(24) : 0.2245634740034136;
  B1.u_b(25).Record : True;
  B1.u_b(25) : 0.224563391248212;
  B1.u_b(3).Record : True;
  B1.u_b(3) : 0.2078892616168547;
  B1.u_b(4).Record : True;
  B1.u_b(4) : 0.2337859130571829;
  B1.u_b(5).Record : True;
  B1.u_b(5) : 0.2560325548175235;
  B1.u_b(6).Record : True;
  B1.u_b(6) : 0.275639278502707;
  B1.u_b(7).Record : True;
  B1.u_b(7) : 0.293214632862251;
  B1.u_b(8).Record : True;
  B1.u_b(8) : 0.3091597518145137;
  B1.u_b(9).Record : True;
  B1.u_b(9) : 0.3237563242300203;
  B1.u_br(0).Record : True;
  B1.u_br(0) : 2.154753225059489e-003;
  B1.u_br(1).Record : True;
  B1.u_br(1) : 0.103004871728391;
  B1.u_br(10).Record : True;
  B1.u_br(10) : 0.2111971337445211;
  B1.u_br(11).Record : True;
  B1.u_br(11) : 0.2072107839334635;
  B1.u_br(12).Record : True;
  B1.u_br(12) : 0.2045524225948117;
  B1.u_br(13).Record : True;
  B1.u_br(13) : 0.2026158806140773;
  B1.u_br(14).Record : True;
  B1.u_br(14) : 0.2011315791725825;
  B1.u_br(15).Record : True;
  B1.u_br(15) : 0.1999726207023756;
  B1.u_br(16).Record : True;
  B1.u_br(16) : 0.1990686404911428;
  B1.u_br(17).Record : True;
  B1.u_br(17) : 0.1983708109471154;
  B1.u_br(18).Record : True;
  B1.u_br(18) : 0.1978392444934702;
  B1.u_br(19).Record : True;
  B1.u_br(19) : 0.1974394721201812;
  B1.u_br(2).Record : True;
  B1.u_br(2) : 0.1447012182474799;
  B1.u_br(20).Record : True;
  B1.u_br(20) : 0.1976160402480854;
  B1.u_br(21).Record : True;
  B1.u_br(21) : 0.1974366130745693;
  B1.u_br(22).Record : True;
  B1.u_br(22) : 0.1974210571826859;
  B1.u_br(23).Record : True;
  B1.u_br(23) : 0.1974183415330659;
  B1.u_br(24).Record : True;
  B1.u_br(24) : 0.1974178674701687;
  B1.u_br(25).Record : True;
  B1.u_br(25) : 0.1974177847149671;
  B1.u_br(3).Record : True;
  B1.u_br(3) : 0.175983247143448;
  B1.u_br(4).Record : True;
  B1.u_br(4) : 0.201734274288285;
  B1.u_br(5).Record : True;
  B1.u_br(5) : 0.2238711910474962;
  B1.u_br(6).Record : True;
  B1.u_br(6) : 0.2433925722627953;
  B1.u_br(7).Record : True;
  B1.u_br(7) : 0.2608996947173473;
  B1.u_br(8).Record : True;
  B1.u_br(8) : 0.2767891123972909;
  B1.u_br(9).Record : True;
  B1.u_br(9) : 0.2913395010845197;
  B1.u_e(0) : 2.382914847622937e-002;
  B1.u_e(1) : 4.446649355716879e-003;
  B1.u_e(10) : 4.407602629597462e-003;
  B1.u_e(11) : 4.373624081322221e-003;
  B1.u_e(12) : 4.344943818776001e-003;
  B1.u_e(13) : 4.321367285986676e-003;
  B1.u_e(14) : 4.302429215625966e-003;
  B1.u_e(15) : 4.287532614215541e-003;
  B1.u_e(16) : 4.276032334551624e-003;
  B1.u_e(17) : 4.267293839325632e-003;
  B1.u_e(18) : 4.260736194560206e-003;
  B1.u_e(19) : 4.255858730819577e-003;
  B1.u_e(2) : 4.44635642232384e-003;
  B1.u_e(20) : 4.255948453509341e-003;
  B1.u_e(21) : 4.257065034078012e-003;
  B1.u_e(22) : 4.257065034078036e-003;
  B1.u_e(23) : 4.257065034078036e-003;
  B1.u_e(24) : 4.25706503407804e-003;
  B1.u_e(25) : 4.257065034078037e-003;
  B1.u_e(3) : 4.445656058736535e-003;
  B1.u_e(4) : 4.445119085160544e-003;
  B1.u_e(5) : 4.444791703590557e-003;
  B1.u_e(6) : 4.44462471005621e-003;
  B1.u_e(7) : 4.444571659435653e-003;
  B1.u_e(8) : 4.444598913432853e-003;
  B1.u_e(9) : 4.444682807796472e-003;
  B1.u_mf(0) : 5.652831513958724e-003;
  B1.u_mf(1) : 4.446649355716879e-003;
  B1.u_mf(10) : 4.407602629597462e-003;
  B1.u_mf(11) : 4.373624081322221e-003;
  B1.u_mf(12) : 4.344943818776001e-003;
  B1.u_mf(13) : 4.321367285986676e-003;
  B1.u_mf(14) : 4.302429215625966e-003;
  B1.u_mf(15) : 4.287532614215541e-003;
  B1.u_mf(16) : 4.276032334551624e-003;
  B1.u_mf(17) : 4.267293839325632e-003;
  B1.u_mf(18) : 4.260736194560206e-003;
  B1.u_mf(19) : 4.255858730819577e-003;
  B1.u_mf(2) : 4.44635642232384e-003;
  B1.u_mf(20) : 4.255948453509341e-003;
  B1.u_mf(21) : 4.257065034078012e-003;
  B1.u_mf(22) : 4.257065034078036e-003;
  B1.u_mf(23) : 4.257065034078036e-003;
  B1.u_mf(24) : 4.25706503407804e-003;
  B1.u_mf(25) : 4.257065034078037e-003;
  B1.u_mf(3) : 4.445656058736535e-003;
  B1.u_mf(4) : 4.445119085160544e-003;
  B1.u_mf(5) : 4.444791703590557e-003;
  B1.u_mf(6) : 4.44462471005621e-003;
  B1.u_mf(7) : 4.444571659435653e-003;
  B1.u_mf(8) : 4.444598913432853e-003;
  B1.u_mf(9) : 4.444682807796472e-003;
  B1.u_mf_0 : 5.652831513958724e-003;
  B1.u_mf_1 : 4.446649355716879e-003;
  B1.u_per(10) : 5.64763422292024;
  B1.u_per(11) : 4.486541876253909;
  B1.u_per(12) : 3.493445407296882;
  B1.u_per(13) : 2.665796454590851;
  B1.u_per(14) : 1.981819354997561;
  B1.u_per(15) : 1.425231750078722;
  B1.u_per(16) : 0.9803562443358516;
  B1.u_per(17) : 0.6310660819173022;
  B1.u_per(18) : 0.3612000099139118;
  B1.u_per(19) : 0.155420742319758;
  B1.u_per(20) : 2.28670843052778e-007;
  B1.u_per(21) : 2.28670843052778e-007;
  B1.u_per(22) : 2.28670843052778e-007;
  B1.u_per(23) : 2.28670843052778e-007;
  B1.u_per(24) : 2.28670843052778e-007;
  B1.u_per(25) : 2.28670843052778e-007;
  B1.u_per_p(10) : 88.70107867762967;
  B1.u_per_p(11) : 88.70107867762967;
  B1.u_per_p(12) : 88.70107867762967;
  B1.u_per_p(13) : 88.70107867762967;
  B1.u_per_p(14) : 88.70107867762967;
  B1.u_per_p(15) : 88.70107867762967;
  B1.u_per_p(16) : 88.70107867762967;
  B1.u_per_p(17) : 88.70107867762967;
  B1.u_per_p(18) : 88.70107867762967;
  B1.u_per_p(19) : 88.70107867762967;
  B1.u_per_p(20) : 88.70107867762967;
  B1.u_per_p(21) : 88.70107867762967;
  B1.u_per_p(22) : 88.70107867762967;
  B1.u_per_p(23) : 88.70107867762967;
  B1.u_per_p(24) : 88.70107867762967;
  B1.u_per_p(25) : 88.70107867762967;
  B1.u_ret(0) : 2.382914847622937e-002;
  B1.u_ret(1) : 3.588837826465281e-002;
  B1.u_ret(10) : 3.980323314440896e-002;
  B1.u_ret(11) : 3.787522090017303e-002;
  B1.u_ret(12) : 3.631935893531676e-002;
  B1.u_ret(13) : 3.505054099605019e-002;
  B1.u_ret(14) : 3.402325680319526e-002;
  B1.u_ret(15) : 3.320417761311524e-002;
  B1.u_ret(16) : 3.256268781583303e-002;
  B1.u_ret(17) : 3.206904344753819e-002;
  B1.u_ret(18) : 3.169508719368706e-002;
  B1.u_ret(19) : 3.141544583993206e-002;
  B1.u_ret(2) : 3.615537081403625e-002;
  B1.u_ret(20) : 3.14638131442745e-002;
  B1.u_ret(21) : 3.140267156732294e-002;
  B1.u_ret(22) : 3.140267156732295e-002;
  B1.u_ret(23) : 3.140267156732295e-002;
  B1.u_ret(24) : 3.140267156732295e-002;
  B1.u_ret(25) : 3.140267156732295e-002;
  B1.u_ret(3) : 3.635167053214319e-002;
  B1.u_ret(4) : 3.649675785405852e-002;
  B1.u_ret(5) : 3.660615547361783e-002;
  B1.u_ret(6) : 3.669133094996799e-002;
  B1.u_ret(7) : 3.675950980433941e-002;
  B1.u_ret(8) : 3.681523833065561e-002;
  B1.u_ret(9) : 3.686150595329707e-002;
  B1.WHSV_EtOH : 0.1263575102292072;
  B1.z_b("CH4",0) : 0.;
  B1.z_b("CH4",1) : 9.858177012268288e-002;
  B1.z_b("CH4",10) : 9.4598930237162e-002;
  B1.z_b("CH4",11) : 8.216243141059558e-002;
  B1.z_b("CH4",12) : 6.977454521600893e-002;
  B1.z_b("CH4",13) : 5.855079411572052e-002;
  B1.z_b("CH4",14) : 4.886394401896312e-002;
  B1.z_b("CH4",15) : 4.081567190042885e-002;
  B1.z_b("CH4",16) : 3.434843341896875e-002;
  B1.z_b("CH4",17) : 2.930229432716325e-002;
  B1.z_b("CH4",18) : 2.546188547422934e-002;
  B1.z_b("CH4",19) : 2.25967334323947e-002;
  B1.z_b("CH4",2) : 9.960816765663237e-002;
  B1.z_b("CH4",20) : 2.255706437375166e-002;
  B1.z_b("CH4",21) : 2.260821471501673e-002;
  B1.z_b("CH4",22) : 2.260818445549222e-002;
  B1.z_b("CH4",23) : 2.260817917254522e-002;
  B1.z_b("CH4",24) : 2.260817825030374e-002;
  B1.z_b("CH4",25) : 2.260817808931145e-002;
  B1.z_b("CH4",3) : 9.959826275838424e-002;
  B1.z_b("CH4",4) : 9.997744422463178e-002;
  B1.z_b("CH4",5) : 0.1005650999623606;
  B1.z_b("CH4",6) : 0.1012140119445441;
  B1.z_b("CH4",7) : 0.1018476057545667;
  B1.z_b("CH4",8) : 0.1024315767850048;
  B1.z_b("CH4",9) : 0.1029536935075052;
  B1.z_b("CO",0) : 0.;
  B1.z_b("CO",1) : 2.566202951244234e-002;
  B1.z_b("CO",10) : 1.1111390500419e-002;
  B1.z_b("CO",11) : 1.228515744915094e-002;
  B1.z_b("CO",12) : 1.282216276293433e-002;
  B1.z_b("CO",13) : 1.293801046958329e-002;
  B1.z_b("CO",14) : 1.278393012833028e-002;
  B1.z_b("CO",15) : 1.247197384565804e-002;
  B1.z_b("CO",16) : 1.208360760333334e-002;
  B1.z_b("CO",17) : 1.167737728770086e-002;
  B1.z_b("CO",18) : 1.129294899945908e-002;
  B1.z_b("CO",19) : 1.095364723109766e-002;
  B1.z_b("CO",2) : 1.653931823734099e-002;
  B1.z_b("CO",20) : 1.093441786435487e-002;
  B1.z_b("CO",21) : 1.095921272223313e-002;
  B1.z_b("CO",22) : 1.095919805408838e-002;
  B1.z_b("CO",23) : 1.095919549320771e-002;
  B1.z_b("CO",24) : 1.095919504615603e-002;
  B1.z_b("CO",25) : 1.095919496811586e-002;
  B1.z_b("CO",3) : 1.244551193525843e-002;
  B1.z_b("CO",4) : 1.04208278144284e-002;
  B1.z_b("CO",5) : 9.296956985288443e-003;
  B1.z_b("CO",6) : 8.614930628496127e-003;
  B1.z_b("CO",7) : 8.171665318598566e-003;
  B1.z_b("CO",8) : 7.867619099926573e-003;
  B1.z_b("CO",9) : 7.649828341744677e-003;
  B1.z_b("CO2",0) : 0.;
  B1.z_b("CO2",1) : 6.61117574607021e-002;
  B1.z_b("CO2",10) : 0.1206741629826931;
  B1.z_b("CO2",11) : 0.1455383972172359;
  B1.z_b("CO2",12) : 0.169476808944281;
  B1.z_b("CO2",13) : 0.191493930819697;
  B1.z_b("CO2",14) : 0.2110246587548706;
  B1.z_b("CO2",15) : 0.2278010242474038;
  B1.z_b("CO2",16) : 0.2418041060685089;
  B1.z_b("CO2",17) : 0.2532085688733408;
  B1.z_b("CO2",18) : 0.26231524025869;
  B1.z_b("CO2",19) : 0.2694833539648148;
  B1.z_b("CO2",2) : 8.021748186016867e-002;
  B1.z_b("CO2",20) : 0.2690102700563206;
  B1.z_b("CO2",21) : 0.2696202770540966;
  B1.z_b("CO2",22) : 0.2696199161860898;
  B1.z_b("CO2",23) : 0.2696198531829004;
  B1.z_b("CO2",24) : 0.2696198421844643;
  B1.z_b("CO2",25) : 0.269619840264508;
  B1.z_b("CO2",3) : 8.715537305668714e-002;
  B1.z_b("CO2",4) : 9.136860580680203e-002;
  B1.z_b("CO2",5) : 9.424802040985378e-002;
  B1.z_b("CO2",6) : 9.637899280919654e-002;
  B1.z_b("CO2",7) : 9.804528006837121e-002;
  B1.z_b("CO2",8) : 9.939927463030641e-002;
  B1.z_b("CO2",9) : 0.1005300549594844;
  B1.z_b("ETOH",0) : 0.1373429559295117;
  B1.z_b("ETOH",1) : 2.018218547979473e-002;
  B1.z_b("ETOH",10) : 8.010413773018685e-003;
  B1.z_b("ETOH",11) : 7.539313610180611e-003;
  B1.z_b("ETOH",12) : 6.975225210619787e-003;
  B1.z_b("ETOH",13) : 6.342367893944944e-003;
  B1.z_b("ETOH",14) : 5.663999307549491e-003;
  B1.z_b("ETOH",15) : 4.961697517760899e-003;
  B1.z_b("ETOH",16) : 4.255578669844929e-003;
  B1.z_b("ETOH",17) : 3.563243500173433e-003;
  B1.z_b("ETOH",18) : 2.89875588705861e-003;
  B1.z_b("ETOH",19) : 2.272219239572565e-003;
  B1.z_b("ETOH",2) : 1.806582714994837e-002;
  B1.z_b("ETOH",20) : 2.268230309118668e-003;
  B1.z_b("ETOH",21) : 2.273373742345982e-003;
  B1.z_b("ETOH",22) : 2.273370699593191e-003;
  B1.z_b("ETOH",23) : 2.273370168365354e-003;
  B1.z_b("ETOH",24) : 2.27337007562917e-003;
  B1.z_b("ETOH",25) : 2.273370059440557e-003;
  B1.z_b("ETOH",3) : 1.611263528133192e-002;
  B1.z_b("ETOH",4) : 1.439378808030438e-002;
  B1.z_b("ETOH",5) : 1.289603530348426e-002;
  B1.z_b("ETOH",6) : 1.159510395149782e-002;
  B1.z_b("ETOH",7) : 1.046560954903294e-002;
  B1.z_b("ETOH",8) : 9.483869716920829e-003;
  B1.z_b("ETOH",9) : 8.628746520420557e-003;
  B1.z_b("H2",0) : 0.;
  B1.z_b("H2",1) : 7.404084832837461e-002;
  B1.z_b("H2",10) : 9.359318192788665e-002;
  B1.z_b("H2",11) : 8.248514259976399e-002;
  B1.z_b("H2",12) : 7.549832395611782e-002;
  B1.z_b("H2",13) : 7.03730538920434e-002;
  B1.z_b("H2",14) : 6.624054709939369e-002;
  B1.z_b("H2",15) : 6.280039975724594e-002;
  B1.z_b("H2",16) : 5.994687298356585e-002;
  B1.z_b("H2",17) : 5.762358556561525e-002;
  B1.z_b("H2",18) : 5.577513573278523e-002;
  B1.z_b("H2",19) : 5.433706536468495e-002;
  B1.z_b("H2",2) : 9.316370907748268e-002;
  B1.z_b("H2",20) : 5.424167546069871e-002;
  B1.z_b("H2",21) : 5.436467374472267e-002;
  B1.z_b("H2",22) : 5.436460098138427e-002;
  B1.z_b("H2",23) : 5.436458827778544e-002;
  B1.z_b("H2",24) : 5.436458606012438e-002;
  B1.z_b("H2",25) : 5.436458567299549e-002;
  B1.z_b("H2",3) : 0.103451978636043;
  B1.z_b("H2",4) : 0.1094196872946437;
  B1.z_b("H2",5) : 0.11308688828513;
  B1.z_b("H2",6) : 0.1154685972778271;
  B1.z_b("H2",7) : 0.1170944025700984;
  B1.z_b("H2",8) : 0.1182525999922008;
  B1.z_b("H2",9) : 0.1191076353781117;
  B1.z_b("H2O",0) : 0.495573891671925;
  B1.z_b("H2O",1) : 0.4319844160896567;
  B1.z_b("H2O",10) : 0.4012652162172715;
  B1.z_b("H2O",11) : 0.3870040507999151;
  B1.z_b("H2O",12) : 0.3707735955532775;
  B1.z_b("H2O",13) : 0.3553795081854249;
  B1.z_b("H2O",14) : 0.3417555947807412;
  B1.z_b("H2O",15) : 0.3302356509806025;
  B1.z_b("H2O",16) : 0.3208441583719195;
  B1.z_b("H2O",17) : 0.3134225570252124;
  B1.z_b("H2O",18) : 0.3077122622275136;
  B1.z_b("H2O",19) : 0.3034178272419207;
  B1.z_b("H2O",2) : 0.4220763437921085;
  B1.z_b("H2O",20) : 0.3028851706250514;
  B1.z_b("H2O",21) : 0.3035719922603885;
  B1.z_b("H2O",22) : 0.3035715859503699;
  B1.z_b("H2O",23) : 0.3035715150135548;
  B1.z_b("H2O",24) : 0.3035715026301497;
  B1.z_b("H2O",25) : 0.3035715004684244;
  B1.z_b("H2O",3) : 0.4140132550515986;
  B1.z_b("H2O",4) : 0.4094772709557272;
  B1.z_b("H2O",5) : 0.4068802307514745;
  B1.z_b("H2O",6) : 0.4053567538825879;
  B1.z_b("H2O",7) : 0.4044563909986959;
  B1.z_b("H2O",8) : 0.4039347977286097;
  B1.z_b("H2O",9) : 0.4036525860708658;
  B1.z_b("N2",0) : 0.2899956903948652;
  B1.z_b("N2",1) : 0.2438860581500538;
  B1.z_b("N2",10) : 0.2559848568392311;
  B1.z_b("N2",11) : 0.2693860348163623;
  B1.z_b("N2",12) : 0.2809431868615965;
  B1.z_b("N2",13) : 0.2911045806153449;
  B1.z_b("N2",14) : 0.2998827893830579;
  B1.z_b("N2",15) : 0.3072679695294883;
  B1.z_b("N2",16) : 0.3133085478739149;
  B1.z_b("N2",17) : 0.3181191962564672;
  B1.z_b("N2",18) : 0.3218615482239585;
  B1.z_b("N2",19) : 0.3247171529921296;
  B1.z_b("N2",2) : 0.2454712043950035;
  B1.z_b("N2",20) : 0.3241471049440489;
  B1.z_b("N2",21) : 0.3248821400870479;
  B1.z_b("N2",22) : 0.3248817052548771;
  B1.z_b("N2",23) : 0.3248816293384393;
  B1.z_b("N2",24) : 0.3248816160857438;
  B1.z_b("N2",25) : 0.3248816137722697;
  B1.z_b("N2",3) : 0.2442802387433362;
  B1.z_b("N2",4) : 0.2433164205350312;
  B1.z_b("N2",5) : 0.2425887355929007;
  B1.z_b("N2",6) : 0.2420247543381792;
  B1.z_b("N2",7) : 0.241575193010707;
  B1.z_b("N2",8) : 0.2412089624345405;
  B1.z_b("N2",9) : 0.2409057273057416;
  B1.z_b("O2",0) : 7.708746200369833e-002;
  B1.z_b("O2",1) : 2.592739358561396e-002;
  B1.z_b("O2",10) : 1.637526525501371e-002;
  B1.z_b("O2",11) : 1.64279135922581e-002;
  B1.z_b("O2",12) : 1.631718158100844e-002;
  B1.z_b("O2",13) : 1.607084486871376e-002;
  B1.z_b("O2",14) : 1.570755772588944e-002;
  B1.z_b("O2",15) : 1.524561441805781e-002;
  B1.z_b("O2",16) : 1.470542592374486e-002;
  B1.z_b("O2",17) : 1.410857478307162e-002;
  B1.z_b("O2",18) : 1.347586413001856e-002;
  B1.z_b("O2",19) : 1.282562192717472e-002;
  B1.z_b("O2",2) : 2.450129178207905e-002;
  B1.z_b("O2",20) : 1.280310626799905e-002;
  B1.z_b("O2",21) : 1.283213855890308e-002;
  B1.z_b("O2",22) : 1.283212138397724e-002;
  B1.z_b("O2",23) : 1.283211838544291e-002;
  B1.z_b("O2",24) : 1.283211786199023e-002;
  B1.z_b("O2",25) : 1.283211777061303e-002;
  B1.z_b("O2",3) : 2.300864582073443e-002;
  B1.z_b("O2",4) : 2.164134675485931e-002;
  B1.z_b("O2",5) : 2.039779464528792e-002;
  B1.z_b("O2",6) : 1.92667579068666e-002;
  B1.z_b("O2",7) : 1.823676777146824e-002;
  B1.z_b("O2",8) : 1.729722986950425e-002;
  B1.z_b("O2",9) : 1.643854093086729e-002;
  B1.z_cross("CH4") : 0.;
  B1.z_cross("CO") : 0.;
  B1.z_cross("CO2") : 0.;
  B1.z_cross("ETOH") : 0.;
  B1.z_cross("H2") : 1.;
  B1.z_cross("H2O") : 0.;
  B1.z_cross("N2") : 0.;
  B1.z_cross("O2") : 0.;
  B1.z_e("CH4",0) : 0.;
  B1.z_e("CH4",1) : 0.1135136008431011;
  B1.z_e("CH4",10) : 8.36276195398583e-002;
  B1.z_e("CH4",11) : 6.837015425313861e-002;
  B1.z_e("CH4",12) : 5.763442827067145e-002;
  B1.z_e("CH4",13) : 4.840665164330976e-002;
  B1.z_e("CH4",14) : 4.06322388766059e-002;
  B1.z_e("CH4",15) : 3.430316892065425e-002;
  B1.z_e("CH4",16) : 2.931509047195255e-002;
  B1.z_e("CH4",17) : 2.549296452825294e-002;
  B1.z_e("CH4",18) : 2.262990669629134e-002;
  B1.z_e("CH4",19) : 2.05208679429872e-002;
  B1.z_e("CH4",2) : 0.1000968252831107;
  B1.z_e("CH4",20) : 2.76722992016327e-002;
  B1.z_e("CH4",21) : 1.947012406414759e-002;
  B1.z_e("CH4",22) : 1.947031724893689e-002;
  B1.z_e("CH4",23) : 1.947035097711069e-002;
  B1.z_e("CH4",24) : 1.947035686503513e-002;
  B1.z_e("CH4",25) : 1.947035789286876e-002;
  B1.z_e("CH4",3) : 9.978916406225687e-002;
  B1.z_e("CH4",4) : 0.1007962508013502;
  B1.z_e("CH4",5) : 0.102056326775221;
  B1.z_e("CH4",6) : 0.1032601378193889;
  B1.z_e("CH4",7) : 0.1042971594414095;
  B1.z_e("CH4",8) : 0.1051421225906864;
  B1.z_e("CH4",9) : 0.10580580333312;
  B1.z_e("CO",0) : 0.;
  B1.z_e("CO",1) : 2.968380051642044e-002;
  B1.z_e("CO",10) : 1.376119255446221e-002;
  B1.z_e("CO",11) : 1.27270045429973e-002;
  B1.z_e("CO",12) : 1.278577659581645e-002;
  B1.z_e("CO",13) : 1.263721480230456e-002;
  B1.z_e("CO",14) : 1.235126194431023e-002;
  B1.z_e("CO",15) : 1.199334629018209e-002;
  B1.z_e("CO",16) : 1.161244294223839e-002;
  B1.z_e("CO",17) : 1.124559215206942e-002;
  B1.z_e("CO",18) : 1.091753696507837e-002;
  B1.z_e("CO",19) : 1.06407333137024e-002;
  B1.z_e("CO",2) : 1.219600044062851e-002;
  B1.z_e("CO",20) : 1.088386021957193e-002;
  B1.z_e("CO",21) : 2.688895490602283e-003;
  B1.z_e("CO",22) : 2.688922170129701e-003;
  B1.z_e("CO",23) : 2.688926828114117e-003;
  B1.z_e("CO",24) : 2.688927641258061e-003;
  B1.z_e("CO",25) : 2.688927783205653e-003;
  B1.z_e("CO",3) : 8.752029570432762e-003;
  B1.z_e("CO",4) : 7.554538703047779e-003;
  B1.z_e("CO",5) : 7.050784822526746e-003;
  B1.z_e("CO",6) : 6.816538547818576e-003;
  B1.z_e("CO",7) : 6.700349671390348e-003;
  B1.z_e("CO",8) : 6.640123745947984e-003;
  B1.z_e("CO",9) : 6.607954991137229e-003;
  B1.z_e("CO2",0) : 0.;
  B1.z_e("CO2",1) : 7.739569161637552e-002;
  B1.z_e("CO2",10) : 0.1347321476948166;
  B1.z_e("CO2",11) : 0.1610491285158437;
  B1.z_e("CO2",12) : 0.1834220419905008;
  B1.z_e("CO2",13) : 0.2035114929452156;
  B1.z_e("CO2",14) : 0.2210934484504724;
  B1.z_e("CO2",15) : 0.2360538042693812;
  B1.z_e("CO2",16) : 0.2484510145027982;
  B1.z_e("CO2",17) : 0.258491046832608;
  B1.z_e("CO2",18) : 0.2664755589372824;
  B1.z_e("CO2",19) : 0.2727448490688118;
  B1.z_e("CO2",2) : 8.751054855503193e-002;
  B1.z_e("CO2",20) : 0.2851531391198255;
  B1.z_e("CO2",21) : 0.28503066968567;
  B1.z_e("CO2",22) : 0.2850334977924496;
  B1.z_e("CO2",23) : 0.285033991552219;
  B1.z_e("CO2",24) : 0.28503407774782;
  B1.z_e("CO2",25) : 0.2850340927946737;
  B1.z_e("CO2",3) : 9.41567881521518e-002;
  B1.z_e("CO2",4) : 9.816908494023431e-002;
  B1.z_e("CO2",5) : 0.1008886134393254;
  B1.z_e("CO2",6) : 0.1029164706910522;
  B1.z_e("CO2",7) : 0.1045180001252837;
  B1.z_e("CO2",8) : 0.105822700997561;
  B1.z_e("CO2",9) : 0.1069033336360815;
  B1.z_e("ETOH",0) : 0.1373429559295117;
  B1.z_e("ETOH",1) : 2.420362145129729e-002;
  B1.z_e("ETOH",10) : 6.887319838717467e-003;
  B1.z_e("ETOH",11) : 6.595295849829434e-003;
  B1.z_e("ETOH",12) : 6.068254064398071e-003;
  B1.z_e("ETOH",13) : 5.470070518217378e-003;
  B1.z_e("ETOH",14) : 4.831714447605743e-003;
  B1.z_e("ETOH",15) : 4.174839759296128e-003;
  B1.z_e("ETOH",16) : 3.518426406732703e-003;
  B1.z_e("ETOH",17) : 2.878533617245047e-003;
  B1.z_e("ETOH",18) : 2.267653704530094e-003;
  B1.z_e("ETOH",19) : 1.694505658861761e-003;
  B1.z_e("ETOH",2) : 1.678958760033131e-002;
  B1.z_e("ETOH",20) : 0.;
  B1.z_e("ETOH",21) : 0.;
  B1.z_e("ETOH",22) : 0.;
  B1.z_e("ETOH",23) : 0.;
  B1.z_e("ETOH",24) : 0.;
  B1.z_e("ETOH",25) : 0.;
  B1.z_e("ETOH",3) : 1.390305029723339e-002;
  B1.z_e("ETOH",4) : 1.132745534631809e-002;
  B1.z_e("ETOH",5) : 9.099448340404891e-003;
  B1.z_e("ETOH",6) : 7.218259552886043e-003;
  B1.z_e("ETOH",7) : 5.656085831237348e-003;
  B1.z_e("ETOH",8) : 4.374334125985203e-003;
  B1.z_e("ETOH",9) : 3.331966809132122e-003;
  B1.z_e("H2",0) : 0.;
  B1.z_e("H2",1) : 8.106561473446937e-002;
  B1.z_e("H2",10) : 8.674050215782775e-002;
  B1.z_e("H2",11) : 8.147222482149535e-002;
  B1.z_e("H2",12) : 7.58636970338443e-002;
  B1.z_e("H2",13) : 7.103778639300459e-002;
  B1.z_e("H2",14) : 6.684985919614067e-002;
  B1.z_e("H2",15) : 6.327033679058881e-002;
  B1.z_e("H2",16) : 6.028383427983661e-002;
  B1.z_e("H2",17) : 5.785801834353859e-002;
  B1.z_e("H2",18) : 5.593823849226255e-002;
  B1.z_e("H2",19) : 5.44534943975416e-002;
  B1.z_e("H2",2) : 9.87250160855406e-002;
  B1.z_e("H2",20) : 6.036652906018868e-002;
  B1.z_e("H2",21) : 5.215031219115184e-002;
  B1.z_e("H2",22) : 5.215082963249115e-002;
  B1.z_e("H2",23) : 5.215091997268557e-002;
  B1.z_e("H2",24) : 5.215093574336566e-002;
  B1.z_e("H2",25) : 5.215093849639612e-002;
  B1.z_e("H2",3) : 0.1093018853255467;
  B1.z_e("H2",4) : 0.1148645481372062;
  B1.z_e("H2",5) : 0.1179007513313326;
  B1.z_e("H2",6) : 0.1196681523754329;
  B1.z_e("H2",7) : 0.1207661566854649;
  B1.z_e("H2",8) : 0.1214864495797731;
  B1.z_e("H2",9) : 0.1219788402744529;
  B1.z_e("H2O",0) : 0.495573891671925;
  B1.z_e("H2O",1) : 0.4945832176409744;
  B1.z_e("H2O",10) : 0.3842009187841008;
  B1.z_e("H2O",11) : 0.3597238104472584;
  B1.z_e("H2O",12) : 0.3461463987830116;
  B1.z_e("H2O",13) : 0.3344378570614446;
  B1.z_e("H2O",14) : 0.3244850837267458;
  B1.z_e("H2O",15) : 0.3163560114803032;
  B1.z_e("H2O",16) : 0.3099484202039701;
  B1.z_e("H2O",17) : 0.3050480885747091;
  B1.z_e("H2O",18) : 0.3013934638010321;
  B1.z_e("H2O",19) : 0.2987243916584532;
  B1.z_e("H2O",2) : 0.4177998215324359;
  B1.z_e("H2O",20) : 0.3082075077381716;
  B1.z_e("H2O",21) : 0.308075136763086;
  B1.z_e("H2O",22) : 0.3080781935196935;
  B1.z_e("H2O",23) : 0.3080787271994852;
  B1.z_e("H2O",24) : 0.3080788203639213;
  B1.z_e("H2O",25) : 0.3080788366272992;
  B1.z_e("H2O",3) : 0.4080793007902516;
  B1.z_e("H2O",4) : 0.4046748710511048;
  B1.z_e("H2O",5) : 0.4033697627941272;
  B1.z_e("H2O",6) : 0.4030037002212878;
  B1.z_e("H2O",7) : 0.4030848526171018;
  B1.z_e("H2O",8) : 0.4033817382989481;
  B1.z_e("H2O",9) : 0.4037790414124731;
  B1.z_e("N2",0) : 0.2899956903948652;
  B1.z_e("N2",1) : 0.2810337429348793;
  B1.z_e("N2",10) : 0.2589404931439097;
  B1.z_e("N2",11) : 0.2686115044576181;
  B1.z_e("N2",12) : 0.2800014809409283;
  B1.z_e("N2",13) : 0.2902426974305614;
  B1.z_e("N2",14) : 0.2991227849421873;
  B1.z_e("N2",15) : 0.3066169300681623;
  B1.z_e("N2",16) : 0.3127675009477392;
  B1.z_e("N2",17) : 0.3176824921303822;
  B1.z_e("N2",18) : 0.3215181323543404;
  B1.z_e("N2",19) : 0.3244529341250738;
  B1.z_e("N2",2) : 0.2462445164110615;
  B1.z_e("N2",20) : 0.3244806161034382;
  B1.z_e("N2",21) : 0.3243412560474042;
  B1.z_e("N2",22) : 0.3243444741983005;
  B1.z_e("N2",23) : 0.3243450360559558;
  B1.z_e("N2",24) : 0.3243451341393991;
  B1.z_e("N2",25) : 0.3243451512614703;
  B1.z_e("N2",3) : 0.2437232240847561;
  B1.z_e("N2",4) : 0.2427009046411438;
  B1.z_e("N2",5) : 0.2419866216720887;
  B1.z_e("N2",6) : 0.2414365356180636;
  B1.z_e("N2",7) : 0.240997857583544;
  B1.z_e("N2",8) : 0.2406403892347503;
  B1.z_e("N2",9) : 0.2403445380515974;
  B1.z_e("O2",0) : 7.708746200369833e-002;
  B1.z_e("O2",1) : 2.99283184573276e-002;
  B1.z_e("O2",10) : 1.565918932933779e-002;
  B1.z_e("O2",11) : 1.573968797990024e-002;
  B1.z_e("O2",12) : 1.563850169109647e-002;
  B1.z_e("O2",13) : 1.540254140330905e-002;
  B1.z_e("O2",14) : 1.505329370157271e-002;
  B1.z_e("O2",15) : 1.460954604320157e-002;
  B1.z_e("O2",16) : 1.409121845806205e-002;
  B1.z_e("O2",17) : 1.351898481782646e-002;
  B1.z_e("O2",18) : 1.291265532181098e-002;
  B1.z_e("O2",19) : 1.228966554137212e-002;
  B1.z_e("O2",2) : 2.383682900199358e-002;
  B1.z_e("O2",20) : 0.;
  B1.z_e("O2",21) : 1.58439042589859e-034;
  B1.z_e("O2",22) : 0.;
  B1.z_e("O2",23) : 3.403744779335878e-026;
  B1.z_e("O2",24) : 4.528038333455419e-040;
  B1.z_e("O2",25) : 0.;
  B1.z_e("O2",3) : 2.172136149483753e-002;
  B1.z_e("O2",4) : 1.978083541469203e-002;
  B1.z_e("O2",5) : 1.798741498657669e-002;
  B1.z_e("O2",6) : 1.635056152630669e-002;
  B1.z_e("O2",7) : 1.486971459504801e-002;
  B1.z_e("O2",8) : 1.353790885404019e-002;
  B1.z_e("O2",9) : 1.234471448921969e-002;
  B1.z_interface("CH4",10) : 0.;
  B1.z_interface("CH4",11) : 0.;
  B1.z_interface("CH4",12) : 0.;
  B1.z_interface("CH4",13) : 0.;
  B1.z_interface("CH4",14) : 0.;
  B1.z_interface("CH4",15) : 0.;
  B1.z_interface("CH4",16) : 0.;
  B1.z_interface("CH4",17) : 0.;
  B1.z_interface("CH4",18) : 0.;
  B1.z_interface("CH4",19) : 0.;
  B1.z_interface("CH4",20) : 0.;
  B1.z_interface("CO",10) : 0.;
  B1.z_interface("CO",11) : 0.;
  B1.z_interface("CO",12) : 0.;
  B1.z_interface("CO",13) : 0.;
  B1.z_interface("CO",14) : 0.;
  B1.z_interface("CO",15) : 0.;
  B1.z_interface("CO",16) : 0.;
  B1.z_interface("CO",17) : 0.;
  B1.z_interface("CO",18) : 0.;
  B1.z_interface("CO",19) : 0.;
  B1.z_interface("CO",20) : 0.;
  B1.z_interface("CO2",10) : 0.;
  B1.z_interface("CO2",11) : 0.;
  B1.z_interface("CO2",12) : 0.;
  B1.z_interface("CO2",13) : 0.;
  B1.z_interface("CO2",14) : 0.;
  B1.z_interface("CO2",15) : 0.;
  B1.z_interface("CO2",16) : 0.;
  B1.z_interface("CO2",17) : 0.;
  B1.z_interface("CO2",18) : 0.;
  B1.z_interface("CO2",19) : 0.;
  B1.z_interface("CO2",20) : 0.;
  B1.z_interface("ETOH",10) : 0.;
  B1.z_interface("ETOH",11) : 0.;
  B1.z_interface("ETOH",12) : 0.;
  B1.z_interface("ETOH",13) : 0.;
  B1.z_interface("ETOH",14) : 0.;
  B1.z_interface("ETOH",15) : 0.;
  B1.z_interface("ETOH",16) : 0.;
  B1.z_interface("ETOH",17) : 0.;
  B1.z_interface("ETOH",18) : 0.;
  B1.z_interface("ETOH",19) : 0.;
  B1.z_interface("ETOH",20) : 0.;
  B1.z_interface("H2",10) : 1.;
  B1.z_interface("H2",11) : 1.;
  B1.z_interface("H2",12) : 1.;
  B1.z_interface("H2",13) : 1.;
  B1.z_interface("H2",14) : 1.;
  B1.z_interface("H2",15) : 1.;
  B1.z_interface("H2",16) : 1.;
  B1.z_interface("H2",17) : 1.;
  B1.z_interface("H2",18) : 1.;
  B1.z_interface("H2",19) : 1.;
  B1.z_interface("H2",20) : 1.;
  B1.z_interface("H2O",10) : 0.;
  B1.z_interface("H2O",11) : 0.;
  B1.z_interface("H2O",12) : 0.;
  B1.z_interface("H2O",13) : 0.;
  B1.z_interface("H2O",14) : 0.;
  B1.z_interface("H2O",15) : 0.;
  B1.z_interface("H2O",16) : 1.937150955200187e-022;
  B1.z_interface("H2O",17) : 1.192092895507807e-022;
  B1.z_interface("H2O",18) : 2.235174179077177e-023;
  B1.z_interface("H2O",19) : 0.;
  B1.z_interface("H2O",20) : 0.;
  B1.z_interface("N2",10) : 0.;
  B1.z_interface("N2",11) : 0.;
  B1.z_interface("N2",12) : 0.;
  B1.z_interface("N2",13) : 0.;
  B1.z_interface("N2",14) : 0.;
  B1.z_interface("N2",15) : 0.;
  B1.z_interface("N2",16) : 0.;
  B1.z_interface("N2",17) : 0.;
  B1.z_interface("N2",18) : 0.;
  B1.z_interface("N2",19) : 0.;
  B1.z_interface("N2",20) : 0.;
  B1.z_interface("O2",10) : 0.;
  B1.z_interface("O2",11) : 0.;
  B1.z_interface("O2",12) : 0.;
  B1.z_interface("O2",13) : 0.;
  B1.z_interface("O2",14) : 0.;
  B1.z_interface("O2",15) : 0.;
  B1.z_interface("O2",16) : 0.;
  B1.z_interface("O2",17) : 0.;
  B1.z_interface("O2",18) : 0.;
  B1.z_interface("O2",19) : 0.;
  B1.z_interface("O2",20) : 0.;
  B1.z_per("CH4",10) : 0.;
  B1.z_per("CH4",11) : 0.;
  B1.z_per("CH4",12) : 0.;
  B1.z_per("CH4",13) : 0.;
  B1.z_per("CH4",14) : 0.;
  B1.z_per("CH4",15) : 0.;
  B1.z_per("CH4",16) : 0.;
  B1.z_per("CH4",17) : 0.;
  B1.z_per("CH4",18) : 0.;
  B1.z_per("CH4",19) : 0.;
  B1.z_per("CH4",20) : 0.;
  B1.z_per("CH4",21) : 0.;
  B1.z_per("CH4",22) : 0.;
  B1.z_per("CH4",23) : 0.;
  B1.z_per("CH4",24) : 0.;
  B1.z_per("CH4",25) : 0.;
  B1.z_per("CO",10) : 0.;
  B1.z_per("CO",11) : 0.;
  B1.z_per("CO",12) : 0.;
  B1.z_per("CO",13) : 0.;
  B1.z_per("CO",14) : 0.;
  B1.z_per("CO",15) : 0.;
  B1.z_per("CO",16) : 0.;
  B1.z_per("CO",17) : 0.;
  B1.z_per("CO",18) : 0.;
  B1.z_per("CO",19) : 0.;
  B1.z_per("CO",20) : 0.;
  B1.z_per("CO",21) : 0.;
  B1.z_per("CO",22) : 0.;
  B1.z_per("CO",23) : 0.;
  B1.z_per("CO",24) : 0.;
  B1.z_per("CO",25) : 0.;
  B1.z_per("CO2",10) : 0.;
  B1.z_per("CO2",11) : 0.;
  B1.z_per("CO2",12) : 0.;
  B1.z_per("CO2",13) : 0.;
  B1.z_per("CO2",14) : 0.;
  B1.z_per("CO2",15) : 0.;
  B1.z_per("CO2",16) : 0.;
  B1.z_per("CO2",17) : 0.;
  B1.z_per("CO2",18) : 0.;
  B1.z_per("CO2",19) : 0.;
  B1.z_per("CO2",20) : 0.;
  B1.z_per("CO2",21) : 0.;
  B1.z_per("CO2",22) : 0.;
  B1.z_per("CO2",23) : 0.;
  B1.z_per("CO2",24) : 0.;
  B1.z_per("CO2",25) : 0.;
  B1.z_per("ETOH",10) : 0.;
  B1.z_per("ETOH",11) : 0.;
  B1.z_per("ETOH",12) : 0.;
  B1.z_per("ETOH",13) : 0.;
  B1.z_per("ETOH",14) : 0.;
  B1.z_per("ETOH",15) : 0.;
  B1.z_per("ETOH",16) : 0.;
  B1.z_per("ETOH",17) : 0.;
  B1.z_per("ETOH",18) : 0.;
  B1.z_per("ETOH",19) : 0.;
  B1.z_per("ETOH",20) : 0.;
  B1.z_per("ETOH",21) : 0.;
  B1.z_per("ETOH",22) : 0.;
  B1.z_per("ETOH",23) : 0.;
  B1.z_per("ETOH",24) : 0.;
  B1.z_per("ETOH",25) : 0.;
  B1.z_per("H2",10) : 1.;
  B1.z_per("H2",11) : 1.;
  B1.z_per("H2",12) : 1.;
  B1.z_per("H2",13) : 1.;
  B1.z_per("H2",14) : 1.;
  B1.z_per("H2",15) : 1.;
  B1.z_per("H2",16) : 1.;
  B1.z_per("H2",17) : 1.;
  B1.z_per("H2",18) : 1.;
  B1.z_per("H2",19) : 1.;
  B1.z_per("H2",20) : 1.;
  B1.z_per("H2",21) : 1.;
  B1.z_per("H2",22) : 1.;
  B1.z_per("H2",23) : 1.;
  B1.z_per("H2",24) : 1.;
  B1.z_per("H2",25) : 1.;
  B1.z_per("H2O",10) : 0.;
  B1.z_per("H2O",11) : 0.;
  B1.z_per("H2O",12) : 0.;
  B1.z_per("H2O",13) : 0.;
  B1.z_per("H2O",14) : 0.;
  B1.z_per("H2O",15) : 0.;
  B1.z_per("H2O",16) : 0.;
  B1.z_per("H2O",17) : 0.;
  B1.z_per("H2O",18) : 0.;
  B1.z_per("H2O",19) : 0.;
  B1.z_per("H2O",20) : 0.;
  B1.z_per("H2O",21) : 0.;
  B1.z_per("H2O",22) : 0.;
  B1.z_per("H2O",23) : 0.;
  B1.z_per("H2O",24) : 0.;
  B1.z_per("H2O",25) : 0.;
  B1.z_per("N2",10) : 0.;
  B1.z_per("N2",11) : 0.;
  B1.z_per("N2",12) : 0.;
  B1.z_per("N2",13) : 0.;
  B1.z_per("N2",14) : 0.;
  B1.z_per("N2",15) : 0.;
  B1.z_per("N2",16) : 0.;
  B1.z_per("N2",17) : 0.;
  B1.z_per("N2",18) : 0.;
  B1.z_per("N2",19) : 0.;
  B1.z_per("N2",20) : 0.;
  B1.z_per("N2",21) : 0.;
  B1.z_per("N2",22) : 0.;
  B1.z_per("N2",23) : 0.;
  B1.z_per("N2",24) : 0.;
  B1.z_per("N2",25) : 0.;
  B1.z_per("O2",10) : 0.;
  B1.z_per("O2",11) : 0.;
  B1.z_per("O2",12) : 0.;
  B1.z_per("O2",13) : 0.;
  B1.z_per("O2",14) : 0.;
  B1.z_per("O2",15) : 0.;
  B1.z_per("O2",16) : 0.;
  B1.z_per("O2",17) : 0.;
  B1.z_per("O2",18) : 0.;
  B1.z_per("O2",19) : 0.;
  B1.z_per("O2",20) : 0.;
  B1.z_per("O2",21) : 0.;
  B1.z_per("O2",22) : 0.;
  B1.z_per("O2",23) : 0.;
  B1.z_per("O2",24) : 0.;
  B1.z_per("O2",25) : 0.;
  B1.z_per_p("CH4") : 0.;
  B1.z_per_p("CO") : 0.;
  B1.z_per_p("CO2") : 0.;
  B1.z_per_p("ETOH") : 0.;
  B1.z_per_p("H2") : 1.;
  B1.z_per_p("H2O") : 0.;
  B1.z_per_p("N2") : 0.;
  B1.z_per_p("O2") : 0.;
  B1.z_pure("CH4","CH4") : 1.;
  B1.z_pure("CH4","CO") : 0.;
  B1.z_pure("CH4","CO2") : 0.;
  B1.z_pure("CH4","ETOH") : 0.;
  B1.z_pure("CH4","H2") : 0.;
  B1.z_pure("CH4","H2O") : 0.;
  B1.z_pure("CH4","N2") : 0.;
  B1.z_pure("CH4","O2") : 0.;
  B1.z_pure("CO","CH4") : 0.;
  B1.z_pure("CO","CO") : 1.;
  B1.z_pure("CO","CO2") : 0.;
  B1.z_pure("CO","ETOH") : 0.;
  B1.z_pure("CO","H2") : 0.;
  B1.z_pure("CO","H2O") : 0.;
  B1.z_pure("CO","N2") : 0.;
  B1.z_pure("CO","O2") : 0.;
  B1.z_pure("CO2","CH4") : 0.;
  B1.z_pure("CO2","CO") : 0.;
  B1.z_pure("CO2","CO2") : 1.;
  B1.z_pure("CO2","ETOH") : 0.;
  B1.z_pure("CO2","H2") : 0.;
  B1.z_pure("CO2","H2O") : 0.;
  B1.z_pure("CO2","N2") : 0.;
  B1.z_pure("CO2","O2") : 0.;
  B1.z_pure("ETOH","CH4") : 0.;
  B1.z_pure("ETOH","CO") : 0.;
  B1.z_pure("ETOH","CO2") : 0.;
  B1.z_pure("ETOH","ETOH") : 1.;
  B1.z_pure("ETOH","H2") : 0.;
  B1.z_pure("ETOH","H2O") : 0.;
  B1.z_pure("ETOH","N2") : 0.;
  B1.z_pure("ETOH","O2") : 0.;
  B1.z_pure("H2","CH4") : 0.;
  B1.z_pure("H2","CO") : 0.;
  B1.z_pure("H2","CO2") : 0.;
  B1.z_pure("H2","ETOH") : 0.;
  B1.z_pure("H2","H2") : 1.;
  B1.z_pure("H2","H2O") : 0.;
  B1.z_pure("H2","N2") : 0.;
  B1.z_pure("H2","O2") : 0.;
  B1.z_pure("H2O","CH4") : 0.;
  B1.z_pure("H2O","CO") : 0.;
  B1.z_pure("H2O","CO2") : 0.;
  B1.z_pure("H2O","ETOH") : 0.;
  B1.z_pure("H2O","H2") : 0.;
  B1.z_pure("H2O","H2O") : 1.;
  B1.z_pure("H2O","N2") : 0.;
  B1.z_pure("H2O","O2") : 0.;
  B1.z_pure("N2","CH4") : 0.;
  B1.z_pure("N2","CO") : 0.;
  B1.z_pure("N2","CO2") : 0.;
  B1.z_pure("N2","ETOH") : 0.;
  B1.z_pure("N2","H2") : 0.;
  B1.z_pure("N2","H2O") : 0.;
  B1.z_pure("N2","N2") : 1.;
  B1.z_pure("N2","O2") : 0.;
  B1.z_pure("O2","CH4") : 0.;
  B1.z_pure("O2","CO") : 0.;
  B1.z_pure("O2","CO2") : 0.;
  B1.z_pure("O2","ETOH") : 0.;
  B1.z_pure("O2","H2") : 0.;
  B1.z_pure("O2","H2O") : 0.;
  B1.z_pure("O2","N2") : 0.;
  B1.z_pure("O2","O2") : 1.;
  B1.z_ret("CH4",0) : 0.;
  B1.z_ret("CH4",1) : 9.998439578493713e-002;
  B1.z_ret("CH4",10) : 9.356158428986662e-002;
  B1.z_ret("CH4",11) : 8.079553743996314e-002;
  B1.z_ret("CH4",12) : 6.85222093793208e-002;
  B1.z_ret("CH4",13) : 5.746793466774757e-002;
  B1.z_ret("CH4",14) : 4.795955964507616e-002;
  B1.z_ret("CH4",15) : 4.008300381830972e-002;
  B1.z_ret("CH4",16) : 3.377128099046436e-002;
  B1.z_ret("CH4",17) : 2.885890941393229e-002;
  B1.z_ret("CH4",18) : 2.512844195198382e-002;
  B1.z_ret("CH4",19) : 2.235017843097365e-002;
  B1.z_ret("CH4",2) : 9.96571812826762e-002;
  B1.z_ret("CH4",20) : 2.31636261025927e-002;
  B1.z_ret("CH4",21) : 2.223521694524609e-002;
  B1.z_ret("CH4",22) : 2.223521694524609e-002;
  B1.z_ret("CH4",23) : 2.223521694524609e-002;
  B1.z_ret("CH4",24) : 2.223521694524609e-002;
  B1.z_ret("CH4",25) : 2.223521694524608e-002;
  B1.z_ret("CH4",3) : 9.961794776858972e-002;
  B1.z_ret("CH4",4) : 0.1000632333693055;
  B1.z_ret("CH4",5) : 0.1007230211350255;
  B1.z_ret("CH4",6) : 0.1014323986309459;
  B1.z_ret("CH4",7) : 0.1021106364165034;
  B1.z_ret("CH4",8) : 0.1027240501282393;
  B1.z_ret("CH4",9) : 0.1032626817086622;
  B1.z_ret("CO",0) : 0.;
  B1.z_ret("CO",1) : 2.603981568772779e-002;
  B1.z_ret("CO",10) : 1.136193134260159e-002;
  B1.z_ret("CO",11) : 1.232894703673384e-002;
  B1.z_ret("CO",12) : 1.281840928171027e-002;
  B1.z_ret("CO",13) : 1.290590135527591e-002;
  B1.z_ret("CO",14) : 1.273639461315858e-002;
  B1.z_ret("CO",15) : 1.241812740072139e-002;
  B1.z_ret("CO",16) : 1.20295811181083e-002;
  B1.z_ret("CO",17) : 1.162711988679605e-002;
  B1.z_ret("CO",18) : 1.124874714597012e-002;
  B1.z_ret("CO",19) : 1.091648177325212e-002;
  B1.z_ret("CO",2) : 1.610367220888501e-002;
  B1.z_ret("CO",20) : 1.092842276667696e-002;
  B1.z_ret("CO",21) : 9.976191444241786e-003;
  B1.z_ret("CO",22) : 9.976191444241786e-003;
  B1.z_ret("CO",23) : 9.976191444241785e-003;
  B1.z_ret("CO",24) : 9.976191444241785e-003;
  B1.z_ret("CO",25) : 9.976191444241785e-003;
  B1.z_ret("CO",3) : 1.206465420117932e-002;
  B1.z_ret("CO",4) : 1.012051697395192e-002;
  B1.z_ret("CO",5) : 9.059086971896295e-003;
  B1.z_ret("CO",6) : 8.422985014505289e-003;
  B1.z_ret("CO",7) : 8.013676893734304e-003;
  B1.z_ret("CO",8) : 7.735169882786013e-003;
  B1.z_ret("CO",9) : 7.536955208476638e-003;
  B1.z_ret("CO2",0) : 0.;
  B1.z_ret("CO2",1) : 6.717171694686833e-002;
  B1.z_ret("CO2",10) : 0.1220033563553832;
  B1.z_ret("CO2",11) : 0.1470755998742537;
  B1.z_ret("CO2",12) : 0.1709153548144883;
  B1.z_ret("CO2",13) : 0.1927767726888393;
  B1.z_ret("CO2",14) : 0.2121308762284272;
  B1.z_ret("CO2",15) : 0.2287294765691278;
  B1.z_ret("CO2",16) : 0.2425662793172096;
  B1.z_ret("CO2",17) : 0.2538234200823401;
  B1.z_ret("CO2",18) : 0.2628050854952587;
  B1.z_ret("CO2",19) : 0.2698707287415324;
  B1.z_ret("CO2",2) : 8.094899534584608e-002;
  B1.z_ret("CO2",20) : 0.2709244825800832;
  B1.z_ret("CO2",21) : 0.2714519775119919;
  B1.z_ret("CO2",22) : 0.2714519775119919;
  B1.z_ret("CO2",23) : 0.2714519775119919;
  B1.z_ret("CO2",24) : 0.2714519775119919;
  B1.z_ret("CO2",25) : 0.2714519775119918;
  B1.z_ret("CO2",3) : 8.787733212544896e-002;
  B1.z_ret("CO2",4) : 9.208111509139817e-002;
  B1.z_ret("CO2",5) : 9.495126033911291e-002;
  B1.z_ret("CO2",6) : 9.70767495550471e-002;
  B1.z_ret("CO2",7) : 9.874031437206567e-002;
  B1.z_ret("CO2",8) : 0.100092375252593;
  B1.z_ret("CO2",9) : 0.1012205150168344;
  B1.z_ret("ETOH",0) : 0.1373429559295117;
  B1.z_ret("ETOH",1) : 2.055994018370994e-002;
  B1.z_ret("ETOH",10) : 7.904224369282342e-003;
  B1.z_ret("ETOH",11) : 7.44575602211828e-003;
  B1.z_ret("ETOH",12) : 6.881664952979035e-003;
  B1.z_ret("ETOH",13) : 6.249252536263558e-003;
  B1.z_ret("ETOH",14) : 5.572559513620097e-003;
  B1.z_ret("ETOH",15) : 4.873174630854527e-003;
  B1.z_ret("ETOH",16) : 4.171052496427824e-003;
  B1.z_ret("ETOH",17) : 3.48354705800555e-003;
  B1.z_ret("ETOH",18) : 2.824448503022219e-003;
  B1.z_ret("ETOH",19) : 2.203602957138962e-003;
  B1.z_ret("ETOH",2) : 1.793781701642191e-002;
  B1.z_ret("ETOH",20) : 1.027647403340686e-003;
  B1.z_ret("ETOH",21) : 2.003157413476845e-003;
  B1.z_ret("ETOH",22) : 2.003157413476845e-003;
  B1.z_ret("ETOH",23) : 2.003157413476845e-003;
  B1.z_ret("ETOH",24) : 2.003157413476845e-003;
  B1.z_ret("ETOH",25) : 2.003157413476845e-003;
  B1.z_ret("ETOH",3) : 1.588479135326143e-002;
  B1.z_ret("ETOH",4) : 1.407251799040421e-002;
  B1.z_ret("ETOH",5) : 1.249397609952024e-002;
  B1.z_ret("ETOH",6) : 1.11279554945858e-002;
  B1.z_ret("ETOH",7) : 9.949167629895032e-003;
  B1.z_ret("ETOH",8) : 8.932540551592582e-003;
  B1.z_ret("ETOH",9) : 8.054910821600854e-003;
  B1.z_ret("H2",0) : 0.;
  B1.z_ret("H2",1) : 7.470072171008133e-002;
  B1.z_ret("H2",10) : 9.294525573349047e-002;
  B1.z_ret("H2",11) : 8.238475662375604e-002;
  B1.z_ret("H2",12) : 7.553601468027747e-002;
  B1.z_ret("H2",13) : 7.04440122673856e-002;
  B1.z_ret("H2",14) : 6.630748977161174e-002;
  B1.z_ret("H2",15) : 6.285326850310492e-002;
  B1.z_ret("H2",16) : 5.998551092906293e-002;
  B1.z_ret("H2",17) : 5.765087224395062e-002;
  B1.z_ret("H2",18) : 5.579433981688015e-002;
  B1.z_ret("H2",19) : 5.435089389091038e-002;
  B1.z_ret("H2",2) : 9.372152257962614e-002;
  B1.z_ret("H2",20) : 5.496795722749767e-002;
  B1.z_ret("H2",21) : 5.410147168562141e-002;
  B1.z_ret("H2",22) : 5.410147168562141e-002;
  B1.z_ret("H2",23) : 5.410147168562141e-002;
  B1.z_ret("H2",24) : 5.410147168562141e-002;
  B1.z_ret("H2",25) : 5.410147168562141e-002;
  B1.z_ret("H2",3) : 0.1040551985749191;
  B1.z_ret("H2",4) : 0.1099901638489527;
  B1.z_ret("H2",5) : 0.1135966771990234;
  B1.z_ret("H2",6) : 0.1159168233295104;
  B1.z_ret("H2",7) : 0.1174886719101124;
  B1.z_ret("H2",8) : 0.1186015388658485;
  B1.z_ret("H2",9) : 0.1194186922764535;
  B1.z_ret("H2O",0) : 0.495573891671925;
  B1.z_ret("H2O",1) : 0.4378646518843309;
  B1.z_ret("H2O",10) : 0.3996517736419921;
  B1.z_ret("H2O",11) : 0.3843004221220867;
  B1.z_ret("H2O",12) : 0.3682331322932064;
  B1.z_ret("H2O",13) : 0.3531440442378843;
  B1.z_ret("H2O",14) : 0.3398581531138922;
  B1.z_ret("H2O",15) : 0.3286741670342862;
  B1.z_ret("H2O",16) : 0.3195947895507885;
  B1.z_ret("H2O",17) : 0.3124478152298358;
  B1.z_ret("H2O",18) : 0.3069682727526668;
  B1.z_ret("H2O",19) : 0.30286037782001;
  B1.z_ret("H2O",2) : 0.4216473975291198;
  B1.z_ret("H2O",20) : 0.3035162904289179;
  B1.z_ret("H2O",21) : 0.3041072422079036;
  B1.z_ret("H2O",22) : 0.3041072422079036;
  B1.z_ret("H2O",23) : 0.3041072422079035;
  B1.z_ret("H2O",24) : 0.3041072422079036;
  B1.z_ret("H2O",25) : 0.3041072422079035;
  B1.z_ret("H2O",3) : 0.4134013684495373;
  B1.z_ret("H2O",4) : 0.4089741072148997;
  B1.z_ret("H2O",5) : 0.4065084715988114;
  B1.z_ret("H2O",6) : 0.405105608242782;
  B1.z_ret("H2O",7) : 0.4043091165583522;
  B1.z_ret("H2O",8) : 0.4038751215039922;
  B1.z_ret("H2O",9) : 0.4036662858268312;
  B1.z_ret("N2",0) : 0.2899956903948652;
  B1.z_ret("N2",1) : 0.2473755362286639;
  B1.z_ret("N2",10) : 0.2562643145472868;
  B1.z_ret("N2",11) : 0.2693092744042534;
  B1.z_ret("N2",12) : 0.2808460434750356;
  B1.z_ret("N2",13) : 0.2910125769439151;
  B1.z_ret("N2",14) : 0.2997992907482371;
  B1.z_ret("N2",15) : 0.3071947264406019;
  B1.z_ret("N2",16) : 0.3132465082808235;
  B1.z_ret("N2",17) : 0.3180683663120825;
  B1.z_ret("N2",18) : 0.3218211136703327;
  B1.z_ret("N2",19) : 0.3246857711497451;
  B1.z_ret("N2",2) : 0.245548769593803;
  B1.z_ret("N2",20) : 0.3241866525134475;
  B1.z_ret("N2",21) : 0.3248178498661521;
  B1.z_ret("N2",22) : 0.324817849866152;
  B1.z_ret("N2",23) : 0.324817849866152;
  B1.z_ret("N2",24) : 0.324817849866152;
  B1.z_ret("N2",25) : 0.324817849866152;
  B1.z_ret("N2",3) : 0.2442228015282835;
  B1.z_ret("N2",4) : 0.2432519308452762;
  B1.z_ret("N2",5) : 0.2425249716264196;
  B1.z_ret("N2",6) : 0.2419619726985825;
  B1.z_ret("N2",7) : 0.2415131993012108;
  B1.z_ret("N2",8) : 0.2411476122428683;
  B1.z_ret("N2",9) : 0.2408449299070262;
  B1.z_ret("O2",0) : 7.708746200369833e-002;
  B1.z_ret("O2",1) : 2.630322157368072e-002;
  B1.z_ret("O2",10) : 1.630755972009682e-002;
  B1.z_ret("O2",11) : 1.635970647683488e-002;
  B1.z_ret("O2",12) : 1.624717112298217e-002;
  B1.z_ret("O2",13) : 1.599950530268863e-002;
  B1.z_ret("O2",14) : 1.563567636597696e-002;
  B1.z_ret("O2",15) : 1.517405560299353e-002;
  B1.z_ret("O2",16) : 1.46349973171151e-002;
  B1.z_ret("O2",17) : 1.403994977305713e-002;
  B1.z_ret("O2",18) : 1.34095506638856e-002;
  B1.z_ret("O2",19) : 1.276196523643738e-002;
  B1.z_ret("O2",2) : 2.443464444362185e-002;
  B1.z_ret("O2",20) : 1.128492097744335e-002;
  B1.z_ret("O2",21) : 1.130689292536637e-002;
  B1.z_ret("O2",22) : 1.130689292536636e-002;
  B1.z_ret("O2",23) : 1.130689292536636e-002;
  B1.z_ret("O2",24) : 1.130689292536636e-002;
  B1.z_ret("O2",25) : 1.130689292536636e-002;
  B1.z_ret("O2",3) : 2.287590599878074e-002;
  B1.z_ret("O2",4) : 2.144641466581156e-002;
  B1.z_ret("O2",5) : 2.014253503019056e-002;
  B1.z_ret("O2",6) : 1.895550703404119e-002;
  B1.z_ret("O2",7) : 1.787521691812607e-002;
  B1.z_ret("O2",8) : 1.689159157208016e-002;
  B1.z_ret("O2",9) : 1.599502923411511e-002;
  B1.z_support("CH4",10) : 2.830160938343443e-029;
  B1.z_support("CH4",11) : 3.079894548629878e-029;
  B1.z_support("CH4",12) : 3.332080077465008e-029;
  B1.z_support("CH4",13) : 3.598891428638069e-029;
  B1.z_support("CH4",14) : 3.881290907338936e-029;
  B1.z_support("CH4",15) : 4.178815028932352e-029;
  B1.z_support("CH4",16) : 4.490460531378433e-029;
  B1.z_support("CH4",17) : 4.814786501786055e-029;
  B1.z_support("CH4",18) : 5.149946885106517e-029;
  B1.z_support("CH4",19) : 5.493728875970928e-029;
  B1.z_support("CH4",20) : 5.843608272727276e-029;
  B1.z_support("CO",10) : 2.830160938343443e-029;
  B1.z_support("CO",11) : 3.079894548629877e-029;
  B1.z_support("CO",12) : 3.332080077465008e-029;
  B1.z_support("CO",13) : 3.598891428638069e-029;
  B1.z_support("CO",14) : 3.881290907338937e-029;
  B1.z_support("CO",15) : 4.178815028932352e-029;
  B1.z_support("CO",16) : 4.490460531378433e-029;
  B1.z_support("CO",17) : 4.814786501786055e-029;
  B1.z_support("CO",18) : 5.149946885106517e-029;
  B1.z_support("CO",19) : 5.493728875970928e-029;
  B1.z_support("CO",20) : 5.843608272727276e-029;
  B1.z_support("CO2",10) : 2.830160938343443e-029;
  B1.z_support("CO2",11) : 3.079894548629877e-029;
  B1.z_support("CO2",12) : 3.332080077465008e-029;
  B1.z_support("CO2",13) : 3.598891428638069e-029;
  B1.z_support("CO2",14) : 3.881290907338936e-029;
  B1.z_support("CO2",15) : 4.178815028932352e-029;
  B1.z_support("CO2",16) : 4.490460531378433e-029;
  B1.z_support("CO2",17) : 4.814786501786055e-029;
  B1.z_support("CO2",18) : 5.149946885106517e-029;
  B1.z_support("CO2",19) : 5.493728875970928e-029;
  B1.z_support("CO2",20) : 5.843608272727276e-029;
  B1.z_support("ETOH",10) : 2.830160938343445e-029;
  B1.z_support("ETOH",11) : 3.07989454862988e-029;
  B1.z_support("ETOH",12) : 3.33208007746501e-029;
  B1.z_support("ETOH",13) : 3.598891428638071e-029;
  B1.z_support("ETOH",14) : 3.881290907338937e-029;
  B1.z_support("ETOH",15) : 4.178815028932352e-029;
  B1.z_support("ETOH",16) : 4.490460531378433e-029;
  B1.z_support("ETOH",17) : 4.814786501786055e-029;
  B1.z_support("ETOH",18) : 5.149946885106517e-029;
  B1.z_support("ETOH",19) : 5.493728875970928e-029;
  B1.z_support("ETOH",20) : 5.843608272727276e-029;
  B1.z_support("H2",10) : 0.5156826388607528;
  B1.z_support("H2",11) : 0.472946439133363;
  B1.z_support("H2",12) : 0.4297906495850745;
  B1.z_support("H2",13) : 0.384131984817491;
  B1.z_support("H2",14) : 0.3358057682908935;
  B1.z_support("H2",15) : 0.2848913148076447;
  B1.z_support("H2",16) : 0.23156030973627;
  B1.z_support("H2",17) : 0.1760593323859551;
  B1.z_support("H2",18) : 0.1187042928866124;
  B1.z_support("H2",19) : 5.987386230335957e-002;
  B1.z_support("H2",20) : 5.819308035448499e-011;
  B1.z_support("H2O",10) : 0.4843173611392471;
  B1.z_support("H2O",11) : 0.527053560866637;
  B1.z_support("H2O",12) : 0.5702093504149254;
  B1.z_support("H2O",13) : 0.6158680151825091;
  B1.z_support("H2O",14) : 0.6641942317091065;
  B1.z_support("H2O",15) : 0.7151086851923554;
  B1.z_support("H2O",16) : 0.7684396902637299;
  B1.z_support("H2O",17) : 0.8239406676140448;
  B1.z_support("H2O",18) : 0.8812957071133876;
  B1.z_support("H2O",19) : 0.9401261376966404;
  B1.z_support("H2O",20) : 0.999999999941807;
  B1.z_support("N2",10) : 2.830160938343443e-029;
  B1.z_support("N2",11) : 3.079894548629878e-029;
  B1.z_support("N2",12) : 3.332080077465008e-029;
  B1.z_support("N2",13) : 3.598891428638069e-029;
  B1.z_support("N2",14) : 3.881290907338936e-029;
  B1.z_support("N2",15) : 4.178815028932352e-029;
  B1.z_support("N2",16) : 4.490460531378433e-029;
  B1.z_support("N2",17) : 4.814786501786055e-029;
  B1.z_support("N2",18) : 5.149946885106517e-029;
  B1.z_support("N2",19) : 5.493728875970928e-029;
  B1.z_support("N2",20) : 5.843608272727276e-029;
  B1.z_support("O2",10) : 1.541590822150624e-025;
  B1.z_support("O2",11) : 1.677620910187048e-025;
  B1.z_support("O2",12) : 1.814986560127434e-025;
  B1.z_support("O2",13) : 1.96031890665284e-025;
  B1.z_support("O2",14) : 2.114142118134302e-025;
  B1.z_support("O2",15) : 2.276203734137419e-025;
  B1.z_support("O2",16) : 2.445957277063711e-025;
  B1.z_support("O2",17) : 2.622617880562158e-025;
  B1.z_support("O2",18) : 2.80517999703944e-025;
  B1.z_support("O2",19) : 2.992438309723046e-025;
  B1.z_support("O2",20) : 3.183017884047498e-025;
  Graphics : TEXT CLSID {A0DFFFE6-908E-11CE-A964-0000C08C668E}
# of PFS Objects = 2
SIZE 53.4998 54.4998 -19.7163 -18.4163
BLOCK
ID: B1
Version: 1
ICON: "System"
Flag 0
Section 
At 53.999790 -19.066275
Label At 0.000000 0.000000
Scale 1.000000 Modifier 0
LEGEND
Version: 2
Dim: 50.7534 -21.5524 51.7123 -21.7198
Size: 0.0915011
Font: 1 0 =Times New Roman
# of PFS Objects = 0
VIEWPORT 47.045708 74.130035 -17.419254 -30.412413
LAYOUT
TableFormat 1
Pages 1 1 1 1
PAGESETUP
PAPERSIZE 
PAPERSOURCE 
ORIENTATION -1
PRINTPAGENO 1 1
LEFTMARGIN 10mm
RIGHTMARGIN 10mm
TOPMARGIN 10mm
BOTTOMMARGIN 10mm
VISIBILITY 0.030000
PFDFLAG 255 255
PFDMODE 0
SCALE 0.091501

ENDTEXT;
END

Properties
Package : "Aprpdf";
RunID : "properties.appdf";

Default as ComponentList; 
Within Default
  Components :["CH4","CO","CO2","ETOH","H2","H2O","N2","O2"];
EndWithin
End

Options
  AbsoluteSingularityTol: 1.e-004;
  AbsPerturb: 1.e-005;
  AbsTearTol: 1.e-005;
  AbsTol: 1.e-005;
  AssignmentWarningsEnabled: True;
  ChangeTol: 1.e-005;
  CheckProcDerivs: "Off";
  Compression: True;
  CurrentUOMSet: "Metric";
  Decomposer.ProgID: "AspenTech.Decomposer";
  Decomposition.MultipleGroup: True;
  DerivAbsTol: 1.e-003;
  DerivRelTol: 0.1;
  EqnTol: 1.e-005;
  EquationSensCheck: False;
  EquationSensTol: 10000000000.;
  EstimationPrintLevel: "Medium";
  EstimationReturntoBestPoint: False;
  EstimationSolver: 2;
  Estimator: 1;
  ExplicitEventTolerance: 1.e-005;
  Feasopt.MaxAbsStep: 10.;
  Feasopt.MaxEval: 100;
  Feasopt.MaxRelStep: 10.;
  Feasopt.OptTol: 1.e-004;
  Homotopy.InitialStep: 0.1;
  Homotopy.MaximumStep: 1.;
  Homotopy.MinimumStep: 1.e-002;
  Homotopy.StepDecrement: 0.5;
  Homotopy.StepIncrement: 10;
  Integration.AbsErrorTol: 5.e-004;
  Integration.AbsTearTol: 5.e-002;
  Integration.DiscontinuityEventTol: 1.e-005;
  Integration.EnforceMinStep: False;
  Integration.IncSensErrors: False;
  Integration.InitStepSize: 1.e-003;
  Integration.ItplToComTime: True;
  Integration.LocateIEvents: False;
  Integration.MaxOrder: 5;
  Integration.MaxStepSize: 5.e-002;
  Integration.MinStepSize: 1.e-003;
  Integration.ProgID: "AspenTech.UnifiedIntegrator";
  Integration.RcvTornVars: False;
  Integration.ReInitAfterEE: False;
  Integration.ReInitAfterIE: False;
  Integration.RelErrorTol: 5.e-004;
  Integration.RelTearTol: 5.e-002;
  Integration.RewindToLastConvStep: False;
  Integration.ShowHIErrors: 0;
  Integration.ShowHTIErrors: 0;
  Integration.StepRedFact: 0.5;
  Integration.StepSize: 2.5e-003;
  Integration.StepSizeType: "Variable";
  Integration.TestSAndAVars: False;
  Integration.UsePrevAfterEE: False;
  Integrator: "ImplicitEuler";
  KeepCompiledEvaluationFiles: False;
  LinearSolver: "MA48";
  ListEquivalenceVariables: True;
  LogLikelihood.MaxIter: 100;
  LogLikelihood.SolTol: 1.e-004;
  MA48.DropTol: 0.;
  MA48.EnableRefineIter: True;
  MA48.MaxRefineIter: 10;
  MA48.PivotSearch: 3;
  MA48.PivotTol: 1.e-050;
  MA48.Repivot: 0;
  MA48.UseTranspose: 0;
  MaxTearIter: 100;
  Nl2sol.AbsFuncTol: 1.e-020;
  Nl2sol.FalseConvTol: 0.;
  Nl2sol.MaxIter: 50;
  Nl2sol.RelFuncTol: 1.e-004;
  Nl2sol.SolTol: 1.e-004;
  NLASolver: "DMO";
  Nonlinear.AbsPert: 1.e-005;
  Nonlinear.BestOnFail: True;
  Nonlinear.BoundClip: 1.e-006;
  Nonlinear.BoundFrac: 1.;
  Nonlinear.ConvCrit: "Residual";
  Nonlinear.CreepIter: 0;
  Nonlinear.CreepSize: 0.1;
  Nonlinear.Dogleg: False;
  Nonlinear.HiResidual: 0;
  Nonlinear.HiVarSteps: 0;
  Nonlinear.MathsPrint: 0;
  Nonlinear.MaxDivSteps: 10;
  Nonlinear.MaxFastNewtonSteps: 5;
  Nonlinear.MaxIter: 150;
  Nonlinear.MaxStepRed: 20;
  Nonlinear.MaxVarStep: 50.;
  Nonlinear.Method: "Mixed Newton";
  Nonlinear.RangeFrac: 0.;
  Nonlinear.SingPert: 1.e-002;
  OptimizationObjFun: "Minimize";
  OptimizationPrintLevel: "Medium";
  Optimizer: 1;
  PrintLevel: 2;
  PropInfo: -1;
  RelativeSingularityCheck: True;
  RelativeSingularityTol: 1.e-002;
  RelPerturb: 1.e-005;
  RelTearTol: 1.e-005;
  RelTol: 1.e-005;
  RunMode: "SteadyState";
  SaveFreeVariableValues: True;
  Scaling: False;
  SensErrorCheck: True;
  SnapshotSettings.EnableDynInitialization: True;
  SnapshotSettings.EnableFileSaved: False;
  SnapshotSettings.EnableInitialization: True;
  SnapshotSettings.EnableInitialSpec: True;
  SnapshotSettings.EnableMaximum: True;
  SnapshotSettings.EnableonReinitialization: False;
  SnapshotSettings.EnableProblemEdit: True;
  SnapshotSettings.EnableRegularSnapshot: False;
  SnapshotSettings.EnableSteadyState: True;
  SnapshotSettings.Interval: 2.;
  SnapshotSettings.Maximum: 10;
  SnapshotSettings.SaveConvergedOnly: False;
  SnapshotSettings.TakeAutoSnapshots: True;
  SyncSteps: "Full";
  Tearing: "update";
  TearUpdate: "Direct";
  TimeSettings.CommunicationInterval: 1.e-002;
  TimeSettings.CommunicationUnits: "Hours";
  TimeSettings.DisplayUpdateInterval: 2000;
  TimeSettings.EnablePauseAt: False;
  TimeSettings.EnableStepFor: False;
  TimeSettings.PauseAt: 0.;
  TimeSettings.RealTimeSyncFactor: 0.;
  TimeSettings.RecordHistory: False;
  TimeSettings.StepFor: 0;
  TimeSettings.TimeDisplayUnits: "Hours";
  UseCompiledEvaluation: False;
  UseSavedSnapshotOnLoad: False;
  WatchGroup: 0;
  WatchSubGroup: 0;
  Wegstein.MaxAcceleration: 0.;
  Wegstein.MinAcceleration: -5.;
  OpenLASolver: "";
  OpenNLASolver: "aos_dmo.dll";
  OpenNLASolverParameters.ACTIVEINIT: 0;
  OpenNLASolverParameters.ACTIVERPT: 0;
  OpenNLASolverParameters.ACTIVESAVE: 0;
  OpenNLASolverParameters.ACTIVESPACE: 2;
  OpenNLASolverParameters.ADCVITER: 100;
  OpenNLASolverParameters.ADCVMETH: 0;
  OpenNLASolverParameters.ADCVOBJCVG: 1.e-006;
  OpenNLASolverParameters.ADCVRESCVG: 1.e-006;
  OpenNLASolverParameters.ANALYSISTHRES: 2.;
  OpenNLASolverParameters.BOUNDRPT: 1;
  OpenNLASolverParameters.BTF: 1;
  OpenNLASolverParameters.CREEPFLAG: 0;
  OpenNLASolverParameters.CREEPITER: 10;
  OpenNLASolverParameters.CREEPSIZE: 0.1;
  OpenNLASolverParameters.CWORKF: 1.;
  OpenNLASolverParameters.DENSITYRATIO: 0.7;
  OpenNLASolverParameters.DROPTOL: 1.e-020;
  OpenNLASolverParameters.FACTORSPACE: 6;
  OpenNLASolverParameters.FACTORSPEED: 1;
  OpenNLASolverParameters.FREEONLY: 0;
  OpenNLASolverParameters.HESSIANSCL: 1.;
  OpenNLASolverParameters.HESSIANUPDATES: 10;
  OpenNLASolverParameters.IPSIRPT: 1;
  OpenNLASolverParameters.IWORKF: 1.;
  OpenNLASolverParameters.LINESEARCH: 3;
  OpenNLASolverParameters.LINESRCMODE: 0;
  OpenNLASolverParameters.LSMODEITER: 0;
  OpenNLASolverParameters.LUSTATS: 0;
  OpenNLASolverParameters.MAXITER: 50;
  OpenNLASolverParameters.MINBTFSIZE: 1;
  OpenNLASolverParameters.MINITER: 0;
  OpenNLASolverParameters.OBJCVG: 1.e-006;
  OpenNLASolverParameters.PIVOTANAL: 1;
  OpenNLASolverParameters.PIVOTSEARCH: 10;
  OpenNLASolverParameters.PIVOTTHRESH: 0.1;
  OpenNLASolverParameters.PIVOTZERO: 0.;
  OpenNLASolverParameters.PRINTFREQ: -1;
  OpenNLASolverParameters.QPCONVTOL: 1.e-010;
  OpenNLASolverParameters.QPDEPDIAG: 2;
  OpenNLASolverParameters.QPHESSIANUPD: 20;
  OpenNLASolverParameters.QPITER: 10;
  OpenNLASolverParameters.QPMICROINF: 0;
  OpenNLASolverParameters.QPMICROMAX: 5;
  OpenNLASolverParameters.QPMICROTOL: 1.e-012;
  OpenNLASolverParameters.QPSTATS: 0;
  OpenNLASolverParameters.QUICKRTN: 1;
  OpenNLASolverParameters.RESCVG: 1.e-006;
  OpenNLASolverParameters.RETRYFACT: 1;
  OpenNLASolverParameters.RIGORUPDATES: 25;
  OpenNLASolverParameters.RWORKF: 1.;
  OpenNLASolverParameters.SAVEJDFFILE: 0;
  OpenNLASolverParameters.SCREENFORM: 1;
  OpenNLASolverParameters.SEARCHMODE: 1;
  OpenNLASolverParameters.SINGULARHAND: 0;
  OpenNLASolverParameters.TRUSTITER: 2;
  OpenNLASolverParameters.TRUSTMODE: 0;
  OpenNLASolverParameters.TRUSTRAMPIT: 2;
  OpenNLASolverParameters.TRUSTSIZE: 0.1;
  OpenNLASolverParameters.USEDROPTOL: 0;
  OpenNLASolverParameters.VARSCALE: 1;
  OpenNLASolverParameters.VMS_P1: 0;
  OpenNLASolverParameters.WORKINGDIR: "C:\Users\Stefano\Desktop\Lavori in corso\Membranes\AM_Test_paper_12";
  OpenOPTSolver: "";
  OpenESTSolver: "";
End
Optimization
  IsDynamic : FALSE;
  ElementSizeBoundsAutomatic : TRUE;
  EndTime : 1.000000000000000;
  Control.FinalTime_Initial : 1.000000000000000;
  Control.FinalTime_Upper : 2.000000000000000;
  Control.FinalTime_Lower : 0.5000000000000000;
  Control.FinalTime_IsFixed : TRUE;
  Control.FinalTime_IsObjective : FALSE;
  Control.Elements : 5;
  Control.FixedInterval : TRUE;
  Control.MovingElementsVarying : FALSE;
  Control.PiecewiseLinear : FALSE;
  Control(0) : 0.2000000000000000, 0.05000000000000000, 0.4000000000000000 ;
  Control(1) : 0.2000000000000000, 0.05000000000000000, 0.4000000000000000 ;
  Control(2) : 0.2000000000000000, 0.05000000000000000, 0.4000000000000000 ;
  Control(3) : 0.2000000000000000, 0.05000000000000000, 0.4000000000000000 ;
  Control(4) : 0.2000000000000000, 0.05000000000000000, 0.4000000000000000 ;
End
Estimation
  CalcHeteroParams : TRUE;
  ExperimentTimeUnit: "";
End
Homotopy
 Enabled: FALSE;
End
SimulationAccessExtension
  ENABLED: false;
End
SpecAnalysis
 EXCLUDES: {B1.dist_mems},
         {B1.f_cat},
         {B1.Feed_in.F},
         {B1.Feed_in.P},
         {B1.Feed_in.T},
         {B1.Feed_in.z("CH4")},
         {B1.Feed_in.z("CO")},
         {B1.Feed_in.z("CO2")},
         {B1.Feed_in.z("ETOH")},
         {B1.Feed_in.z("H2")},
         {B1.Feed_in.z("H2O")},
         {B1.Feed_in.z("N2")},
         {B1.Feed_in.z("O2")},
         {B1.Sweep_in.F},
         {B1.Sweep_in.P},
         {B1.t_ins};
End
OnLineLinks
  Protocol: "OPC", 1;
  //Server: "";
  IO: Synchronous, Cached;
  Bounds: Clip;
  Quality: UseLast;
  Update: 1000;
  PrintLevel: 2;
  Enabled: OFF;
  Input Events : Before SS Run, After DYN Step, After INI Step, Before INI Run;
  Output Events: After SS Run, After DYN Step, After INI Step, After INI Run;
End
